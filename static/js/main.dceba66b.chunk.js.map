{"version":3,"sources":["AppContext/AppContext.js","components/Navigation/SearchVehicle.js","components/Navigation/Navigation.js","components/LoadingSpinner/LoadingSpinner.js","components/Notification/Notification.js","components/Modals/DeleteResourceModal.js","components/ShowVehicle/VehicleDetails.js","components/BrowseVehicles/BrowseVehicles.js","Models/Service.js","Firebase/Firebase.js","Models/Vehicle.js","components/VehicleForm/VehicleForm.js","components/AddVehicle/AddVehicle.js","components/EditVehicle/EditVehicle.js","Models/Booking.js","components/Modals/WarningModal.js","components/AddBooking/AddBooking.js","components/AddService/AddService.js","components/AddJourney/AddJourney.js","Models/Journey.js","components/AddJourney/AddJourneyForm.js","components/AddFuelPurchase/AddFuelPurchase.js","Models/FuelPurchase.js","components/AddFuelPurchase/AddFuelPurchaseForm.js","components/ShowVehicle/ShowVehicle.js","components/Header/Header.js","components/Dashboard/RevenueChart.js","components/Dashboard/Dashboard.js","components/App/calculateTotalRevenue.js","components/App/App.js","serviceWorker.js","index.js"],"names":["AppContext","React","createContext","AppProvider","Provider","AppConsumer","Consumer","SearchVehicle","useState","selected","setSelected","typeaheadRef","useRef","history","useHistory","handleSubmit","e","preventDefault","length","push","id","vehicles","Form","inline","onSubmit","className","FormGroup","labelKey","option","manufacturer","model","year","filterBy","options","placeholder","highlightOnlyResult","minLength","onChange","ref","Button","variant","type","onClick","current","clear","focus","Navigation","Navbar","bg","expand","Brand","as","Link","to","Toggle","aria-controls","Collapse","Nav","NavItem","NavDropdown","title","Item","Component","LoadingSpinner","Spinner","animation","role","style","width","height","Notification","props","show","setShow","Toast","display","position","top","left","transform","onClose","delay","autohide","Header","Body","message","DeleteResourceModal","useContext","deleteResource","resource","resourceType","Modal","size","showDeleteResourceModal","onHide","setDeleteResourceModalShow","aria-labelledby","centered","closeButton","Title","trim","toLowerCase","ListGroup","registrationNumber","odometerReading","tankCapacity","find","v","bookings","some","b","journeys","j","moment","journeyStartedAt","format","journeyEndedAt","journeyStartOdometerReading","journeyEndOdometerReading","journeyFrom","journeyTo","vehicleID","startDate","endDate","startOdometer","bookingType","Number","parseFloat","bookingCost","toFixed","servicedAt","serviceOdometer","fuelPurchases","f","fuelQuantity","fuelPrice","renderResourceInfo","Footer","confirmDeleteResource","VehicleDetails","vehicle","vehicleBookings","vehicleServices","services","Accordion","Card","overflow","eventKey","ButtonGroup","aria-label","icon","faEdit","faTrash","Dropdown","drop","faCog","Menu","Object","keys","printDetails","map","field","index","key","sort","b1","b2","isBefore","booking","Date","toLocaleDateString","endOdometer","reduce","forEach","journey1","journey2","journey1StartedAt","journey2StartedAt","journey","service1","service2","service1At","service2At","service","fuelPurchase1","fuelPurchase2","bookingFuelPurchase1","bookingID","booking1StartedAt","bookingFuelPurchase2","booking2StartedAt","fuelPurchase","BrowseVehicles","loading","notification","Container","Row","Col","i","Service","require","createdAt","updatedAt","this","_id","_vehicleID","_serviceOdometer","_servicedAt","_createdAt","_updatedAt","value","getTotalServicesDone","filter","s","getLastServiceOdometerReading","now","firstServicesBeforeToday","firstService","secondService","firstServiceDate","diff","requiresService","isSameOrAfter","config","apiKey","process","API_KEY","authDomain","AUTH_DOMAIN","databaseURL","DATABASE_URL","projectId","PROJECT_ID","storageBucket","STORAGE_BUCKET","messagingSenderId","MESSAGING_SENDER_ID","appId","APP_ID","firebase","initializeApp","Vehicle","_bookings","_services","_manufacturer","_model","_year","_odometerReading","_registrationNumber","_tankCapacity","_fuelEconomy","calculateFuelEconomy","newBooking","updateVehicleOdometer","bookingsCopy","bookingToBeDeleted","removeJourney","newJourney","addJourney","newService","serviceID","servicesCopy","serviceToBeDeleted","newFuelPurchase","addFuelPurchase","removeFuelPurchase","calculateRevenueRecorded","total","totalFuelPurchaseCost","totalCost","totalDistanceTravelled","calculateTotalDistanceTravelled","isNaN","isFinite","totalDistance","callback","undefined","updateRemote","todaysJourneys","isSame","greatestEndOdometer","Math","max","db","firestore","collection","doc","update","then","catch","console","dir","_fuelPurchases","schema","yup","shape","required","min","subtract","get","add","matches","VehicleForm","manufacturerInputRef","validationSchema","values","initialValues","handleChange","resetForm","touched","errors","isSubmitting","noValidate","Group","controlId","lg","md","Label","Control","name","isInvalid","isValid","Feedback","step","disabled","AddVehicle","addResource","vehicleToBeAdded","cloneDeep","EditVehicle","editVehicle","useParams","vehicleToBeEdited","hasOwnProperty","Booking","_journeys","_bookingType","_startDate","_endDate","_startOdometer","_endOdometer","_bookingCost","calculateBookingCost","lastJourney","err","updateEndOdometer","days","newFuelPurchases","WarningModal","cancelHandler","header","body","acceptHandler","accept","cancel","extendMoment","Moment","AddBooking","status","bookingConflict","setBookingConflict","serviceConflict","setServiceConflict","bookingToBeAdded","setBookingToBeAdded","addBooking","setAddBooking","vehicleToBeModified","confirmDeleteConflictedResource","conflictedResourceType","conflictedResource","newResourceType","newResource","useEffect","range","overlaps","within","column","sm","AddService","serviceToBeAdded","setServiceToBeAdded","addService","setAddService","AddJourney","booking1","booking2","booking1StartDate","booking2StartDate","data-testid","faPlus","Journey","_bookingID","_journeyStartOdometerReading","_journeyEndOdometerReading","_journeyStartedAt","_journeyEndedAt","_journeyFrom","_journeyTo","AddJourneyForm","journeyToBeAdded","setJourneyToBeAdded","setAddJourney","associatedBooking","AddFuelPurchase","FuelPurchase","_fuelPrice","_fuelQuantity","AddFuelPurchaseForm","fuelPurchaseToBeAdded","setFuelPurchaseToBeAdded","setAddFuelPurchase","moreThan","ShowVehicle","vehicleJourneys","vehicleFuelPurchases","match","params","headerText","RevenueChart","data","stroke","strokeDasharray","dataKey","content","payload","label","active","barSize","fill","Dashboard","revenue","calculateTotalRevenue","state","vehicleRevenue","mappedBookings","mappedBooking","bookingMonthAndYear","mappedBooking1","mappedBooking2","isSameOrBefore","bookingsByMonthAndYear","monthAndYear","findIndex","entry","mappedRevenue","r","revenue1","revenue2","App","fetchCollection","formattedCollection","querySnapshot","docs","setState","prevState","dismissNotification","setTimeout","fieldsChanged","oldVehicleIndex","oldVehicle","fields","Array","isArray","collectionName","selectedVehicle","selectedVehicleIndex","set","delete","removeBookingByID","removeJourneyByBookingID","removeServiceByID","removeFuelPurchaseByBookingID","addVehicle","fetchCollections","collections","Promise","all","exact","path","render","Boolean","window","location","hostname","ReactDOM","basename","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"yXASaA,EAAaC,IAAMC,cAAc,IAMjCC,EAAcH,EAAWI,SAMzBC,EAAcL,EAAWM,S,mCCNzBC,EAAgB,WAAO,IAAD,EACDC,mBAAS,IADR,mBAC1BC,EAD0B,KAChBC,EADgB,KAE3BC,EAAeC,iBAAO,MACtBC,EAAUC,cAEVC,EAAe,SAAAC,GACtBA,EAAEC,iBAEER,GAAYA,EAASS,QACvBL,EAAQM,KAAR,gBAAsBV,EAAS,GAAGW,MAInC,OACD,kBAACf,EAAD,MAEC,gBAAEgB,EAAF,EAAEA,SAAF,OACE,kBAACC,EAAA,EAAD,CAAMC,QAAM,EAACC,SAAUT,EAAcU,UAAU,WAChD,kBAACC,EAAA,EAAD,KACE,kBAAC,YAAD,CACDN,GAAG,iBACHO,SAAU,SAACC,GAAD,gBAAeA,EAAOC,aAAtB,YAAsCD,EAAOE,MAA7C,aAAuDF,EAAOG,KAA9D,MACVC,SAAU,CAAC,eAAgB,QAAS,QACpCC,QAASZ,EACTa,YAAY,0BACZC,qBAAmB,EACnBC,UAAW,EACXC,SAAU,SAAA5B,GAAQ,OAAIC,EAAYD,IAClC6B,IAAK3B,IAEJ,kBAAC4B,EAAA,EAAD,CAAQC,QAAQ,kBAAkBC,KAAK,SAAShB,UAAU,WAA1D,UAGA,kBAACc,EAAA,EAAD,CACDG,QAAS,WACP/B,EAAagC,QAAQC,QACrBjC,EAAagC,QAAQE,SAEvBL,QAAQ,iBACRf,UAAU,WANT,eCpCQqB,EAAb,iLAEC,OACE,kBAACC,EAAA,EAAD,CAAQC,GAAG,QAAQR,QAAQ,QAAQS,OAAO,MAC3C,kBAACF,EAAA,EAAOG,MAAR,CAAcC,GAAIC,IAAMC,GAAG,IAAI5B,UAAU,WAAzC,qBACA,kBAACsB,EAAA,EAAOO,OAAR,CAAeC,gBAAc,oBAC7B,kBAACR,EAAA,EAAOS,SAAR,CAAiBpC,GAAG,mBAClB,kBAACqC,EAAA,EAAD,CAAKhC,UAAU,WAChB,kBAACiC,EAAA,EAAD,KACE,kBAACD,EAAA,EAAIL,KAAL,CAAUD,GAAIC,IAAMC,GAAG,IAAI5B,UAAU,WAArC,SAEF,kBAACkC,EAAA,EAAD,CAAalC,UAAU,UAAUmC,MAAM,kBAAkBxC,GAAG,mBAC1D,kBAACuC,EAAA,EAAYE,KAAb,CAAkBV,GAAIC,IAAMC,GAAG,WAA/B,mBACA,kBAACM,EAAA,EAAYE,KAAb,CAAkBV,GAAIC,IAAMC,GAAG,QAA/B,uBAGD,kBAAC,EAAD,YAhBJ,GAAgCpD,IAAM6D,W,oCCDzBC,EAAiB,kBAC5B,kBAACC,EAAA,EAAD,CACDC,UAAU,SACVzB,QAAQ,UACR0B,KAAK,SACLC,MAAO,CAACC,MAAO,OAAQC,OAAQ,SAC/B,0BAAM5C,UAAU,WAAhB,gB,SCCY6C,EAAe,SAAAC,GAAU,IAAD,EACX/D,oBAAS,GADE,mBAC5BgE,EAD4B,KACtBC,EADsB,KAGnC,OACD,kBAACC,EAAA,EAAD,CACEP,MAAO,CACRQ,QAASJ,EAAMI,QAAU,QAAU,OACnCC,SAAU,WACVC,IAAK,EACLC,KAAM,MACNC,UAAW,oBAEVC,QAAS,kBAAMP,GAAQ,IACvBD,KAAMA,EACNS,MAAO,IACPC,UAAQ,GACR,kBAACR,EAAA,EAAMS,OAAP,KACD,4BAAQ1D,UAAU,WAAlB,iBAEC,kBAACiD,EAAA,EAAMU,KAAP,KACAb,EAAMc,W,kCCxBIC,EAAsB,WAAO,IAAD,EACJC,qBAAWvF,GAAvCqB,EADgC,EAChCA,SAAUmE,EADsB,EACtBA,eACVC,EAA0BD,EAA1BC,SAAUC,EAAgBF,EAAhBE,aAkIjB,OACD,kBAACrF,EAAD,MAEC,YAAuB,IAArBmF,EAAoB,EAApBA,eACA,OACD,kBAACG,EAAA,EAAD,CACEC,KAAK,KACLpB,KAAMgB,EAAeK,wBACrBC,OAAQ,kBAAMN,EAAeO,2BAA2B,KAAM,OAC9DC,kBAAgB,eAChBC,UAAQ,GAER,kBAACN,EAAA,EAAMR,OAAP,CAAce,aAAW,GAC1B,kBAACP,EAAA,EAAMQ,MAAP,CAAa/E,GAAG,gBAAhB,wBAIC,kBAACuE,EAAA,EAAMP,KAAP,KACD,wBAAI3D,UAAU,QAAd,6CAAgEiE,EAAhE,qBAGA,4BAAKA,EAAL,kBA9IyB,SAACA,EAAcD,GAC3C,GAAIC,GAAgBD,EAClB,OAAQC,EAAaU,OAAOC,eAC7B,IAAK,UACH,OACD,kBAACC,EAAA,EAAD,KACE,kBAACA,EAAA,EAAUzC,KAAX,sBAA+B4B,EAAWA,EAAS5D,aAAe,IAClE,kBAACyE,EAAA,EAAUzC,KAAX,eAAwB4B,EAAWA,EAAS3D,MAAQ,IACpD,kBAACwE,EAAA,EAAUzC,KAAX,cAAuB4B,EAAWA,EAAS1D,KAAO,IAClD,kBAACuE,EAAA,EAAUzC,KAAX,6BACQ4B,EAAWA,EAASc,mBAAqB,IACjD,kBAACD,EAAA,EAAUzC,KAAX,0BACS4B,EAAWA,EAASe,gBAAkB,EAD/C,OAEA,kBAACF,EAAA,EAAUzC,KAAX,uBACU4B,EAAWA,EAASgB,aAAe,EAD7C,OAKH,IAAK,UACH,OACD,kBAACH,EAAA,EAAD,KACE,kBAACA,EAAA,EAAUzC,KAAX,yBAES4B,GAAYpE,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEC,SAASC,MAAK,SAAAC,GAAC,OAAIA,EAAEC,SAASF,MAAK,SAAAG,GAAC,OAAIA,EAAE5F,KAAOqE,EAASrE,YAA3F,UAAsGC,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEC,SAASC,MAAK,SAAAC,GAAC,OAAIA,EAAEC,SAASF,MAAK,SAAAG,GAAC,OAAIA,EAAE5F,KAAOqE,EAASrE,YAAMS,aAA3L,YAA2MR,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEC,SAASC,MAAK,SAAAC,GAAC,OAAIA,EAAEC,SAASF,MAAK,SAAAG,GAAC,OAAIA,EAAE5F,KAAOqE,EAASrE,YAAMU,MAAhS,aAA0ST,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEC,SAASC,MAAK,SAAAC,GAAC,OAAIA,EAAEC,SAASF,MAAK,SAAAG,GAAC,OAAIA,EAAE5F,KAAOqE,EAASrE,YAAMW,KAA/X,KAAyY,IAElZ,kBAACuE,EAAA,EAAUzC,KAAX,4BACoB4B,EAAWwB,IAAOxB,EAASyB,kBAAkBC,OAAO,cAAgB,IAExF,kBAACb,EAAA,EAAUzC,KAAX,0BACkB4B,EAAWwB,IAAOxB,EAAS2B,gBAAgBD,OAAO,cAAgB,IAEpF,kBAACb,EAAA,EAAUzC,KAAX,wCAES4B,EAAQ,UAAMA,EAAS4B,4BAAf,OAAkD,IAEnE,kBAACf,EAAA,EAAUzC,KAAX,sCAES4B,EAAQ,UAAMA,EAAS6B,0BAAf,OAAgD,IAEjE,kBAAChB,EAAA,EAAUzC,KAAX,sBACc4B,EAAWA,EAAS8B,YAAc,IAEhD,kBAACjB,EAAA,EAAUzC,KAAX,oBACY4B,EAAWA,EAAS+B,UAAY,KAK/C,IAAK,UACH,OACD,kBAAClB,EAAA,EAAD,KACE,kBAACA,EAAA,EAAUzC,KAAX,yBAES4B,EAAQ,UAAMpE,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEvF,KAAOqE,EAASgC,aAAW5F,aAAtD,YAAsER,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEvF,KAAOqE,EAASgC,aAAW3F,MAAtH,aAAgIT,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEvF,KAAOqE,EAASgC,aAAW1F,KAAhL,KAA0L,IAE3M,kBAACuE,EAAA,EAAUzC,KAAX,4BACoB4B,EAAWwB,IAAOxB,EAASiC,WAAWP,OAAO,cAAgB,IAEjF,kBAACb,EAAA,EAAUzC,KAAX,0BACkB4B,EAAWwB,IAAOxB,EAASkC,SAASR,OAAO,cAAgB,IAE7E,kBAACb,EAAA,EAAUzC,KAAX,wCACgC4B,EAAQ,UAAMA,EAASmC,cAAf,OAAoC,IAE5E,kBAACtB,EAAA,EAAUzC,KAAX,sBACc4B,EAAoC,MAAzBA,EAASoC,YAAsB,gBAAkB,UAClE,IAER,kBAACvB,EAAA,EAAUzC,KAAX,kCAEOiE,OAAOC,WAAWtC,EAASuC,aAAaC,QAAQ,MAM1D,IAAK,UACH,OACD,kBAAC3B,EAAA,EAAD,KACE,kBAACA,EAAA,EAAUzC,KAAX,yBAES4B,GAAYpE,EAASwF,MAAK,SAAAF,GAAC,OAAIA,EAAEvF,KAAOqE,EAASgC,aAAjD,UAAiEpG,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEvF,KAAOqE,EAASgC,aAAW5F,aAAjH,YAAiIR,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEvF,KAAOqE,EAASgC,aAAW3F,MAAjL,aAA2LT,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEvF,KAAOqE,EAASgC,aAAW1F,KAA3O,KAAqP,IAE9P,kBAACuE,EAAA,EAAUzC,KAAX,qBACa4B,EAAWwB,IAAOxB,EAASyC,YAAYf,OAAO,cAAgB,IAE3E,kBAACb,EAAA,EAAUzC,KAAX,kCAC0B4B,EAAQ,UAAMA,EAAS0C,gBAAf,OAAsC,KAK3E,IAAK,eACL,IAAK,gBACH,OACD,kBAAC7B,EAAA,EAAD,KACE,kBAACA,EAAA,EAAUzC,KAAX,oCAES4B,GAAYpE,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEC,SAASC,MAAK,SAAAC,GAAC,OAAIA,EAAEsB,cAAcvB,MAAK,SAAAwB,GAAC,OAAIA,EAAEjH,KAAOqE,EAASrE,YAAhG,UAA2GC,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEC,SAASC,MAAK,SAAAC,GAAC,OAAIA,EAAEsB,cAAcvB,MAAK,SAAAwB,GAAC,OAAIA,EAAEjH,KAAOqE,EAASrE,YAAMS,aAArM,YAAqNR,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEC,SAASC,MAAK,SAAAC,GAAC,OAAIA,EAAEsB,cAAcvB,MAAK,SAAAwB,GAAC,OAAIA,EAAEjH,KAAOqE,EAASrE,YAAMU,MAA/S,aAAyTT,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEC,SAASC,MAAK,SAAAC,GAAC,OAAIA,EAAEsB,cAAcvB,MAAK,SAAAwB,GAAC,OAAIA,EAAEjH,KAAOqE,EAASrE,YAAMW,KAAnZ,KAA6Z,IAEta,kBAACuE,EAAA,EAAUzC,KAAX,uBACe4B,EAAQ,UAAMA,EAAS6C,aAAf,MAAkC,IAEzD,kBAAChC,EAAA,EAAUzC,KAAX,oBAEO4B,EAAQ,YAAQqC,OAAOC,WAAWtC,EAAS8C,WAAWN,QAAQ,IAAO,IAE5E,kBAAC3B,EAAA,EAAUzC,KAAX,oBACY4B,EAAQ,aAASA,EAAS6C,aAAe7C,EAAS8C,WAAWN,QAAQ,IAA7D,KAKvB,QACE,OACD,uBAAGxG,UAAU,eAAb,mCA6BG+G,CAAmB9C,EAAcD,GAClC,kBAACE,EAAA,EAAM8C,OAAP,KACD,kBAAClG,EAAA,EAAD,CACEC,QAAQ,SACRoD,KAAK,KACLnE,UAAU,OACViB,QAAS,kBAAM8C,EAAeC,SAAWD,EAAekD,sBAAsBhD,EAAcD,GAAY,KAJ1G,UAQA,kBAAClD,EAAA,EAAD,CACEC,QAAQ,OACRoD,KAAK,KACLlD,QAAS,kBAAM8C,EAAeO,2BAA2B,QAH3D,gB,mDC5JS4C,EAAiB,SAAApE,GAAU,IAC/BqE,EAAWrE,EAAXqE,QAGKC,EAERD,EAFFhC,SACUkC,EACRF,EADFG,SAGKvD,EAAkBD,qBAAWvF,GAA7BwF,eAEP,OACE,oCACE,kBAACwD,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,CAAM9E,MAAO,CAAC+E,SAAU,YACtB,kBAACD,EAAA,EAAK9D,OAAN,KACE,kBAAC6D,EAAA,EAAU1F,OAAX,CACE7B,UAAU,UACV0B,GAAIZ,IACJC,QAAQ,OACR2G,SAAQ,UAAKP,EAAQ/G,aAAb,YAA6B+G,EAAQ9G,MAArC,aAA+C8G,EAAQ7G,KAAvD,MAJV,UAMM6G,EAAQ/G,aANd,YAM8B+G,EAAQ9G,MANtC,aAMgD8G,EAAQ7G,KANxD,MAQA,kBAACqH,EAAA,EAAD,CAAaC,aAAW,WACtB,kBAAC,IAAD,CACEhG,GAAE,gBAAWuF,EAAQxH,IACrBK,UAAU,QAEV,kBAACc,EAAA,EAAD,CACEC,QAAQ,mBAER,kBAAC,IAAD,CAAiB8G,KAAMC,QAG3B,kBAAChH,EAAA,EAAD,CACEG,QAAS,kBAAM8C,EAAeO,2BAA2B,UAAW6C,IACpEnH,UAAU,OACVe,QAAQ,kBACR,kBAAC,IAAD,CAAiB8G,KAAME,OAEzB,kBAACC,EAAA,EAAD,CAAUC,KAAK,SACb,kBAACD,EAAA,EAASnG,OAAV,CAAiBd,QAAQ,qBACvB,kBAAC,IAAD,CAAiB8G,KAAMK,OAEzB,kBAACF,EAAA,EAASG,KAAV,KACE,kBAACH,EAAA,EAAS5F,KAAV,CACEV,GAAIC,IACJC,GAAE,sBAAiBuF,EAAQxH,KAF7B,eAKA,kBAACqI,EAAA,EAAS5F,KAAV,CACEV,GAAIC,IACJC,GAAE,sBAAiBuF,EAAQxH,KAF7B,eAKA,kBAACqI,EAAA,EAAS5F,KAAV,CACEV,GAAIC,IACJC,GAAE,sBAAiBuF,EAAQxH,KAF7B,eAKA,kBAACqI,EAAA,EAAS5F,KAAV,CACEV,GAAIC,IACJC,GAAE,2BAAsBuF,EAAQxH,KAFlC,yBASR,kBAAC4H,EAAA,EAAUxF,SAAX,CACE2F,SAAQ,UAAKP,EAAQ/G,aAAb,YAA6B+G,EAAQ9G,MAArC,aAA+C8G,EAAQ7G,KAAvD,MACR,kBAACkH,EAAA,EAAK7D,KAAN,KACE,kBAACkB,EAAA,EAAD,KAEIuD,OAAOC,KACLlB,EAAQmB,gBAEPC,KAAI,SAACC,EAAOC,GAAR,OACH,kBAAC5D,EAAA,EAAUzC,KAAX,CAAgBsG,IAAKD,GAClBD,EADH,KAEErB,EAAQmB,eAAeE,OAK/B,kBAAC3D,EAAA,EAAUzC,KAAX,uBACkB+E,EAAQnC,aAD1B,MAGA,kBAACH,EAAA,EAAUzC,KAAX,KACE,kBAACmF,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,KACE,kBAACA,EAAA,EAAK9D,OAAN,KACE,kBAAC6D,EAAA,EAAU1F,OAAX,CACE7B,UAAU,UACV0B,GAAIZ,IACJC,QAAQ,OACR2G,SAAS,KAJX,oBAQF,kBAACH,EAAA,EAAUxF,SAAX,CAAoB2F,SAAS,KAC3B,kBAACF,EAAA,EAAK7D,KAAN,KAEIyD,GACAA,EACGuB,MAAK,SAACC,EAAIC,GAAL,OACJrD,IAAOqD,EAAG5C,WAAW6C,SAAStD,IAAOoD,EAAG3C,eAEzCsC,KAAI,SAACQ,EAASN,GAAV,OACH,kBAAClB,EAAA,EAAD,CAAWmB,IAAKD,GACd,kBAACjB,EAAA,EAAD,KACE,kBAACA,EAAA,EAAK9D,OAAN,KACE,kBAAC6D,EAAA,EAAU1F,OAAX,CACE7B,UAAU,UACV0B,GAAIZ,IACJC,QAAQ,OACR2G,SAAUe,GAJZ,UAKM,IAAIO,KAAKD,EAAQ9C,WAAWgD,mBAAmB,SALrD,cAKmE,IAAID,KAAKD,EAAQ7C,SAAS+C,mBAAmB,WAEhH,kBAACnI,EAAA,EAAD,CACEG,QAAS,kBAAM8C,EAAeO,2BAA2B,UAAWyE,IACpE/I,UAAU,OACVe,QAAQ,kBACR,kBAAC,IAAD,CAAiB8G,KAAME,QAG3B,kBAACR,EAAA,EAAUxF,SAAX,CAAoB2F,SAAUe,GAC5B,kBAACjB,EAAA,EAAK7D,KAAN,KACE,kBAACkB,EAAA,EAAD,CAAW6D,IAAKK,EAAQpJ,IACtB,kBAACkF,EAAA,EAAUzC,KAAX,oBAES,IAAI4G,KAAKD,EAAQ9C,WAAWgD,mBAAmB,UAExD,kBAACpE,EAAA,EAAUzC,KAAX,kBAES,IAAI4G,KAAKD,EAAQ7C,SAAS+C,mBAAmB,UAEtD,kBAACpE,EAAA,EAAUzC,KAAX,wBAEa2G,EAAQ5C,cAFrB,OAI9B,kBAACtB,EAAA,EAAUzC,KAAX,sBAEU2G,EAAQG,YAAR,UAAyBH,EAAQG,YAAjC,kBAEoB,kBAACrE,EAAA,EAAUzC,KAAX,sBAEiC,MAAxB2G,EAAQ3C,YAAsB,UAAY,iBAEnD,kBAACvB,EAAA,EAAUzC,KAAX,sBAEE2G,EAAQxC,YAAR,YAA2BF,OAAOC,WAAWyC,EAAQxC,aAAaC,QAAQ,IAAO,wBAe7G,kBAAC3B,EAAA,EAAUzC,KAAX,KACE,kBAACmF,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,KACE,kBAACA,EAAA,EAAK9D,OAAN,KACE,kBAAC6D,EAAA,EAAU1F,OAAX,CACE7B,UAAU,UACV0B,GAAIZ,IACJC,QAAQ,OACR2G,SAAS,KAJX,oBAQF,kBAACH,EAAA,EAAUxF,SAAX,CACE2F,SAAS,KACT,kBAACF,EAAA,EAAK7D,KAAN,KAEIwD,EAAQhC,UAC3BgC,EACAhC,SACAgE,QAAO,SAAC7D,EAAUD,GAIjB,OAHAA,EAAEC,SAAS8D,SAAQ,SAAA7D,GACjBD,EAAS5F,KAAK6F,MAETD,IACN,IACoBqD,MAAK,SAACU,EAAUC,GACf,IAAMC,EAAoB,IAAIP,KAAKK,EAAS5D,kBACtC+D,EAAoB,IAAIR,KAAKM,EAAS7D,kBAC5C,OAAI8D,EAAoBC,GACd,EACCD,EAAoBC,EACtB,EAEF,KAERjB,KAAI,SAACkB,EAAShB,GAAV,OACH,kBAAClB,EAAA,EAAD,CAAWmB,IAAKD,GACd,kBAACjB,EAAA,EAAD,KACE,kBAACA,EAAA,EAAK9D,OAAN,KACE,kBAAC6D,EAAA,EAAU1F,OAAX,CACE7B,UAAU,UACV0B,GAAIZ,IACJC,QAAQ,OACR2G,SAAUe,GAJZ,UAKM,IAAIO,KAAKS,EAAQhE,kBAAkBwD,mBAAmB,SAL5D,cAK0E,IAAID,KAAKS,EAAQ9D,gBAAgBsD,mBAAmB,WAE9H,kBAACnI,EAAA,EAAD,CACEG,QAAS,kBAAM8C,EAAeO,2BAA2B,UAAWmF,IACpEzJ,UAAU,OACVe,QAAQ,kBACR,kBAAC,IAAD,CAAiB8G,KAAME,QAG3B,kBAACR,EAAA,EAAUxF,SAAX,CAAoB2F,SAAUe,GAC5B,kBAACjB,EAAA,EAAK7D,KAAN,KACE,kBAACkB,EAAA,EAAD,CAAW6D,IAAKe,EAAQ9J,IACtB,kBAACkF,EAAA,EAAUzC,KAAX,4BAEO,IAAI4G,KAAKS,EAAQhE,kBAAkBwD,mBAAmB,UAE7D,kBAACpE,EAAA,EAAUzC,KAAX,0BAEO,IAAI4G,KAAKS,EAAQ9D,gBAAgBsD,mBAAmB,UAE3D,kBAACpE,EAAA,EAAUzC,KAAX,wCAEYqH,EAAQ7D,4BAFpB,OAIA,kBAACf,EAAA,EAAUzC,KAAX,sCAEYqH,EAAQ5D,0BAFpB,OAIA,kBAAChB,EAAA,EAAUzC,KAAX,sBACiBqH,EAAQ3D,aAEzB,kBAACjB,EAAA,EAAUzC,KAAX,oBACeqH,EAAQ1D,wBAcjD,kBAAClB,EAAA,EAAUzC,KAAX,KACE,kBAACmF,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,KACE,kBAACA,EAAA,EAAK9D,OAAN,KACE,kBAAC6D,EAAA,EAAU1F,OAAX,CACE7B,UAAU,UACV0B,GAAIZ,IACJC,QAAQ,OACR2G,SAAS,KAJX,oBAQF,kBAACH,EAAA,EAAUxF,SAAX,CACE2F,SAAS,KACT,kBAACF,EAAA,EAAK7D,KAAN,KAEI0D,EACGsB,MAAK,SAACe,EAAUC,GACf,IAAMC,EAAa,IAAIZ,KAAKU,EAASjD,YAC/BoD,EAAa,IAAIb,KAAKW,EAASlD,YAErC,OAAImD,EAAaC,GACP,EACCD,EAAaC,EACf,EAEF,KAERtB,KAAI,SAACuB,EAASrB,GAAV,OACH,kBAAClB,EAAA,EAAD,CAAWmB,IAAKD,GACd,kBAACjB,EAAA,EAAD,CAAMkB,IAAKoB,EAAQnK,IACjB,kBAAC6H,EAAA,EAAK9D,OAAN,KACE,kBAAC6D,EAAA,EAAU1F,OAAX,CACE7B,UAAU,UACV0B,GAAIZ,IACJC,QAAQ,OACR2G,SAAUe,GACT,IAAIO,KAAKc,EAAQrD,YAAYwC,mBAAmB,UAEnD,kBAACnI,EAAA,EAAD,CACEG,QAAS,kBAAM8C,EAAeO,2BAA2B,UAAWwF,IACpE9J,UAAU,OACVe,QAAQ,kBACR,kBAAC,IAAD,CAAiB8G,KAAME,QAG3B,kBAACR,EAAA,EAAUxF,SAAX,CACE2F,SAAUe,GACV,kBAACjB,EAAA,EAAK7D,KAAN,KACE,kBAACkB,EAAA,EAAD,KACE,kBAACA,EAAA,EAAUzC,KAAX,qBAEO,IAAI4G,KAAKc,EAAQrD,YAAYwC,mBAAmB,UAEvD,kBAACpE,EAAA,EAAUzC,KAAX,0BAEa0H,EAAQpD,gBAFrB,oBAgB1B,kBAAC7B,EAAA,EAAUzC,KAAX,KACE,kBAACmF,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,KACE,kBAACA,EAAA,EAAK9D,OAAN,KACE,kBAAC6D,EAAA,EAAU1F,OAAX,CACE7B,UAAU,UACV0B,GAAIZ,IACJC,QAAQ,OACR2G,SAAS,KAJX,0BAQF,kBAACH,EAAA,EAAUxF,SAAX,CACE2F,SAAS,KACT,kBAACF,EAAA,EAAK7D,KAAN,KAEjBwD,EACGhC,SACAgE,QAAO,SAACxC,EAAetB,GAIzB,OAHAA,EAAEsB,cAAcyC,SAAQ,SAAAxC,GACtBD,EAAcjH,KAAKkH,MAEdD,IACH,IACmBgC,MAAK,SAACoB,EAAeC,GACpB,IAAMC,EAAuB7C,EAAgBnC,MAAK,SAAA8D,GAAO,OAAIA,EAAQpJ,KAAOoK,EAAcG,aACpFC,EAAoB,IAAInB,KAAKiB,EAAqBhE,WAClDmE,EAAuBhD,EAAgBnC,MAAK,SAAA8D,GAAO,OAAIA,EAAQpJ,KAAOqK,EAAcE,aACpFG,EAAoB,IAAIrB,KAAKoB,EAAqBnE,WACxD,OAAIkE,EAAoBE,GACd,EACCF,EAAoBE,EACtB,EAEF,KAER9B,KAAI,SAAC+B,EAAc7B,GAAf,OACH,kBAAClB,EAAA,EAAD,CAAWmB,IAAKD,GACd,kBAACjB,EAAA,EAAD,KACE,kBAACA,EAAA,EAAK9D,OAAN,KACE,kBAAC6D,EAAA,EAAU1F,OAAX,CACE7B,UAAU,UACV0B,GAAIZ,IACJC,QAAQ,OACR2G,SAAUe,GAJZ,UAKM,IAAIO,KAAK5B,EAAgBnC,MAAK,SAAA8D,GAAO,OAAIA,EAAQpJ,KAAO2K,EAAaJ,aAAWjE,WAAWgD,mBAAmB,SALpH,cAKkI,IAAID,KAAK5B,EAAgBnC,MAAK,SAAA8D,GAAO,OAAIA,EAAQpJ,KAAO2K,EAAaJ,aAAWhE,SAAS+C,mBAAmB,WAE9O,kBAACnI,EAAA,EAAD,CACEG,QAAS,kBAAM8C,EAAeO,2BAA2B,gBAAiBgG,IAC1EtK,UAAU,OACVe,QAAQ,kBACR,kBAAC,IAAD,CAAiB8G,KAAME,QAG3B,kBAACR,EAAA,EAAUxF,SAAX,CAAoB2F,SAAUe,GAC5B,kBAACjB,EAAA,EAAK7D,KAAN,KACE,kBAACkB,EAAA,EAAD,CAAW6D,IAAK4B,EAAa3K,IAC3B,kBAACkF,EAAA,EAAUzC,KAAX,uBAEakI,EAAazD,aAF1B,MAIA,kBAAChC,EAAA,EAAUzC,KAAX,kCAEKiE,OAAOC,WAAWgE,EAAaxD,WAAWN,QAAQ,IAEvD,kBAAC3B,EAAA,EAAUzC,KAAX,uBAEMiE,OAAOC,WAAWgE,EAAazD,cAAgBR,OAAOC,WAAWgE,EAAaxD,YAAYN,QAAQ,sBAmB5I,kBAAC,EAAD,QCnaO+D,EAAiB,WAC5B,OACE,kBAAC3L,EAAD,MAEI,gBAAE4L,EAAF,EAAEA,QAAS5K,EAAX,EAAWA,SAAU6K,EAArB,EAAqBA,aAArB,OACE,kBAACC,EAAA,EAAD,KAEID,EAAavH,QAET,kBAAC,EAAD,CACEA,QAASuH,EAAavH,QACtBU,QAAS6G,EAAa7G,UACtB,GAER,kBAAC+G,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,KACE,wBAAI5K,UAAU,oBAAd,kBAGJ,kBAAC,EAAD,MAEEwK,EAEI,kBAACG,EAAA,EAAD,CAAK3K,UAAU,+BACb,kBAAC,EAAD,OAIFJ,EAAS2I,KAAI,SAACrD,EAAG2F,GAAJ,OACX,kBAAC,EAAD,CACEnC,IAAKmC,EACL1D,QAASjC,YCtClB4F,EAAb,WAiBE,WAAY9E,EAAWU,EAAiBD,GAAgH,IAApG9G,EAAmG,uDAA9FoL,EAAQ,GAARA,GAAsBC,EAAwE,uDAA5DxF,MAASE,OAAO,yBAA0BuF,EAAkB,uDAAN,KAAM,oBACxJC,KAAKC,IAAMxL,EACXuL,KAAKE,WAAapF,EAClBkF,KAAKG,iBAAmB3E,EACxBwE,KAAKI,YAAc7E,EACnByE,KAAKK,WAAaP,EAClBE,KAAKM,WAAaP,EAvBnB,+CA2BC,OAAOC,KAAKC,KA3Bb,aA8BSM,GACRP,KAAKC,IAAMM,IA/BZ,gCAmCC,OAAOP,KAAKE,YAnCb,aAsCgBK,GACfP,KAAKE,WAAaK,IAvCnB,sCA2CC,OAAOP,KAAKG,kBA3Cb,aA8CsBI,GACrBP,KAAKG,iBAAmBI,IA/CzB,iCAmDC,OAAOP,KAAKI,aAnDb,aAsDiBG,GAChBP,KAAKI,YAAcG,IAvDpB,gCA2DC,OAAOP,KAAKK,YA3Db,aA8DgBE,GACfP,KAAKK,WAAaE,IA/DnB,gCAmEC,OAAOP,KAAKM,YAnEb,aAsEgBC,GACfP,KAAKM,WAAaC,MAvEnB,KAAaX,EA+EJY,qBAAuB,SAAApE,GAC/B,OAAOA,EAASqE,QAAO,SAAAC,GAAC,OAAIpG,IAAOoG,EAAEnF,YAAYqC,SAAStD,UAAW/F,QAhFzDqL,EAyFJe,8BAAgC,SAAAvE,GACxC,GAAIA,EAAS7H,OAAQ,CACnB,IAAMqM,EAAMtG,MAENuG,EADY,YAAOzE,GACqBqB,MAAK,SAACqD,EAAcC,GACnE,IAAMC,EAAmB1G,IAAOwG,EAAavF,YAE7C,OAD0BjB,IAAOyG,EAAcxF,YACtB0F,KAAKD,EAAkB,WAC5CjH,MAAK,SAAA2G,GAAC,OAAIpG,IAAOoG,EAAEnF,YAAYqC,SAASgD,MAE3C,OAAIC,EACEA,EAAyBrF,gBAExB,+CAET,MAAO,uCAxGKoE,EAgHJsB,gBAAkB,SAAA9E,GAC1B,OAAOA,EAASlC,MAAK,SAAA0E,GAAO,OAAItE,IAAOsE,EAAQrD,YAAY4F,cAAc7G,MAAU,Y,yBCjH9E8G,GAAS,CACbC,OAAQC,gEAAYC,SAAW,0CAC/BC,WAAYF,gEAAYG,aAAe,0CACvCC,YAAaJ,gEAAYK,cAAgB,iDACzCC,UAAWN,gEAAYO,YAAc,0BACrCC,cAAeR,gEAAYS,gBAAkB,sCAC7CC,kBAAmBV,gEAAYW,qBAAuB,eACtDC,MAAOZ,gEAAYa,QAAU,2CAG/BC,KAASC,cAAcjB,ICRhB,IAAMkB,GAAb,WA2BE,WAAYpN,EAAcC,EAAOC,EAAMyE,EAAiBD,EAAoBE,GAAkH,IAApGrF,EAAmG,uDAA9FoL,EAAQ,GAARA,GAAsBC,EAAwE,uDAA5DxF,MAASE,OAAO,yBAA0BuF,EAAkB,uDAAN,KAAM,yBAlB7LwC,UAAY,GAkBiL,KAjB7LC,UAAY,GAkBbxC,KAAKC,IAAMxL,EACXuL,KAAKyC,cAAgBvN,EACrB8K,KAAK0C,OAASvN,EACd6K,KAAK2C,MAAQvN,EACb4K,KAAK4C,iBAAmB/I,EACxBmG,KAAK6C,oBAAsBjJ,EAC3BoG,KAAK8C,cAAgBhJ,EACrBkG,KAAK+C,aAAe/C,KAAKgD,uBACzBhD,KAAKK,WAAaP,EAClBE,KAAKM,WAAaP,EArCnB,uDA4CakD,GACZjD,KAAK/F,SAASzF,KAAKyO,GACnBjD,KAAKkD,0BA9CN,wCAqDoBlE,GACnB,GAAIA,EAAW,CACb,IAAMmE,EAAY,YAAOnD,KAAK/F,UACxBmJ,EAAqBD,EAAapJ,MAAK,SAAA8D,GAAO,OAAIA,EAAQpJ,KAAOuK,KAEnEoE,IACLpD,KAAK/F,SAAWkJ,EAAa1C,QAAO,SAAA5C,GAAO,OAAIA,EAAQpJ,KAAO2O,EAAmB3O,MACjFuL,KAAKkD,4BA5DP,+CAsE2B3E,EAASS,GACnCgB,KAAK/F,SAASF,MAAK,SAAAI,GAAC,OAAIA,EAAE1F,KAAOuK,KAAWqE,cAAc9E,GAC1DyB,KAAKkD,0BAxEN,iCA+EaI,GACZtD,KAAK/F,SAASF,MAAK,SAAAI,GAAC,OAAIA,EAAE1F,KAAO6O,EAAWtE,aAAWuE,WAAWD,GAClEtD,KAAKkD,0BAjFN,iCAwFaM,GACZxD,KAAK5D,SAAS5H,KAAKgP,KAzFpB,wCA4FoBC,GACnB,GAAIA,EAAW,CACb,IAAMC,EAAY,YAAO1D,KAAK5D,UACxBuH,EAAqBD,EAAa3J,MAAK,SAAA6E,GAAO,OAAIA,EAAQnK,KAAOgP,KAEnEE,IACL3D,KAAK5D,SAAWsH,EAAajD,QAAO,SAAA7B,GAAO,OAAIA,EAAQnK,KAAOkP,EAAmBlP,UAlGnF,sCA2GkBmP,GACjB5D,KAAK/F,SAASF,MAAK,SAAAI,GAAC,OAAIA,EAAE1F,KAAOmP,EAAgB5E,aAAW6E,gBAAgBD,KA5G7E,oDAoHgCxE,EAAcJ,GAC7CgB,KAAK/F,SAASF,MAAK,SAAAI,GAAC,OAAIA,EAAE1F,KAAOuK,KAAW8E,mBAAmB1E,KArHhE,qCAsOC,MAAQ,CACN,QAAU,GAAV,OAAcY,KAAK9K,aAAnB,YAAmC8K,KAAK7K,MAAxC,aAAkD6K,KAAK5K,KAAvD,KACA,sBAAuB4K,KAAKpG,mBAC5B,6BAA6B,GAA7B,OAAiCoG,KAAKnG,gBAAtC,OACA,sBAAuB+F,EAAQY,qBAAqBR,KAAK5D,UACzD,mBAAmB,KAAnB,OAAyBjB,OAAOC,WAAW4E,KAAK+D,4BAA4BzI,QAAQ,IACpF,oCAAqCH,OAAOC,WAAWwE,EAAQe,8BAA8BX,KAAK5D,WAA7D,UAA6E4D,KAAKnG,gBAAkB+F,EAAQe,8BAA8BX,KAAK5D,UAA/I,OAAgKwD,EAAQe,8BAA8BX,KAAK5D,UAChP,eAAe,GAAf,OAAmB4D,KAAKgD,wBACxB,mBAAoBpD,EAAQsB,gBAAgBlB,KAAK5D,UAAY,MAAQ,QA9OxE,iDAuPC,OAAO4D,KAAK/F,SAASgE,QAAO,SAAC+F,EAAO7J,GAIlC,OAHIgB,OAAOC,WAAWjB,EAAEkB,eACzB2I,GAAS7J,EAAEkB,aAEH2I,IACN,KA5PJ,6CAqQC,IAMMC,EALJjE,KAAK/F,SAASgE,QAAO,SAACxC,EAAeoC,GAEtC,OADApC,EAAcjH,KAAd,MAAAiH,EAAa,YAASoC,EAAQpC,gBACvBA,IACH,IAEuCwC,QAAO,SAACiG,EAAW9E,GAE7D,OADA8E,GAAa9E,EAAaxD,UAAYwD,EAAazD,eAElD,GAEGwI,EAAyBnE,KAAKoE,kCAEpC,OAAIjJ,OAAOkJ,MAAMJ,IAA0B9I,OAAOkJ,MAAMF,KAA4BhJ,OAAOmJ,SAAUL,EAAwBE,GACpH,qDAGH,GAAN,QAAyB,KADJF,EAAwBE,IACf7I,QAAQ,GAAtC,iBAtRD,wDA8RC,OACE0E,KAAK/F,SAASgE,QAAO,SAACsG,EAAe1G,GAItC,OAHAA,EAAQzD,SAAS8D,SAAQ,SAAA7D,GACvBkK,GAAiBlK,EAAEM,0BAA4BN,EAAEK,8BAChD,GACI6J,IACH,KApSN,8CA6SoE,IAA5CC,EAA2C,4DAAhCC,EAAWC,IAAqB,yDAClE,GAAI1E,KAAK/F,SAAS1F,QAEZyL,KAAK/F,SAAS1F,OAAQ,CAC3B,IAAMoQ,EAAiB3E,KAAK/F,SAASgE,QAAO,SAAC5D,EAAGF,GAI9C,OAHIA,EAAEC,SAAS7F,QAChB8F,EAAE7F,KAAF,MAAA6F,EAAC,YAASF,EAAEC,SAASqG,QAAO,SAAApG,GAAC,OAAIC,IAAOD,EAAEI,gBAAgBmK,OAAOtK,MAAU,aAEnED,IACN,IAIGwK,EAAsBF,EAAe1G,QAAO,SAAC4G,EAAqBxK,GACtE,OAAOyK,KAAKC,IAAIF,EAAqBxK,EAAEM,6BACtC,GAKH,GAFAqF,KAAKnG,gBAAkBgL,GAA4C7E,KAAKnG,gBAEpE6K,EAAc,CAEhB,IAAMM,EAAK5C,KAAS6C,YACpBD,EACAE,WAAW,YACXC,IAAInF,KAAKvL,IACT2Q,OAAO,CACN,iBAAoBpF,KAAKnG,gBACzB,WAAcS,MAASE,OAAO,2BAE/B6K,KAAKb,GACLc,MAAMC,QAAQC,SA5UlB,+BAyHC,OAAOxF,KAAKuC,WAzHb,aA4HehC,GACdP,KAAKuC,UAAYhC,IA7HlB,+BAiIC,OAAOP,KAAKuC,UAAUtE,QAAO,SAAC7D,EAAUD,GAItC,OAHAA,EAAEC,SAAS8D,SAAQ,SAAA7D,GACpBD,EAAS5F,KAAK6F,MAEND,IACN,MAtIJ,+BA0IC,OAAO4F,KAAKwC,WA1Ib,aA6IejC,GACdP,KAAKwC,UAAYjC,IA9IlB,oCAkJC,OAAOP,KAAKyF,gBAlJb,aAqJoBlF,GACnBP,KAAKyF,eAAiBlF,IAtJvB,yBA0JC,OAAOP,KAAKC,KA1Jb,aA6JSM,GACRP,KAAKC,IAAMM,IA9JZ,mCAkKC,OAAOP,KAAKyC,eAlKb,aAqKmBlC,GAClBP,KAAKyC,cAAgBlC,IAtKtB,4BA0KC,OAAOP,KAAK0C,QA1Kb,aA6KYnC,GACXP,KAAK0C,OAASnC,IA9Kf,2BAkLC,OAAOP,KAAK2C,OAlLb,aAqLWpC,GACVP,KAAK2C,MAAQpC,IAtLd,sCA0LC,OAAOP,KAAK4C,kBA1Lb,aA6LsBrC,GACrBP,KAAK4C,iBAAmBrC,IA9LzB,yCAkMC,OAAOP,KAAK6C,qBAlMb,aAqMyBtC,GACxBP,KAAK6C,oBAAsBtC,IAtM5B,mCA0MC,OAAOP,KAAK8C,eA1Mb,aA6MmBvC,GAClBP,KAAK8C,cAAgBvC,IA9MtB,gCAkNC,OAAOP,KAAKK,YAlNb,aAqNgBE,GACfP,KAAKK,WAAaE,IAtNnB,gCA0NC,OAAOP,KAAKM,YA1Nb,aA6NgBC,GACfP,KAAKM,WAAaC,MA9NnB,K,kBCMMmF,GAASC,YAAaC,MAAM,CAChC1Q,aAAcyQ,YAAalM,OAAOoM,SAAS,0BAC3C1Q,MAAOwQ,YAAalM,OAAOoM,SAAS,0BACpCzQ,KAAMuQ,YAENG,IAAIxL,MAASyL,SAAS,GAAI,SAASC,IAAI,QAAS,WAChDjB,IACCzK,MACA2L,IAAI,EAAG,QACPD,IAAI,QACJ,gBAEDpM,mBAAoB+L,YAEpBlM,OACAlF,OAAO,EAAG,6BACV2R,QAAQ,mBAAoB,sCAC5BL,SAAS,0BACThM,gBAAiB8L,YAAaG,IAAI,EAAG,mBAAmBD,SAAS,0BACjE/L,aAAc6L,YAAaG,IAAI,EAAG,2BAevBK,GAAc,SAAAvO,GAAU,IAAD,EACFgB,qBAAWvF,GAApCiM,EAD2B,EAC3BA,QAASC,EADkB,EAClBA,aACVrL,EAAUC,cACViS,EAAuBnS,iBAAO,MAC/BgI,EAA+BrE,EAA/BqE,QAAS7H,EAAsBwD,EAAtBxD,aAAc0B,EAAQ8B,EAAR9B,KAE5B,OACD,kBAAC0J,EAAA,EAAD,KAECD,GAAgBA,EAAavH,QAE5B,kBAAC,EAAD,CACEA,QAASuH,EAAavH,QACtBU,QAAS6G,EAAa7G,UACnB,GAEL,kBAAC+G,EAAA,EAAD,KACD,kBAACC,EAAA,EAAD,KAGY,QAAT5J,EAEC,wBAAIhB,UAAU,oBAAd,qBAIA,wBAAIA,UAAU,oBAAd,iBAESmH,EAAO,UAAMA,EAAQ/G,aAAd,YAA8B+G,EAAQ9G,MAAtC,aAAgD8G,EAAQ7G,KAAxD,WAOpBkK,EAEC,kBAACG,EAAA,EAAD,CAAK3K,UAAU,+BACb,kBAAC,EAAD,OAKF,kBAAC,KAAD,CACEuR,iBAAkBX,GAClB7Q,SAAU,SAACyR,GAAD,OAAYlS,EAAakS,IACnCC,cAAe,CAChBrR,aAAc+G,EAAUA,EAAQ/G,aAAX,GACrBC,MAAO8G,EAAUA,EAAQ9G,MAAX,GACdC,KAAM6G,EAAUA,EAAQ7G,KAAX,GACbwE,mBAAoBqC,EAAUA,EAAQrC,mBAAX,GAC3BC,gBAAiBoC,EAAUA,EAAQpC,gBAAX,GACxBC,aAAcmC,EAAUA,EAAQnC,aAAX,MAGnB,gBACA1F,EADA,EACAA,aACAoS,EAFA,EAEAA,aACAC,EAHA,EAGAA,UACAH,EAJA,EAIAA,OACAI,EALA,EAKAA,QACAC,EANA,EAMAA,OACAC,EAPA,EAOAA,aAPA,OASF,kBAACjS,EAAA,EAAD,CAAMkS,YAAU,EAAChS,SAAUT,GACzB,kBAACO,EAAA,EAAK8K,IAAN,CAAU3K,UAAU,WACrB,kBAACH,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIkJ,IAAKqH,UAAU,eAAeC,GAAG,IAAIC,GAAG,MACtD,kBAACtS,EAAA,EAAKuS,MAAN,qBAAyB,0BAAMpS,UAAU,eAAhB,MACzB,kBAACH,EAAA,EAAKwS,QAAN,CACDxR,IAAKyQ,EACL1Q,SAAU8Q,EACVY,KAAK,eACL7G,MAAO+F,EAAOpR,aACdY,KAAK,OACLP,YAAY,kBACZ8R,YAAaV,EAAOzR,aACpBoS,QAASZ,EAAQxR,eAAiByR,EAAOzR,eAExC,kBAACP,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAOzR,eAIT,kBAACP,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIkJ,IAAKqH,UAAU,QAAQC,GAAG,IAAIC,GAAG,MAC/C,kBAACtS,EAAA,EAAKuS,MAAN,cAAkB,0BAAMpS,UAAU,eAAhB,MAClB,kBAACH,EAAA,EAAKwS,QAAN,CACDzR,SAAU8Q,EACVY,KAAK,QACL7G,MAAO+F,EAAOnR,MACdW,KAAK,OACLP,YAAY,WACZ+R,QAASZ,EAAQvR,QAAUwR,EAAOxR,MAClCkS,YAAaV,EAAOxR,QAEnB,kBAACR,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAOxR,QAIT,kBAACR,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIkJ,IAAKqH,UAAU,OAAOC,GAAG,IAAIC,GAAG,MAC9C,kBAACtS,EAAA,EAAKuS,MAAN,cACA,kBAACvS,EAAA,EAAKwS,QAAN,CACDzR,SAAU8Q,EACVY,KAAK,OACL7G,MAAO+F,EAAOlR,KACdU,KAAK,SACLgQ,IAAKxL,MAASyL,SAAS,GAAI,SAASC,IAAI,QACxCjB,IAAKzK,MAAS2L,IAAI,EAAG,QAAQD,IAAI,QACjCwB,KAAK,IACLjS,YAAY,UACZ+R,QAASZ,EAAQtR,OAASuR,EAAOvR,KACjCiS,YAAaV,EAAOvR,OAEnB,kBAACT,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAOvR,QAKR,kBAACT,EAAA,EAAK8K,IAAN,CAAU3K,UAAU,WACrB,kBAACH,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIkJ,IAAKqH,UAAU,qBAAqBC,GAAG,IAAIC,GAAG,MAC5D,kBAACtS,EAAA,EAAKuS,MAAN,4BAAgC,0BACjCpS,UAAU,eADuB,MAEhC,kBAACH,EAAA,EAAKwS,QAAN,CACDzR,SAAU8Q,EACVY,KAAK,qBACL7G,MAAO+F,EAAO1M,mBACd9D,KAAK,OACLP,YAAY,yBACZ+R,QAASZ,EAAQ9M,qBAAuB+M,EAAO/M,mBAC/CyN,YAAaV,EAAO/M,qBAEnB,kBAACjF,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAO/M,sBAKR,kBAACjF,EAAA,EAAK8K,IAAN,CAAU3K,UAAU,WACrB,kBAACH,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIkJ,IAAKqH,UAAU,kBAAkBC,GAAG,IAAIC,GAAG,MACzD,kBAACtS,EAAA,EAAKuS,MAAN,yCAA6C,0BAC9CpS,UAAU,eADoC,MAE7C,kBAACH,EAAA,EAAKwS,QAAN,CACDzR,SAAU8Q,EACVY,KAAK,kBACL7G,MAAO+F,EAAOzM,gBACd/D,KAAK,SACLP,YAAY,sBACZ+R,QAASZ,EAAQ7M,kBAAoB8M,EAAO9M,gBAC5CwN,YAAaV,EAAO9M,kBAEnB,kBAAClF,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAO9M,mBAKR,kBAAClF,EAAA,EAAK8K,IAAN,CAAU3K,UAAU,WACrB,kBAACH,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIkJ,IAAKqH,UAAU,eAAeC,GAAG,IAAIC,GAAG,MACtD,kBAACtS,EAAA,EAAKuS,MAAN,mCACA,kBAACvS,EAAA,EAAKwS,QAAN,CACDzR,SAAU8Q,EACVY,KAAK,eACL7G,MAAO+F,EAAOxM,aACdhE,KAAK,SACLP,YAAY,mBACZ+R,QAASZ,EAAQ5M,eAAiB6M,EAAO7M,aACzCuN,YAAaV,EAAO7M,eAEnB,kBAACnF,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAO7M,gBAIR,kBAAC2F,EAAA,EAAD,CAAK3K,UAAU,0BAChB,kBAACc,EAAA,EAAD,CACEC,QAAQ,UACRoD,KAAK,KACLnD,KAAK,SACLhB,UAAU,OACV2S,SAAUb,GAGF,QAAT9Q,EAAA,8BAGD,kBAACF,EAAA,EAAD,CACEC,QAAQ,UACRoD,KAAK,KACLnE,UAAU,OACViB,QAAS,WACV0Q,IACAL,EAAqBpQ,QAAQE,UAIjB,QAATJ,EAAA,mBAGJ,kBAACF,EAAA,EAAD,CACEC,QAAQ,SACRoD,KAAK,KACLlD,QAAS,kBAAM7B,EAAQM,KAAR,aAHjB,iBC5OQkT,GAAa,WAAO,IACxBC,EAAe/O,qBAAWvF,GAA1BsU,YACDzT,EAAUC,cAEhB,OACD,kBAAC,GAAD,CACE2B,KAAK,MACL1B,aAAc,SAAAkS,GAAW,IACnBpR,EAAgFoR,EAAhFpR,aAAcC,EAAkEmR,EAAlEnR,MAAOC,EAA2DkR,EAA3DlR,KAAMyE,EAAqDyM,EAArDzM,gBAAiBD,EAAoC0M,EAApC1M,mBAAoBE,EAAgBwM,EAAhBxM,aACjE8N,EAAmB,IAAItF,GAAQpN,EAAcC,EAAOC,EAAMyE,EAAiBD,EAAoBE,GAErG6N,EAAY,UAAWC,GACvB1T,EAAQM,KAAR,gBAAsBoT,EAAiBnT,SChBnCoT,GAAYhI,EAAQ,IAObiI,GAAc,WAAO,IAAD,EACClP,qBAAWvF,GAApCqB,EADwB,EACxBA,SAAUqT,EADc,EACdA,YACX7T,EAAUC,cACT2G,EAAakN,cAAblN,UAEDmN,EAAoBvT,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEvF,KAAOqG,KAClDmB,EAAU4L,GAAUI,GAExB,OACD,kBAAC,GAAD,CACEnS,KAAK,OACLmG,QAASA,EACT7H,aAAc,SAAAkS,GACf,IAAK,IAAIhJ,KAASgJ,EACZrK,EAAQiM,eAAR,WAA2B5K,MAChCrB,EAAQqB,GAASgJ,EAAOhJ,IAGzBrB,EAAQ8D,UAAYzF,MAASE,OAAO,yBACpCuN,EAAY9L,GACZ/H,EAAQM,KAAR,gBAAsByH,EAAQxH,S,SC3BnB0T,GAAb,WA0BE,WAAYrN,EAAWI,EAAaH,EAAWC,EAASC,GAAuI,IAAxH+C,EAAuH,uDAAzG,KAAMvJ,EAAmG,uDAA9FoL,EAAQ,GAARA,GAAsBC,EAAwE,uDAA5DxF,MAASE,OAAO,yBAA0BuF,EAAkB,uDAAN,KAAM,yBAtB9LqI,UAAY,GAsBkL,KArB9L3C,eAAiB,GAsBlBzF,KAAKC,IAAMxL,EACXuL,KAAKE,WAAapF,EAClBkF,KAAKqI,aAAenN,EACpB8E,KAAKsI,WAAavN,EAClBiF,KAAKuI,SAAWvN,EAChBgF,KAAKwI,eAAiBvN,EACtB+E,KAAKyI,aAAezK,EACpBgC,KAAKK,WAAaP,EAClBE,KAAKM,WAAaP,EAClBC,KAAK0I,aAAe1I,KAAK2I,uBApC1B,gEA+IgE,IAAD,OAA3CnE,EAA2C,4DAAhCC,EAAWC,IAAqB,yDAC9D,GAAI1E,KAAK5F,SAAS7F,OAAQ,CACxB,IAAIqU,EAAc5I,KAAK5F,SAAS,GAChC4F,KAAK5F,SAAS8D,SAAQ,SAAC7D,EAAGsF,GACvBtF,EAAEM,0BAA4BiO,EAAYjO,4BAC5CiO,EAAc,EAAKxO,SAASuF,OAG7BK,KAAKhC,YAAc4K,EAAYjO,+BAE/BqF,KAAKhC,YAAc,KAErB,GAAI0G,EAAc,CAEhB,IAAMM,EAAK5C,KAAS6C,YACpBD,EACAE,WAAW,YACXC,IAAInF,KAAKvL,IACT2Q,OAAO,CACN,aAAgBpF,KAAKhC,YACrB,WAAc1D,MAASE,OAAO,2BAE/B6K,KAAKb,GACLc,OAAM,SAAAuD,GAAG,OAAItD,QAAQC,IAAIqD,SAtK5B,sCA8KkBjF,GACjB5D,KAAKvE,cAAcjH,KAAKoP,KA/KzB,iCAsLaN,GACZtD,KAAK5F,SAAS5F,KAAK8O,GACnBtD,KAAK8I,oBACL9I,KAAK3E,YAAc2E,KAAK2I,yBAzLzB,oCAgMgBpK,GACfyB,KAAK5F,SAAW4F,KAAK5F,SAASqG,QAAO,SAAApG,GAAC,OAAIA,EAAE5F,KAAO8J,EAAQ9J,MAC3DuL,KAAK8I,oBACL9I,KAAK3E,YAAc2E,KAAK2I,yBAnMzB,yCA0MqBvJ,GACpBY,KAAKvE,cAAgBuE,KAAKvE,cAAcgF,QAAO,SAAA/E,GAAC,OAAIA,EAAEjH,KAAO2K,EAAa3K,QA3M3E,6CAmNC,IAAI4G,EAAc,EAClB,GAAyB,MAArB2E,KAAK9E,YAAqB,CAC5B,IAAI6N,EAAOzO,IAAO0F,KAAKhF,SAASiG,KAAKjB,KAAKjF,UAAW,QACxC,IAATgO,IAAYA,EAAO,GACvB1N,EAAqB,IAAP0N,OAEV/I,KAAKhC,cACV3C,EAAe2E,KAAKhC,YAAcgC,KAAK/E,eAGxC,OAAOI,IA7NR,yBAwCC,OAAO2E,KAAKC,KAxCb,aA2CSM,GACRP,KAAKC,IAAMM,IA5CZ,gCAgDC,OAAOP,KAAKE,YAhDb,aAmDgBK,GACfP,KAAKE,WAAaK,IApDnB,kCAwDC,OAAOP,KAAKqI,cAxDb,aA2DkB9H,GACjBP,KAAKqI,aAAe9H,IA5DrB,gCAgEC,OAAOP,KAAKsI,YAhEb,aAmEgB/H,GACfP,KAAKsI,WAAa/H,IApEnB,8BAwEC,OAAOP,KAAKuI,UAxEb,aA2EchI,GACbP,KAAKuI,SAAWhI,IA5EjB,oCAgFC,OAAOP,KAAKwI,gBAhFb,aAmFoBjI,GACnBP,KAAKwI,eAAiBjI,IApFvB,kCAwFC,OAAOP,KAAKyI,cAxFb,aA2FkBlI,GACjBP,KAAKyI,aAAelI,IA5FrB,gCAgGC,OAAOP,KAAKK,YAhGb,aAmGgBE,GACfP,KAAKK,WAAaE,IApGnB,gCAwGC,OAAOP,KAAKM,YAxGb,aA2GgBC,GACfP,KAAKM,WAAaC,IA5GnB,+BAgHC,OAAOP,KAAKoI,WAhHb,aAmHe7H,GACdP,KAAKoI,UAAY7H,IApHlB,kCAwHC,OAAOP,KAAK0I,cAxHb,aA2HkBnI,GACjBP,KAAK0I,aAAenI,IA5HrB,oCAiIC,OAAOP,KAAKyF,gBAjIb,aAoIoBuD,GACnBhJ,KAAKyF,eAAiBuD,MArIvB,KCaaC,GAAe,SAAArR,GAC1B,OACD,kBAACoB,EAAA,EAAD,CACEnB,KAAMD,EAAMC,KACZsB,OAAQvB,EAAMsR,cACdjQ,KAAK,KACLI,kBAAgB,gCAChBC,UAAQ,GAER,kBAACN,EAAA,EAAMR,OAAP,CAAce,aAAW,GAC1B,kBAACP,EAAA,EAAMQ,MAAP,CAAa/E,GAAG,iCAAhB,YAIC,kBAACuE,EAAA,EAAMP,KAAP,KACD,4BAAKb,EAAMuR,QACX,2BACGvR,EAAMwR,OAGR,kBAACpQ,EAAA,EAAM8C,OAAP,KACD,kBAAClG,EAAA,EAAD,CACAG,QAAS6B,EAAMyR,cACfpQ,KAAK,KACLpD,QAAQ,UAEL+B,EAAM0R,QAET,kBAAC1T,EAAA,EAAD,CACEC,QAAQ,OACRoD,KAAK,KACLlD,QAAS6B,EAAMsR,eACdtR,EAAM2R,WCvCLjP,GAASkP,wBAAaC,KACtB5B,GAAYhI,EAAQ,IAOb6J,GAAa,WAAO,IAAD,EACyC9Q,qBAAWvF,GAA3EiM,EADuB,EACvBA,QAASC,EADc,EACdA,aAAc7K,EADA,EACAA,SAAUiT,EADV,EACUA,YAAa9O,EADvB,EACuBA,eADvB,EAEgBhF,mBAAS,CAAC8V,QAAQ,EAAO9L,QAAS,OAFlD,mBAEvB+L,EAFuB,KAENC,EAFM,OAGgBhW,mBAAS,CAAC8V,QAAQ,EAAO/K,QAAS,OAHlD,mBAGvBkL,EAHuB,KAGNC,EAHM,OAIkBlW,mBAAS,MAJ3B,mBAIvBmW,EAJuB,KAILC,EAJK,OAKMpW,oBAAS,GALf,mBAKvBqW,EALuB,KAKXC,EALW,KAMvBrP,EAAakN,cAAblN,UACD5G,EAAUC,cACViW,EAAsB1V,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEvF,KAAOqG,KAClDmB,EAAU4L,GAAUuC,GAGpB1E,EAASC,YAAaC,MAAM,CACnC1K,YAAayK,YAAaE,SAAS,0BACnC9K,UAAW4K,UAERG,IAAIxL,KAASyL,SAAS,EAAG,OAAQ,2CACjChB,IAAIzK,GAAOA,KAAU,cAAc2L,IAAI,EAAG,QAAS,gBACnDJ,SAAS,0BACZ7K,QAAS2K,UAENG,IAAIxL,KAASyL,SAAS,EAAG,OAAQ,gBACjCD,IAAIH,OAAQ,aAAc,yCAC1BZ,IAAIzK,GAAOA,KAAU,cAAc2L,IAAI,EAAG,QAAS,gBACnDJ,SAAS,0BACZ5K,cAAe0K,YAEZG,IAAI7J,EAAUA,EAAQpC,gBAAkB,EAAG,iDAC3CgM,SAAS,4BAKLwE,EAAkC,SAACC,EAAwBC,EAAoBC,EAAiBC,GACvG5R,EAAekD,sBAAsBuO,EAAwBC,GAC7D1R,EAAeO,2BAA2B,KAAM,MAAM,WACpDuO,EAAY6C,EAAiBC,GAC7BvW,EAAQM,KAAR,gBAAsByH,EAAQxH,SAa/B,OAPAiW,qBAAU,WACPR,GAAcF,IAChBrC,EAAY,UAAWqC,GACvB9V,EAAQM,KAAR,gBAAsByH,EAAQxH,QAE5B,CAACyV,IAGL,kBAAC1K,EAAA,EAAD,KAECD,GAAgBA,EAAavH,QAE5B,kBAAC,EAAD,CACEA,QAASuH,EAAavH,QACtBU,QAAS6G,EAAa7G,UACnB,GAEL,kBAAC+G,EAAA,EAAD,KACD,kBAACC,EAAA,EAAD,KACE,wBAAI5K,UAAU,oBAAd,wBACKmH,EAAO,UAAMA,EAAQ/G,aAAd,YAA8B+G,EAAQ9G,MAAtC,aAAgD8G,EAAQ7G,KAAxD,KAAkE,MAG/E,kBAAC,GAAD,CACD+D,OAAQ,kBAAM0Q,EAAmB,CAACF,QAAQ,KAC1C9R,KAAM+R,EAAgBD,OACtBR,OAAO,mBACPC,KAAI,2GAAsGQ,EAAgB/L,QAAUvD,GAAOsP,EAAgB/L,QAAQ9C,UAAW,cAAcP,OAAO,cAAgB,GAA/M,gBAAyNoP,EAAgB/L,QAAUvD,GAAOsP,EAAgB/L,QAAQ7C,QAAS,cAAcR,OAAO,cAAgB,GAAhU,sEACJ8O,OAAO,gCACPC,OAAO,uBACPF,cAAe,WACbgB,EAAgC,UAAWT,EAAgB/L,QAAS,UAAWmM,IAEjFd,cAAe,kBAAMW,EAAmB,CAACF,QAAQ,OAEhD,kBAAC,GAAD,CACDxQ,OAAQ,kBAAM4Q,EAAmB,CAACJ,QAAQ,KAC1C9R,KAAMiS,EAAgBH,OACtBR,OAAO,mBACPC,KAAI,iGAA4FU,EAAgBlL,QAAUtE,GAAOwP,EAAgBlL,QAAQrD,WAAY,cAAcf,OAAO,cAAgB,GAAtM,iEACJ8O,OAAO,0BACPC,OAAO,uBACPF,cAAe,WACbgB,EAAgC,UAAWP,EAAgBlL,QAAS,UAAWoL,IAEjFd,cAAe,kBAAMa,EAAmB,CAACJ,QAAQ,OAGjDrK,EAEC,kBAACG,EAAA,EAAD,CAAK3K,UAAU,+BACb,kBAAC,EAAD,OAKF,kBAAC,KAAD,CACEuR,iBAAkBX,EAClB7Q,SAAU,SAACyR,GAAY,IACjBpL,EAAkDoL,EAAlDpL,YAAaH,EAAqCuL,EAArCvL,UAAWC,EAA0BsL,EAA1BtL,QAASC,EAAiBqL,EAAjBrL,cAClC4C,EAAU,IAAIsK,GAAQlM,EAAQxH,GAAIyG,EAAaH,EAAWC,EAASC,GAIzE,GAHAgP,EAAoBpM,GAGhB5B,EAAQhC,SAASC,MAAK,SAAAC,GACxB,OAAOG,GAAOqQ,MAAMrQ,GAAOH,EAAEY,UAAW,cAAeT,GAAOH,EAAEa,QAAS,eAAe4P,SAAStQ,GAAOqQ,MAAMrQ,GAAOS,EAAW,cAAeT,GAAOU,EAAS,mBAC7J,CACF,IAAM4O,EAAkB3N,EAAQhC,SAASF,MAAK,SAAAI,GAAC,OAAIG,GAAOqQ,MAAMrQ,GAAOH,EAAEY,UAAW,cAAeT,GAAOH,EAAEa,QAAS,eAAe4P,SAAStQ,GAAOqQ,MAAMrQ,GAAOS,EAAW,cAAeT,GAAOU,EAAS,mBAC3M6O,EAAmB,CACpBF,QAAQ,EACR9L,QAAS+L,SAIL,GAAI3N,EAAQG,SAASlC,MAAK,SAAAwG,GAAC,OAAIpG,GAAOoG,EAAEnF,WAAY,cAAcsP,OAAOvQ,GAAOqQ,MAAMrQ,GAAOS,EAAW,cAAeT,GAAOU,EAAS,mBAAkB,CAE5J,IAAM8O,EAAkB7N,EAAQG,SAASrC,MAAK,SAAA2G,GAAC,OAAIpG,GAAOoG,EAAEnF,WAAY,cAAcsP,OAAOvQ,GAAOqQ,MAAMrQ,GAAOS,EAAW,cAAeT,GAAOU,EAAS,mBAC3J+O,EAAmB,CACpBJ,QAAQ,EACR/K,QAASkL,SAIRK,GAAc,IAGf5D,cAAe,CAChBrL,YAAa,IACbH,UAAWT,GAAOA,KAAU,cAAcE,OAAO,cACjDQ,QAASV,GAAOA,KAAU,cAAc2L,IAAI,EAAG,OAAOzL,OAAO,cAC7DS,cAAegB,EAAUA,EAAQpC,gBAAkB,KAGjD,gBACAzF,EADA,EACAA,aACAoS,EAFA,EAEAA,aACAC,EAHA,EAGAA,UACAH,EAJA,EAIAA,OACAI,EALA,EAKAA,QACAC,EANA,EAMAA,OACAC,EAPA,EAOAA,aAPA,OASF,kBAACjS,EAAA,EAAD,CACEE,SAAUT,GAEV,kBAACO,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIiJ,IAAKsH,UAAU,eAChC,kBAACpS,EAAA,EAAKuS,MAAN,CAAY4D,OAAO,OAAOC,GAAG,KAA7B,gBAA8C,0BAC5CjW,UAAU,eADkC,MAE9C,kBAAC4K,EAAA,EAAD,CAAKqL,GAAG,MACN,kBAACpW,EAAA,EAAKwS,QAAN,CACD3Q,GAAG,SACH4Q,KAAK,cACL7G,MAAO+F,EAAOpL,YACdxF,SAAU8Q,EACVc,QAASZ,EAAQxL,cAAgByL,EAAOzL,YACxCmM,YAAaV,EAAOzL,aAEpB,4BACEqF,MAAM,KADR,WAIA,4BACEA,MAAM,KADR,kBAKC,kBAAC5L,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAOzL,eAIR,kBAACvG,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIiJ,IAAKsH,UAAU,aAChC,kBAACpS,EAAA,EAAKuS,MAAN,CAAY4D,OAAO,OAAOC,GAAG,KAA7B,cAA4C,0BAC1CjW,UAAU,eADgC,MAE5C,kBAAC4K,EAAA,EAAD,CAAKqL,GAAG,MACN,kBAACpW,EAAA,EAAKwS,QAAN,CACDzR,SAAU8Q,EACVY,KAAK,YACL7G,MAAO+F,EAAOvL,UACdjF,KAAK,OACLuR,YAAaV,EAAO5L,UACpBuM,QAASZ,EAAQ3L,YAAc4L,EAAO5L,YAErC,kBAACpG,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAO5L,aAIR,kBAACpG,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIiJ,IAAKsH,UAAU,WAChC,kBAACpS,EAAA,EAAKuS,MAAN,CAAY4D,OAAO,OAAOC,GAAG,KAA7B,YAA0C,0BACxCjW,UAAU,eAD8B,MAE1C,kBAAC4K,EAAA,EAAD,CAAKqL,GAAG,MACN,kBAACpW,EAAA,EAAKwS,QAAN,CACDzR,SAAU8Q,EACVY,KAAK,UACL7G,MAAO+F,EAAOtL,QACdlF,KAAK,OACLuR,YAAaV,EAAO3L,QACpBsM,QAASZ,EAAQ1L,UAAY2L,EAAO3L,UAEnC,kBAACrG,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAO3L,WAIR,kBAACrG,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIiJ,IAAKsH,UAAU,iBAChC,kBAACpS,EAAA,EAAKuS,MAAN,CAAY4D,OAAO,OAAOC,GAAG,KAA7B,kBAAgD,0BAC9CjW,UAAU,eADoC,MAEhD,kBAAC4K,EAAA,EAAD,CAAKqL,GAAG,MACN,kBAACpW,EAAA,EAAKwS,QAAN,CACDzR,SAAU8Q,EACVY,KAAK,gBACL7G,MAAO+F,EAAOrL,cACdnF,KAAK,SACLP,YAAY,oBACZ+R,QAASZ,EAAQzL,gBAAkB0L,EAAO1L,cAC1CoM,YAAaV,EAAO1L,gBAEnB,kBAACtG,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAO1L,iBAIR,kBAACwE,EAAA,EAAD,CAAK3K,UAAU,+BAChB,kBAACc,EAAA,EAAD,CACEC,QAAQ,UACRoD,KAAK,KACLnD,KAAK,SACLhB,UAAU,OACV2S,SAAUb,GALZ,eASA,kBAAChR,EAAA,EAAD,CACEC,QAAQ,UACRoD,KAAK,KACLnE,UAAU,OACViB,QAAS0Q,GAJX,SAQA,kBAAC7Q,EAAA,EAAD,CACEC,QAAQ,SACRoD,KAAK,KACLlD,QAAS,kBAAM7B,EAAQM,KAAR,gBAAsBsG,MAHvC,iBC5PC+M,GAAYhI,EAAQ,IACpBvF,GAASkP,wBAAaC,KAOfuB,GAAa,WAAO,IAAD,EACyCpS,qBAAWvF,GAA3EiM,EADuB,EACvBA,QAASC,EADc,EACdA,aAAc7K,EADA,EACAA,SAAUiT,EADV,EACUA,YAAa9O,EADvB,EACuBA,eADvB,EAEgBhF,mBAAS,CAAC8V,QAAQ,EAAO9L,QAAS,OAFlD,mBAEvB+L,EAFuB,KAENC,EAFM,OAGgBhW,mBAAS,CAAC8V,QAAQ,EAAO/K,QAAS,OAHlD,mBAGvBkL,EAHuB,KAGNC,EAHM,OAIkBlW,mBAAS,MAJ3B,mBAIvBoX,EAJuB,KAILC,EAJK,OAKMrX,oBAAS,GALf,mBAKvBsX,EALuB,KAKXC,EALW,KAMvBtQ,EAAakN,cAAblN,UACD5G,EAAUC,cACViW,EAAsB1V,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEvF,KAAOqG,KAClDmB,EAAU4L,GAAUuC,GAIpBC,EAAkC,SAACC,EAAwBC,EAAoBC,EAAiBC,GACvG5R,EAAekD,sBAAsBuO,EAAwBC,GAC7D1R,EAAeO,2BAA2B,KAAM,MAAM,WACpDuO,EAAY6C,EAAiBC,GAC7BvW,EAAQM,KAAR,gBAAsByH,EAAQxH,SAKzBiR,EAASC,YAAaC,MAAM,CACnCrK,WAAYoK,UAETG,IAAIxL,KAASyL,SAAS,EAAG,OAAQ,gBACjCF,SAAS,0BACZrK,gBAAiBmK,YAEdG,IAAI7J,EAAUA,EAAQpC,gBAAkB,EAC1C,4BACEgM,SAAS,4BAYX,OAPA6E,qBAAU,WACPS,GAAcF,IAChBtD,EAAY,UAAWsD,GACvB/W,EAAQM,KAAR,gBAAsByH,EAAQxH,QAE5B,CAAC0W,IAGL,kBAAC3L,EAAA,EAAD,KAECD,GAAgBA,EAAavH,QAE5B,kBAAC,EAAD,CACEA,QAASuH,EAAavH,QACtBU,QAAS6G,EAAa7G,UACnB,GAEL,kBAAC+G,EAAA,EAAD,KACD,kBAACC,EAAA,EAAD,KACE,wBAAI5K,UAAU,oBAAd,6BACKmH,EAAO,UAAMA,EAAQ/G,aAAd,YAA8B+G,EAAQ9G,MAAtC,aAAgD8G,EAAQ7G,KAAxD,KAAkE,MAG/E,kBAAC,GAAD,CACD+D,OAAQ,kBAAM0Q,EAAmB,CAACF,QAAQ,KAC1C9R,KAAM+R,EAAgBD,OACtBR,OAAO,mBACPC,KAAI,qGAAgGQ,EAAgB/L,QAAUvD,GAAOsP,EAAgB/L,QAAQ9C,UAAW,cAAcP,OAAO,cAAgB,GAAzM,gBAAmNoP,EAAgB/L,QAAUvD,GAAOsP,EAAgB/L,QAAQ7C,QAAS,cAAcR,OAAO,cAAgB,GAA1T,oEACJ8O,OAAO,2BACPC,OAAO,uBACPF,cAAe,WACbgB,EAAgC,UAAWT,EAAgB/L,QAAS,UAAWoN,IAEjF/B,cAAe,kBAAMW,EAAmB,CAACF,QAAQ,OAEhD,kBAAC,GAAD,CACDxQ,OAAQ,kBAAM4Q,EAAmB,CAACJ,QAAQ,KAC1C9R,KAAMiS,EAAgBH,OACtBR,OAAO,mBACPC,KAAI,4GAAuGU,EAAgBlL,QAAUtE,GAAOwP,EAAgBlL,QAAQrD,WAAY,cAAcf,OAAO,cAAgB,GAAjN,qEACJ8O,OAAO,gCACPC,OAAO,uBACPF,cAAe,WACbgB,EAAgC,UAAWP,EAAgBlL,QAAS,UAAWqM,IAEjF/B,cAAe,kBAAMa,EAAmB,CAACJ,QAAQ,OAGjDrK,EAEC,kBAACG,EAAA,EAAD,CAAK3K,UAAU,+BACb,kBAAC,EAAD,OAKF,kBAAC,KAAD,CACEuR,iBAAkBX,EAClB7Q,SAAU,SAACyR,GAAY,IACjB9K,EAA+B8K,EAA/B9K,gBAAiBD,EAAc+K,EAAd/K,WAClBqD,EAAU,IAAIgB,EAAQ3D,EAAQxH,GAAI+G,EAAiBD,GAIzD,GAHA2P,EAAoBtM,GAGhB3C,EAAQhC,SAASC,MAAK,SAAAC,GAAC,OAAIG,GAAOiB,EAAY,cAAcsP,OAAOvQ,GAAOqQ,MAAMxQ,EAAEY,UAAWZ,EAAEa,aAAY,CAC7G,IAAM4O,EAAkB3N,EAAQhC,SAASF,MAAK,SAAAI,GAAC,OAAIG,GAAOiB,EAAY,cAAcsP,OAAOvQ,GAAOqQ,MAAMxQ,EAAEY,UAAWZ,EAAEa,aACvH6O,EAAmB,CACpBF,QAAQ,EACR9L,QAAS+L,SAIL,GAAI3N,EAAQG,SAASlC,MAAK,SAAAwG,GAAC,OAAIpG,GAAOoG,EAAEnF,WAAY,cAAcqJ,OAAOtK,GAAOiB,EAAY,kBAAiB,CAChH,IAAMuO,EAAkB7N,EAAQG,SAASrC,MAAK,SAAA2G,GAAC,OAAIpG,GAAOoG,EAAEnF,WAAY,cAAcqJ,OAAOtK,GAAOiB,EAAY,kBAChHwO,EAAmB,CACpBJ,QAAQ,EACR/K,QAASkL,SAGRsB,GAAc,IAGf7E,cAAe,CAChBhL,WAAYjB,GAAOA,KAAU,cAAcE,OAAO,cAClDgB,gBAAiBS,EAAUA,EAAQpC,gBAAkB,KAGnD,gBACAzF,EADA,EACAA,aACAoS,EAFA,EAEAA,aACAC,EAHA,EAGAA,UACAH,EAJA,EAIAA,OACAI,EALA,EAKAA,QACAC,EANA,EAMAA,OACAC,EAPA,EAOAA,aAPA,OASF,kBAACjS,EAAA,EAAD,CAAMkS,YAAU,EAAChS,SAAUT,GACzB,kBAACO,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIiJ,IAAKsH,UAAU,cAChC,kBAACpS,EAAA,EAAKuS,MAAN,CAAY4D,OAAO,OAAOC,GAAG,KAA7B,eAA6C,0BAC3CjW,UAAU,eADiC,MAE7C,kBAAC4K,EAAA,EAAD,CAAKqL,GAAG,MACN,kBAACpW,EAAA,EAAKwS,QAAN,CACDzR,SAAU8Q,EACVY,KAAK,aACL7G,MAAO+F,EAAO/K,WACdzF,KAAK,OACLuR,YAAaV,EAAOpL,WACpB+L,QAASZ,EAAQnL,aAAeoL,EAAOpL,aAEtC,kBAAC5G,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAOpL,cAKR,kBAAC5G,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIiJ,IAAKsH,UAAU,mBAChC,kBAACpS,EAAA,EAAKuS,MAAN,CAAY4D,OAAO,OAAOC,GAAG,KAA7B,oBAAkD,0BAChDjW,UAAU,eADsC,MAElD,kBAAC4K,EAAA,EAAD,CAAKqL,GAAG,MACN,kBAACpW,EAAA,EAAKwS,QAAN,CACDzR,SAAU8Q,EACVY,KAAK,kBACL7G,MAAO+F,EAAO9K,gBACd1F,KAAK,SACLP,YAAY,sBACZ+R,QAASZ,EAAQlL,kBAAoBmL,EAAOnL,gBAC5C6L,YAAaV,EAAOnL,kBAEnB,kBAAC7G,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAOnL,mBAKR,kBAACiE,EAAA,EAAD,CAAK3K,UAAU,0BAChB,kBAACc,EAAA,EAAD,CACEC,QAAQ,UACRoD,KAAK,KACLnD,KAAK,SACLhB,UAAU,OACV2S,SAAUb,GALZ,eASA,kBAAChR,EAAA,EAAD,CACEC,QAAQ,UACRoD,KAAK,KACLnE,UAAU,OACViB,QAAS,WACV0Q,MALD,SAUA,kBAAC7Q,EAAA,EAAD,CACEC,QAAQ,SACRoD,KAAK,KACLlD,QAAS,kBAAM7B,EAAQM,KAAR,gBAAsBsG,MAHvC,iB,UC3MC+M,GAAYhI,EAAQ,IAKbwL,GAAa,WAAO,IACxB3W,EAAYkE,qBAAWvF,GAAvBqB,SACAoG,EAAakN,cAAblN,UACDmB,EAAU4L,GAAUnT,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEvF,KAAOqG,MAChD5G,EAAUC,cAEhB,OACD,kBAACT,EAAD,MAEC,gBAAE4L,EAAF,EAAEA,QAASC,EAAX,EAAWA,aAAX,OACE,kBAACC,EAAA,EAAD,KAECD,EAAavH,QAEZ,kBAAC,EAAD,CACDA,QAASuH,EAAavH,QACtBU,QAAS6G,EAAa7G,UACnB,GAEL,kBAAC+G,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,KACD,wBAAI5K,UAAU,oBAAd,6CAC6CmH,EAAO,UAC/CA,EAAQ/G,aADuC,YACvB+G,EAAQ9G,MADe,aACL8G,EAAQ7G,KADH,KAEhD,MAKHkK,EAEC,kBAACG,EAAA,EAAD,CAAK3K,UAAU,+BAChB,kBAAC,EAAD,OAIC,kBAACuH,EAAA,EAAD,KAECJ,EAECA,EACAhC,SACAwG,QAAO,SAAA5C,GAAO,OAAIA,EAAQ/C,YAAcmB,EAAQxH,MAChDgJ,MAAK,SAAC6N,EAAUC,GACf,IAAMC,EAAoB,IAAI1N,KAAKwN,EAASvQ,WACtC0Q,EAAoB,IAAI3N,KAAKyN,EAASxQ,WAE5C,OAAIyQ,EAAoBC,GACjB,EACID,EAAoBC,EACzB,EAEC,KAERpO,KAAI,SAACQ,EAASN,GAAV,OACH,kBAACjB,EAAA,EAAD,CACDoP,cAAA,kBAAwB7N,EAAQpJ,IAChC+I,IAAKD,EACL/F,MAAO,CAAC+E,SAAU,YAElB,kBAACD,EAAA,EAAK9D,OAAN,KACE,kBAAC6D,EAAA,EAAU1F,OAAX,CACD7B,UAAU,UACV0B,GAAIZ,IACJC,QAAQ,OACR2G,SAAUe,GAJT,UAKG,IAAIO,KAAKD,EAAQ9C,WAAWgD,mBAAmB,WAElD,kBAAC,IAAD,CAAMrH,GAAE,0BAAqBmH,EAAQpJ,KACtC,kBAACmB,EAAA,EAAD,CAAQC,QAAQ,mBACd,kBAAC,IAAD,CAAiB8G,KAAMgP,eAI1B,kBAACtP,EAAA,EAAUxF,SAAX,CAAoB2F,SAAUe,GAC5B,kBAACjB,EAAA,EAAK7D,KAAN,KACD,kBAACkB,EAAA,EAAD,KACE,kBAACA,EAAA,EAAUzC,KAAX,8BAES,IAAI4G,KAAKD,EAAQ9C,WAAWgD,mBAAmB,WAExD,kBAACpE,EAAA,EAAUzC,KAAX,4BAES,IAAI4G,KAAKD,EAAQ7C,SAAS+C,mBAAmB,WAEtD,kBAACpE,EAAA,EAAUzC,KAAX,wBACgB2G,EAAQ5C,cADxB,OAGA,kBAACtB,EAAA,EAAUzC,KAAX,sBAE8B,MAAxB2G,EAAQ3C,YAAsB,UAAY,iBAQnD,IAKL,kBAACtF,EAAA,EAAD,CACEd,UAAU,OACV0C,MAAO,CACRS,SAAU,WACVE,KAAM,MACNC,UAAW,oBAEVvC,QAAQ,SACRoD,KAAK,KACLlD,QAAS,kBAAM7B,EAAQM,KAAR,gBAAsByH,EAAQxH,OAT/C,eC9GUmX,GAAb,WAyBE,WAAY5M,EAAWtE,EAA6BC,EAA2BJ,EAAkBE,EAAgBG,EAAaC,GAA+G,IAApGpG,EAAmG,uDAA9FoL,EAAQ,GAARA,GAAsBC,EAAwE,uDAA5DxF,MAASE,OAAO,yBAA0BuF,EAAkB,uDAAN,KAAM,oBAC7OC,KAAKC,IAAMxL,EACXuL,KAAK6L,WAAa7M,EAClBgB,KAAK8L,6BAA+BpR,EACpCsF,KAAK+L,2BAA6BpR,EAClCqF,KAAKgM,kBAAoBzR,EACzByF,KAAKiM,gBAAkBxR,EACvBuF,KAAKkM,aAAetR,EACpBoF,KAAKmM,WAAatR,EAClBmF,KAAKK,WAAaP,EAClBE,KAAKM,WAAaP,EAnCnB,+CAuCC,OAAOC,KAAKC,KAvCb,aA0CSM,GACRP,KAAKC,IAAMM,IA3CZ,gCA+CC,OAAOP,KAAK6L,YA/Cb,aAkDgBtL,GACfP,KAAK6L,WAAatL,IAnDnB,kDAuDC,OAAOP,KAAK8L,8BAvDb,aA0DkCvL,GACjCP,KAAK8L,6BAA+BvL,IA3DrC,gDA+DC,OAAOP,KAAK+L,4BA/Db,aAkEgCxL,GAC/BP,KAAK+L,2BAA6BxL,IAnEnC,uCAuEC,OAAOP,KAAKgM,mBAvEb,aA0EuBzL,GACtBP,KAAKgM,kBAAoBzL,IA3E1B,qCA+EC,OAAOP,KAAKiM,iBA/Eb,aAkFqB1L,GACpBP,KAAKiM,gBAAkB1L,IAnFxB,kCAuFC,OAAOP,KAAKkM,cAvFb,aA0FkB3L,GACjBP,KAAKkM,aAAe3L,IA3FrB,gCA+FC,OAAOP,KAAKmM,YA/Fb,aAkGgB5L,GACfP,KAAKmM,WAAa5L,IAnGnB,gCAuGC,OAAOP,KAAKK,YAvGb,aA0GgBE,GACfP,KAAKK,WAAaE,IA3GnB,gCA+GC,OAAOP,KAAKM,YA/Gb,aAkHgBC,GACfP,KAAKM,WAAaC,MAnHnB,KCMMjG,GAASkP,wBAAaC,KACtB5B,GAAYhI,EAAQ,IAObuM,GAAiB,WAAO,IAAD,EACqBxT,qBAAWvF,GAA3DiM,EAD2B,EAC3BA,QAASC,EADkB,EAClBA,aAAc7K,EADI,EACJA,SAAUiT,EADN,EACMA,YADN,EAEc9T,mBAAS,MAFvB,mBAE3BwY,EAF2B,KAETC,EAFS,OAGEzY,oBAAS,GAHX,mBAG3B0P,EAH2B,KAGfgJ,EAHe,KAI3BvN,EAAagJ,cAAbhJ,UACD9K,EAAUC,cACViW,EAAsB1V,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEC,SAASC,MAAK,SAAAC,GAAC,OAAIA,EAAE1F,KAAOuK,QACvE/C,EAAU4L,GAAUuC,GACpBvM,EAAU5B,EAAUA,EAAQhC,SAASF,MAAK,SAAAI,GAAC,OAAIA,EAAE1F,KAAOuK,KAAa,KACrEwN,EAAoB3E,GAAUhK,GAG9B6H,EAASC,YAAaC,MAAM,CACnClL,4BAA6BiL,YAE1BG,IAAI0G,EAAoBA,EAAkBvR,cAAgB,EAAG,4BAC7D4K,SAAS,0BACZlL,0BAA2BgL,YAExBG,IAAI0G,EAAoBA,EAAkBvR,cAAgB,EAAG,4BAC7D6K,IACFH,OAAQ,+BACR,uDAEEE,SAAS,0BACZtL,iBAAkBoL,UAEfG,IAAI0G,EAAoBlS,GAAOkS,EAAkBzR,UAAW,cAAgBT,GAAOA,KAAU,cAAcE,OAAO,cAAe,6CACjIqL,SAAS,0BACZpL,eAAgBkL,UAEbG,IAAI0G,EAAoBlS,GAAOkS,EAAkBzR,UAAW,cAAgBT,GAAOA,KAAU,cAAcE,OAAO,cAAe,6CACjIsL,IAAIH,OAAQ,oBAAqB,6CACjCZ,IAAIyH,EAAoBlS,GAAOkS,EAAkBxR,QAAS,cAAgBV,GAAOA,KAAU,cAAcE,OAAO,cAAe,yCAC/HqL,SAAS,0BACZjL,YAAa+K,YAEb9K,UAAW8K,cAaV,OAPA+E,qBAAU,WACPnH,GAAc8I,IAChB1E,EAAY,UAAW0E,GACvBnY,EAAQM,KAAR,gBAAsByH,EAAQxH,QAE5B,CAAC8O,IAGL,kBAAC/D,EAAA,EAAD,KAECD,GAAgBA,EAAavH,QAE5B,kBAAC,EAAD,CACEA,QAASuH,EAAavH,QACtBU,QAAS6G,EAAa7G,UACnB,GAEL,kBAAC+G,EAAA,EAAD,KACD,kBAACC,EAAA,EAAD,KACE,wBAAI5K,UAAU,oBAAd,uBACImH,EAAO,UAAMA,EAAQ/G,aAAd,YAA8B+G,EAAQ9G,MAAtC,aAAgD8G,EAAQ7G,KAAxD,KAAkE,GAD7E,iBAGKoX,EAAiB,UAAMlS,GAAOkS,EAAkBzR,UAAW,cAAcP,OAAO,eAAkB,GAHvG,MAG8GgS,EAAiB,UAAMlS,GAAOkS,EAAkBxR,QAAS,cAAcR,OAAO,eAAkB,MAIhN8E,EAEC,kBAACG,EAAA,EAAD,CAAK3K,UAAU,+BACb,kBAAC,EAAD,OAKF,kBAAC,KAAD,CACEuR,iBAAkBX,EAClB7Q,SAAU,SAACyR,GAAY,IACjB5L,EAAoH4L,EAApH5L,4BAA6BC,EAAuF2L,EAAvF3L,0BAA2BJ,EAA4D+L,EAA5D/L,iBAAkBE,EAA0C6L,EAA1C7L,eAAgBG,EAA0B0L,EAA1B1L,YAAaC,EAAayL,EAAbzL,UACxG0D,EAAU,IAAIqN,GAAQ5M,EAAWtE,EAA6BC,EAA2BJ,EAAkBE,EAAgBG,EAAaC,GAC9IyR,EAAoB/N,GACpBgO,GAAc,IAEbhG,cAAe,CAChB7L,4BAA6B8R,EAAoBA,EAAkBvR,cAAgB,EACnFN,0BAA2B6R,EAAoBA,EAAkBvR,cAAgB,EACjFV,iBAAkBiS,EAAoBA,EAAkBzR,UAAYT,GAAOA,KAAU,cAAcE,OAAO,cAC1GC,eAAgB+R,EAAoBA,EAAkBzR,UAAYT,GAAOA,KAAU,cAAcE,OAAO,cACxGI,YAAa,GACbC,UAAW,MAGT,gBACAzG,EADA,EACAA,aACAoS,EAFA,EAEAA,aACAC,EAHA,EAGAA,UACAH,EAJA,EAIAA,OACAI,EALA,EAKAA,QACAC,EANA,EAMAA,OACAC,EAPA,EAOAA,aAPA,OASF,kBAACjS,EAAA,EAAD,CACEE,SAAUT,GAEV,kBAACO,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIiJ,IAAKsH,UAAU,oBAChC,kBAACpS,EAAA,EAAKuS,MAAN,CAAY4D,OAAO,OAAOC,GAAG,KAA7B,sBAAoD,0BAClDjW,UAAU,eADwC,MAEpD,kBAAC4K,EAAA,EAAD,CAAKqL,GAAG,MACN,kBAACpW,EAAA,EAAKwS,QAAN,CACDzR,SAAU8Q,EACVY,KAAK,mBACL7G,MAAO+F,EAAO/L,iBACdzE,KAAK,OACLwR,QAASZ,EAAQnM,mBAAqBoM,EAAOpM,iBAC7C8M,YAAaV,EAAOpM,mBAEnB,kBAAC5F,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAOpM,oBAIR,kBAAC5F,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIiJ,IAAKsH,UAAU,kBAChC,kBAACpS,EAAA,EAAKuS,MAAN,CAAY4D,OAAO,OAAOC,GAAG,KAA7B,oBAAkD,0BAChDjW,UAAU,eADsC,MAElD,kBAAC4K,EAAA,EAAD,CAAKqL,GAAG,MACN,kBAACpW,EAAA,EAAKwS,QAAN,CACDzR,SAAU8Q,EACVY,KAAK,iBACL7G,MAAO+F,EAAO7L,eACd3E,KAAK,OACLwR,QAASZ,EAAQjM,iBAAmBkM,EAAOlM,eAC3C4M,YAAaV,EAAOlM,iBAEnB,kBAAC9F,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAOlM,kBAIR,kBAAC9F,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIiJ,IAAKsH,UAAU,+BAChC,kBAACpS,EAAA,EAAKuS,MAAN,CAAY4D,OAAO,OAAOC,GAAG,KAA7B,kCAAgE,0BAC9DjW,UAAU,eADoD,MAEhE,kBAAC4K,EAAA,EAAD,CAAKqL,GAAG,MACN,kBAACpW,EAAA,EAAKwS,QAAN,CACDzR,SAAU8Q,EACVY,KAAK,8BACL7G,MAAO+F,EAAO5L,4BACd5E,KAAK,SACLP,YAAY,oCACZ+R,QAASZ,EAAQhM,8BAAgCiM,EAAOjM,4BACxD2M,YAAaV,EAAOjM,8BAEnB,kBAAC/F,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAOjM,+BAIR,kBAAC/F,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIiJ,IAAKsH,UAAU,6BAChC,kBAACpS,EAAA,EAAKuS,MAAN,CAAY4D,OAAO,OAAOC,GAAG,KAA7B,gCAA8D,0BAC5DjW,UAAU,eADkD,MAE9D,kBAAC4K,EAAA,EAAD,CAAKqL,GAAG,MACN,kBAACpW,EAAA,EAAKwS,QAAN,CACDzR,SAAU8Q,EACVY,KAAK,4BACL7G,MAAO+F,EAAO3L,0BACdpF,YAAY,kCACZO,KAAK,SACLwR,QAASZ,EAAQ/L,4BAA8BgM,EAAOhM,0BACtD0M,YAAaV,EAAOhM,4BAEnB,kBAAChG,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAOhM,6BAIR,kBAAChG,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIiJ,IAAKsH,UAAU,eAChC,kBAACpS,EAAA,EAAKuS,MAAN,CAAY4D,OAAO,OAAOC,GAAG,KAA7B,iBACA,kBAACrL,EAAA,EAAD,CAAKqL,GAAG,MACN,kBAACpW,EAAA,EAAKwS,QAAN,CACDzR,SAAU8Q,EACVY,KAAK,cACL7G,MAAO+F,EAAO1L,YACdrF,YAAY,kBACZO,KAAK,OACLwR,QAASZ,EAAQ9L,cAAgB+L,EAAO/L,YACxCyM,YAAaV,EAAO/L,cAEnB,kBAACjG,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAO/L,eAIR,kBAACjG,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIiJ,IAAKsH,UAAU,aAChC,kBAACpS,EAAA,EAAKuS,MAAN,CAAY4D,OAAO,OAAOC,GAAG,KAA7B,eACA,kBAACrL,EAAA,EAAD,CAAKqL,GAAG,MACN,kBAACpW,EAAA,EAAKwS,QAAN,CACDzR,SAAU8Q,EACVY,KAAK,YACL7G,MAAO+F,EAAOzL,UACdtF,YAAY,gBACZO,KAAK,OACLwR,QAASZ,EAAQ7L,YAAc8L,EAAO9L,UACtCwM,YAAaV,EAAO9L,YAEnB,kBAAClG,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAO9L,aAIR,kBAAC4E,EAAA,EAAD,CAAK3K,UAAU,+BAChB,kBAACc,EAAA,EAAD,CACEC,QAAQ,UACRoD,KAAK,KACLnD,KAAK,SACLhB,UAAU,OACV2S,SAAUb,GALZ,eASA,kBAAChR,EAAA,EAAD,CACEC,QAAQ,UACRoD,KAAK,KACLnE,UAAU,OACViB,QAAS0Q,GAJX,SAQA,kBAAC7Q,EAAA,EAAD,CACEC,QAAQ,SACRoD,KAAK,KACLlD,QAAS,kBAAM7B,EAAQM,KAAR,gBAAsByH,EAAQxH,OAH/C,iBC/OCoT,GAAYhI,EAAQ,IAKb4M,GAAkB,WAAO,IAC7B/X,EAAYkE,qBAAWvF,GAAvBqB,SACAoG,EAAakN,cAAblN,UACDmB,EAAU4L,GAAUnT,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEvF,KAAOqG,MAChD5G,EAAUC,cAEhB,OACD,kBAACT,EAAD,MAEC,gBAAE4L,EAAF,EAAEA,QAASC,EAAX,EAAWA,aAAX,OACE,kBAACC,EAAA,EAAD,KAECD,EAAavH,QAEZ,kBAAC,EAAD,CACDA,QAASuH,EAAavH,QACtBU,QAAS6G,EAAa7G,UACnB,GAEL,kBAAC+G,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,KACD,wBAAI5K,UAAU,oBAAd,wDACwDmH,EAAO,UAC1DA,EAAQ/G,aADkD,YAClC+G,EAAQ9G,MAD0B,aAChB8G,EAAQ7G,KADQ,KAE3D,MAKHkK,EAEC,kBAACG,EAAA,EAAD,CAAK3K,UAAU,+BAChB,kBAAC,EAAD,OAIC,kBAACuH,EAAA,EAAD,KAECJ,EAECA,EACAhC,SACAwG,QAAO,SAAA5C,GAAO,OAAIA,EAAQ/C,YAAcmB,EAAQxH,MAChDgJ,MAAK,SAAC6N,EAAUC,GACf,IAAMC,EAAoB,IAAI1N,KAAKwN,EAASvQ,WACtC0Q,EAAoB,IAAI3N,KAAKyN,EAASxQ,WAE5C,OAAIyQ,EAAoBC,GACjB,EACID,EAAoBC,EACzB,EAEC,KAERpO,KAAI,SAACQ,EAASN,GAAV,OACH,kBAACjB,EAAA,EAAD,CACDoP,cAAA,kBAAwB7N,EAAQpJ,IAChC+I,IAAKD,EACL/F,MAAO,CAAC+E,SAAU,YAClB,kBAACD,EAAA,EAAK9D,OAAN,KACE,kBAAC6D,EAAA,EAAU1F,OAAX,CACD7B,UAAU,UACV0B,GAAIZ,IACJC,QAAQ,OACR2G,SAAUe,GAJT,UAKG,IAAIO,KAAKD,EAAQ9C,WAAWgD,mBAAmB,WAElD,kBAAC,IAAD,CAAMrH,GAAE,+BAA0BmH,EAAQpJ,KAC3C,kBAACmB,EAAA,EAAD,CAAQC,QAAQ,mBACd,kBAAC,IAAD,CAAiB8G,KAAMgP,eAI1B,kBAACtP,EAAA,EAAUxF,SAAX,CAAoB2F,SAAUe,GAC5B,kBAACjB,EAAA,EAAK7D,KAAN,KACD,kBAACkB,EAAA,EAAD,KACE,kBAACA,EAAA,EAAUzC,KAAX,8BAES,IAAI4G,KAAKD,EAAQ9C,WAAWgD,mBAAmB,WAExD,kBAACpE,EAAA,EAAUzC,KAAX,4BAES,IAAI4G,KAAKD,EAAQ7C,SAAS+C,mBAAmB,WAEtD,kBAACpE,EAAA,EAAUzC,KAAX,wBACgB2G,EAAQ5C,cADxB,OAGA,kBAACtB,EAAA,EAAUzC,KAAX,sBAE8B,MAAxB2G,EAAQ3C,YAAsB,UAAY,iBAOjD,IAMP,kBAACtF,EAAA,EAAD,CACEd,UAAU,OACV0C,MAAO,CACRS,SAAU,WACVE,KAAM,MACNC,UAAW,oBAEVvC,QAAQ,SACRoD,KAAK,KACLlD,QAAS,kBAAM7B,EAAQM,KAAR,gBAAsByH,EAAQxH,OAT/C,eC9GUiY,GAAb,WAiBE,WAAY1N,EAAWrD,EAAcC,GAA+G,IAApGnH,EAAmG,uDAA9FoL,EAAQ,GAARA,GAAsBC,EAAwE,uDAA5DxF,MAASE,OAAO,yBAA0BuF,EAAkB,uDAAN,KAAM,oBACjJC,KAAKC,IAAMxL,EACXuL,KAAK6L,WAAa7M,EAClBgB,KAAK2M,WAAa/Q,EAClBoE,KAAK4M,cAAgBjR,EACrBqE,KAAKK,WAAaP,EAClBE,KAAKM,WAAaP,EAvBtB,+CA2BI,OAAOC,KAAKC,KA3BhB,aA8BSM,GACLP,KAAKC,IAAMM,IA/Bf,gCAmCI,OAAOP,KAAK6L,YAnChB,aAsCgBtL,GACZP,KAAK6L,WAAatL,IAvCtB,mCA2CI,OAAOP,KAAK4M,eA3ChB,aA8CmBrM,GACfP,KAAK4M,cAAgBrM,IA/CzB,gCAmDI,OAAOP,KAAK2M,YAnDhB,aAsDgBpM,GACZP,KAAK2M,WAAapM,IAvDtB,gCA2DI,OAAOP,KAAKK,YA3DhB,aA8DgBE,GACZP,KAAKK,WAAaE,IA/DtB,gCAmEI,OAAOP,KAAKM,YAnEhB,aAsEgBC,GACZP,KAAKM,WAAaC,MAvEtB,KCKMjG,GAASuF,EAAQ,IAAgB2J,aAAaC,KAC9C5B,GAAYhI,EAAQ,IAObgN,GAAsB,WAAO,IAAD,EACgBjU,qBAAWvF,GAA3DiM,EADgC,EAChCA,QAASC,EADuB,EACvBA,aAAc7K,EADS,EACTA,SAAUiT,EADD,EACCA,YADD,EAEmB9T,mBAAS,MAF5B,mBAEhCiZ,EAFgC,KAETC,EAFS,OAGOlZ,oBAAS,GAHhB,mBAGhCgQ,EAHgC,KAGfmJ,EAHe,KAIhChO,EAAagJ,cAAbhJ,UACD9K,EAAUC,cACViW,EAAsB1V,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEC,SAASC,MAAK,SAAAC,GAAC,OAAIA,EAAE1F,KAAOuK,QACvE/C,EAAU4L,GAAUuC,GACpBvM,EAAU5B,EAAUA,EAAQhC,SAASF,MAAK,SAAAI,GAAC,OAAIA,EAAE1F,KAAOuK,KAAa,KACrEwN,EAAoB3E,GAAUhK,GAG9B6H,EAASC,YAAaC,MAAM,CACnCjK,aAAcgK,YAEXsH,SAAS,EAAG,yBACZlI,IACF9I,EACEA,EAAQnC,aAAe,EACzB,4DAEE+L,SAAS,0BACZjK,UAAW+J,YAERsH,SAAS,EAAG,iBACZpH,SAAS,6BAYX,OAPA6E,qBAAU,WACP7G,GAAmBiJ,IACrBnF,EAAY,gBAAiBmF,GAC7B5Y,EAAQM,KAAR,gBAAsByH,EAAQxH,QAE5B,CAACoP,IAGL,kBAACrE,EAAA,EAAD,KAECD,GAAgBA,EAAavH,QAE5B,kBAAC,EAAD,CACEA,QAASuH,EAAavH,QACtBU,QAAS6G,EAAa7G,UACnB,GAEL,kBAAC+G,EAAA,EAAD,KACD,kBAACC,EAAA,EAAD,KACE,wBAAI5K,UAAU,oBAAd,kCACImH,EAAO,UAAMA,EAAQ/G,aAAd,YAA8B+G,EAAQ9G,MAAtC,aAAgD8G,EAAQ7G,KAAxD,KAAkE,GAD7E,iBAGKoX,EAAiB,UAAMlS,GAAOkS,EAAkBzR,UAAW,cAAcP,OAAO,eAAkB,GAHvG,MAG8GgS,EAAiB,UAAMlS,GAAOkS,EAAkBxR,QAAS,cAAcR,OAAO,eAAkB,MAIhN8E,EAEC,kBAACG,EAAA,EAAD,CAAK3K,UAAU,+BACb,kBAAC,EAAD,OAKF,kBAAC,KAAD,CACEuR,iBAAkBX,EAClB7Q,SAAU,SAACyR,GAAY,IACjB3K,EAA2B2K,EAA3B3K,aAAcC,EAAa0K,EAAb1K,UACfwD,EAAe,IAAIsN,GAAa1N,EAAWrD,EAAcC,GAC/DmR,EAAyB3N,GACzB4N,GAAmB,IAElBzG,cAAe,CAChB5K,aAAcM,EAAUA,EAAQnC,aAAe,GAC/C8B,UAAW,MAGT,gBACAxH,EADA,EACAA,aACAoS,EAFA,EAEAA,aACAC,EAHA,EAGAA,UACAH,EAJA,EAIAA,OACAI,EALA,EAKAA,QACAC,EANA,EAMAA,OACAC,EAPA,EAOAA,aAPA,OASF,kBAACjS,EAAA,EAAD,CACEE,SAAUT,GAEV,kBAACO,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIiJ,IAAKsH,UAAU,gBAChC,kBAACpS,EAAA,EAAKuS,MAAN,CAAY4D,OAAO,OAAOC,GAAG,KAA7B,iBAA+C,0BAC7CjW,UAAU,eADmC,MAE/C,kBAAC4K,EAAA,EAAD,CAAKqL,GAAG,MACN,kBAACpW,EAAA,EAAKwS,QAAN,CACDzR,SAAU8Q,EACVY,KAAK,eACL7G,MAAO+F,EAAO3K,aACd7F,KAAK,SACLP,YAAY,uBACZ+R,QAASZ,EAAQ/K,eAAiBgL,EAAOhL,aACzC0L,YAAaV,EAAOhL,eAEnB,kBAAChH,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAOhL,gBAIR,kBAAChH,EAAA,EAAKmS,MAAN,CAAYtQ,GAAIiJ,IAAKsH,UAAU,aAChC,kBAACpS,EAAA,EAAKuS,MAAN,CAAY4D,OAAO,OAAOC,GAAG,KAA7B,wBAAsD,0BACpDjW,UAAU,eAD0C,MAEtD,kBAAC4K,EAAA,EAAD,CAAKqL,GAAG,MACN,kBAACpW,EAAA,EAAKwS,QAAN,CACDzR,SAAU8Q,EACVY,KAAK,YACL7G,MAAO+F,EAAO1K,UACd9F,KAAK,SACLP,YAAY,wBACZ+R,QAASZ,EAAQ9K,YAAc+K,EAAO/K,UACtCyL,YAAaV,EAAO/K,YAEnB,kBAACjH,EAAA,EAAKwS,QAAQI,SAAd,CAAuBzR,KAAK,WAC5B6Q,EAAO/K,aAIR,kBAAC6D,EAAA,EAAD,CAAK3K,UAAU,+BAChB,kBAACc,EAAA,EAAD,CACEC,QAAQ,UACRoD,KAAK,KACLnD,KAAK,SACLhB,UAAU,OACV2S,SAAUb,GALZ,qBASA,kBAAChR,EAAA,EAAD,CACEC,QAAQ,UACRoD,KAAK,KACLnE,UAAU,OACViB,QAAS0Q,GAJX,SAQA,kBAAC7Q,EAAA,EAAD,CACEC,QAAQ,SACRoD,KAAK,KACLlD,QAAS,kBAAM7B,EAAQM,KAAR,gBAAsByH,EAAQxH,OAH/C,iBCpJQyY,GAAc,SAAAtV,GACzB,IAUIqE,EAASC,EAAiBiR,EAAiBhR,EAAiBiR,EAV1DlZ,EAAUC,cADkB,EAU9ByE,qBAAWvF,GAPhBqB,EAHmC,EAGnCA,SACAuF,EAJmC,EAInCA,SACAG,EALmC,EAKnCA,SACAgC,EANmC,EAMnCA,SACAX,EAPmC,EAOnCA,cACA6D,EARmC,EAQnCA,QACAC,EATmC,EASnCA,aAWC,OARAtD,EAAUvH,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEvF,KAAOmD,EAAMyV,MAAMC,OAAOxS,gBAE1DoB,EAAkBjC,EAASwG,QAAO,SAAAtG,GAAC,OAAIA,EAAEW,YAAcmB,EAAQxH,MAC/D0Y,EAAkB/S,EAASqG,QAAO,SAAApG,GAAC,OAAI6B,EAAgBhC,MAAK,SAAAC,GAAC,OAAIA,EAAE1F,KAAO4F,EAAE2E,gBAC5E7C,EAAkBC,EAASqE,QAAO,SAAAC,GAAC,OAAIA,EAAE5F,YAAcmB,EAAQxH,MAC/D2Y,EAAuB3R,EAAcgF,QAAO,SAAA/E,GAAC,OAAIQ,EAAgBhC,MAAK,SAAAC,GAAC,OAAIA,EAAE1F,KAAOiH,EAAEsD,iBAItF,kBAACQ,EAAA,EAAD,KAECD,EAAavH,QAEZ,kBAAC,EAAD,CACEA,QAASuH,EAAavH,QACtBU,QAAS6G,EAAa7G,UACnB,GAGNuD,EAEC,oCACE,kBAACwD,EAAA,EAAD,KACD,kBAACC,EAAA,EAAD,KACE,wBAAI5K,UAAU,oBAAd,UACGmH,EAAQ/G,aADX,YAC2B+G,EAAQ9G,MADnC,aAC6C8G,EAAQ7G,KADrD,QAMFkK,EAEC,kBAACG,EAAA,EAAD,CAAK3K,UAAU,+BACb,kBAAC,EAAD,OAID,kBAAC,EAAD,CACDmH,QAASA,EACThC,SAAUiC,EACV9B,SAAU+S,EACV/Q,SAAUD,EACVV,cAAe2R,KAOjB,oCACE,kBAAC3N,EAAA,EAAD,CAAK3K,UAAU,0BAChB,kBAAC4K,EAAA,EAAD,KACE,wBAAI5K,UAAU,oBAAd,oCAMH,kBAAC2K,EAAA,EAAD,CAAK3K,UAAU,QAChB,kBAAC4K,EAAA,EAAD,CAAK5K,UAAU,eACb,kBAACc,EAAA,EAAD,CACDG,QAAS,kBAAM7B,EAAQM,KAAR,YACfqB,QAAQ,UACRoD,KAAK,MAHJ,uBC1EST,GAAS,SAAAZ,GAAK,OACzB,wBAAI9C,UAAU,8BAA8B8C,EAAM2V,a,SCSvCC,GAAe,SAAA5V,GAe1B,OACD,kBAAC,KAAD,CAAqBH,MAAM,OAAOC,OAAQ,KACxC,kBAAC,KAAD,CAAU+V,KAAM7V,EAAM6V,MACvB,kBAAC,KAAD,CAAeC,OAAO,OAAOC,gBAAgB,QAC7C,kBAAC,KAAD,CAAOC,QAAQ,iBACf,kBAAC,KAAD,MACA,kBAAC,KAAD,CAASC,QAAS,mBApBI,SAAC,GAA8B,IAA7BC,EAA4B,EAA5BA,QAASC,EAAmB,EAAnBA,MAClC,OADqD,EAAZC,QAC3BF,EAEb,yBAAKhZ,UAAU,yDACb,uBAAGA,UAAU,oBAAoBiZ,GACjC,uCAAY,0BACbjZ,UAAU,gBADG,YACkBqG,OAAOC,WAAW0S,EAAQ,GAAGvN,OAAOjF,QAAQ,OAKtE,OASY,QAClB,kBAAC,KAAD,MACA,kBAAC,KAAD,CAAKsS,QAAQ,UAAUK,QAAS,GAAIC,KAAK,eChC9BC,GAAY,SAAAvW,GAAU,IAAD,EACLgB,qBAAWvF,GAA/BiM,EADyB,EACzBA,QAAS8O,EADgB,EAChBA,QAEhB,OACD,kBAAC5O,EAAA,EAAD,CAAW1K,UAAU,eACnB,kBAAC,GAAD,CAAQyY,WAAW,qCAEpBjO,EAEC,kBAACG,EAAA,EAAD,CAAK3K,UAAU,+BACb,kBAAC,EAAD,OAIF,oCACE,wBAAIA,UAAU,oBAAd,oCACA,kBAAC2K,EAAA,EAAD,KACD,kBAAC,GAAD,CAAcgO,KAAMW,MAKrB,kBAACxY,EAAA,EAAD,CACDqD,KAAK,KACLpD,QAAQ,UACRf,UAAU,OACViB,QAAS,kBAAM6B,EAAM1D,QAAQM,KAAK,aAJjC,qBCxBU6Z,GAAwB,SAAC3Z,GAA4B,IAAlB4Z,EAAiB,uDAAT,KAClDb,EAAO,GA+CX,OA9CA/Y,EAAWA,GAAY4Z,EAAM5Z,WACbA,EAASH,SAC1BG,EAASwJ,SAAQ,SAAAlE,GAAM,IAAD,EACduU,EACPvU,EACGC,SACAgE,QAAO,SAACuQ,EAAgBrU,GAAO,IAC1BkB,EAAelB,EAAfkB,YAEDoT,EAAgB,CACpBC,oBAF0BpU,IAAOH,EAAEY,UAAW,cAAcP,OAAO,aAGnEa,eAGF,OADAmT,EAAeha,KAAKia,GACbD,IACH,IACF/Q,MAAK,SAACkR,EAAgBC,GACxB,OAAOtU,IAAOqU,EAAeD,oBAAqB,aAAaG,eAAevU,IAAOsU,EAAeF,oBAAqB,iBAEvHzQ,QAAO,SAAC6Q,EAAwBL,GASlC,OARIK,EAAuB5U,MAAK,SAAAC,GAAC,OAAIG,IAAOH,EAAE4U,aAAc,aAAanK,OAAOtK,IAAOmU,EAAcC,oBAAqB,iBACxHI,EAAuBA,EAAuBE,WAAU,SAAAC,GAAK,OAAI3U,IAAO2U,EAAMF,aAAc,aAAanK,OAAOtK,IAAOmU,EAAcC,oBAAqB,kBAAgBN,SAAWK,EAAcpT,YAEnMyT,EAAuBta,KAAK,CAC7Bua,aAAcN,EAAcC,oBAC5BN,QAASK,EAAcpT,cAGjByT,IACH,KACJ,EAAArB,GAAKjZ,KAAL,oBAAa+Z,OAEfd,EACEA,EACAxP,QAAO,SAACiR,EAAeD,GAStB,OARIC,EAAchV,MAAK,SAAAiV,GAAC,OAAI7U,IAAO6U,EAAEJ,aAAc,aAAanK,OAAOtK,IAAO2U,EAAMF,aAAc,iBACnGG,EAAcA,EAAcF,WAAU,SAAAG,GAAC,OAAI7U,IAAO6U,EAAEJ,aAAc,aAAanK,OAAOtK,IAAO2U,EAAMF,aAAc,kBAAgBX,SAAWa,EAAMb,QAElJc,EAAc1a,KAAK,CACjBua,aAAcE,EAAMF,aACpBX,QAASa,EAAMb,UAGTc,IACN,KAEIzB,EACPhQ,MAAK,SAAC2R,EAAUC,GACf,OAAO/U,IAAO8U,EAASL,aAAc,aAAa9N,KAAK3G,IAAO+U,EAASN,aAAc,iBAGtFtO,QAAO,SAAA2N,GAAO,OAAI9T,IAAO8T,EAAQW,aAAc,aAAaF,eAAevU,IAAOA,MAAU,iBAC5FmG,QAAO,SAAA2N,GAAO,OAAI9T,IAAO8T,EAAQW,aAAc,aAAa5N,cAAc7G,IAAOA,MAAU,aAAayL,SAAS,EAAG,e,6jBCvC/G,IAAMuJ,GAAb,YACE,WAAY1X,GAAQ,IAAD,8BACpB,4CAAMA,KAykBL2X,gBAAkB,SAACrK,GACpB,IAAMsK,EAAsBtK,EAAWzL,OAAOC,cAE9C,OADW0I,KAAS6C,YAEjBC,WAAWA,GACXc,MACAX,MAAK,SAAAoK,GACP,IAAIhC,EAAOgC,EAAcC,KAAKrS,KAAI,SAAA8H,GAAG,OAAIA,EAAIsI,UAE7C,EAAKkC,UAAS,SAAAC,GA8BZ,OA7BAnC,EAAOA,EAAKpQ,KAAI,SAAAvE,GACjB,OAAQ0W,GACN,IAAK,WACN1W,EAAW,IAAIwJ,GAAQxJ,EAAS2J,cAAe3J,EAAS4J,OAAQ5J,EAAS6J,MAAO7J,EAAS8J,iBAAkB9J,EAAS+J,oBAAqB/J,EAASgK,cAAehK,EAASmH,IAAKnH,EAASuH,WAAYvH,EAASwH,YAC7M,MAEC,IAAK,WACNxH,EAAW,IAAIqP,GAAQrP,EAASoH,WAAYpH,EAASuP,aAAcvP,EAASwP,WAAYxP,EAASyP,SAAUzP,EAAS0P,eAAgB1P,EAAS2P,aAAc3P,EAASmH,IAAKnH,EAASuH,WAAYvH,EAASwH,YACvM,MAEC,IAAK,WACNxH,EAAW,IAAI8S,GAAQ9S,EAAS+S,WAAY/S,EAASgT,6BAA8BhT,EAASiT,2BAA4BjT,EAASkT,kBAAmBlT,EAASmT,gBAAiBnT,EAASoT,aAAcpT,EAASqT,WAAYrT,EAASmH,IAAKnH,EAASuH,WAAYvH,EAASwH,YACtQ,MAEC,IAAK,WACNxH,EAAW,IAAI8G,EAAQ9G,EAASoH,WAAYpH,EAASqH,iBAAkBrH,EAASsH,YAAatH,EAASmH,IAAKnH,EAASuH,WAAYvH,EAASwH,YACzI,MAEC,IAAK,gBACL,IAAK,iBACNxH,EAAW,IAAI4T,GAAa5T,EAAS+S,WAAY/S,EAAS8T,cAAe9T,EAAS6T,WAAY7T,EAASmH,IAAKnH,EAASuH,WAAYvH,EAASwH,YAM3I,OAAOxH,KAGC,aACRwG,SAAS,GACR4F,EAFA,YAEiBuI,OAEhB,kBAIDnI,OAAM,SAAAjR,GACR,EAAKsb,SAAS,CACZrQ,SAAS,IACR,WACDiG,QAAQC,IAAInR,UAvnBf,EAAKwb,oBAAsB,WACzBC,YAAW,WACZ,EAAKH,SAAS,CACZpQ,aAAc,CACfvH,SAAS,EACTU,QAAS,QAGN,OAUL,EAAKqP,YAAc,SAAC9L,GAAkC,IAAzByI,IAAwB,yDAC/CqL,EAAgB,GACpB,EAAKJ,SAAS,CACfrQ,SAAS,IACL,WACJ,EAAKqQ,UAAS,SAAAC,GAAc,IACnBlb,EADkB,MACFkb,GAAhBlb,SACDsb,EAAkBtb,EAASsa,WAAU,SAAAhV,GAAC,OAAIA,EAAEvF,KAAOwH,EAAQxH,MAC3Dwb,EAAavb,EAASsb,GAW5B,OAVAD,EAAgB7S,OAChBC,KAAK8S,GACLhS,QAAO,SAACiS,EAAQ5S,GAIf,OAHK2S,EAAW3S,KAAWrB,EAAQqB,IAAY6S,MAAMC,QAAQnU,EAAQqB,MACtE4S,EAAO5S,GAASrB,EAAQqB,IAEhB4S,IACN,IACFxb,EAASsb,GAAmB/T,EAErB,GAAP,GACE2T,EADF,CAEDlb,gBAEE,WACD,GAAIgQ,EAGL,OAFWtC,KAAS6C,YAGjBC,WAAW,YACXC,IAAIlJ,EAAQxH,IACZ2Q,OAAO2K,GACP1K,MAAK,WACP,EAAKsK,SAAS,CACZrQ,SAAS,EACTC,aAAc,CACfvH,SAAS,EACTU,QAAQ,8CAEN,EAAKmX,wBAENvK,OAAM,SAAAuD,GACR,EAAK8G,SAAS,CACZrQ,SAAS,EACTC,aAAc,CACfvH,SAAS,EACTU,QAAQ,2BAAD,OAA6BmQ,MAElC,WACD,EAAKgH,sBACLtK,QAAQC,IAAIqD,gBAgBjB,EAAKlB,YAAc,SAAC5O,EAAcD,GAAmC,IAS/DuX,EAAgBnL,EA2BhBoL,EAAiBC,EApCqB7L,IAAwB,yDAClE,IAAK3L,IAAiBD,EACvB,OAAO,EAAK6W,SAAS,CACnBpQ,aAAc,CACfvH,SAAS,EACTU,QAAS,6CAEP,EAAKmX,qBAIP,OAAQ9W,EAAaU,OAAOC,eAC7B,IAAK,UACH2W,EAAiB,WACjB,MAEF,IAAK,UACHA,EAAiB,WACjB,MAEF,IAAK,UACHA,EAAiB,WACjB,MAEF,IAAK,UACHA,EAAiB,WACjB,MAEF,IAAK,eACL,IAAK,gBACHA,EAAiB,gBAOlB,EAAKV,UAAS,SAAAC,GAEf,KADA1K,EAAamL,GAAkBT,EAAUS,IAEvC,MAAQ,CACT9Q,aAAc,CACZvH,SAAS,EACTU,QAAS,0CAGJ,IACChE,EAAYkb,EAAZlb,SACP,OAAQ2b,GACT,IAAK,WACL,IAAK,WACHC,EAAkB5b,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEvF,KAAOqE,EAASgC,aACvDyV,EAAuB7b,EAASsa,WAAU,SAAAhV,GAAC,OAAIA,EAAEvF,KAAOqE,EAASgC,aAC1C,aAAnBuV,EACLC,EAAgBnF,WAAWrS,GAE3BwX,EAAgBpG,WAAWpR,GAE1B,MAEF,IAAK,WACL,IAAK,gBACHwX,EAAkB5b,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEC,SAASC,MAAK,SAAAC,GAAC,OAAIA,EAAE1F,KAAOqE,EAASkG,gBAC5EuR,EAAuB7b,EAASsa,WAAU,SAAAhV,GAAC,OAAIA,EAAEC,SAASC,MAAK,SAAAC,GAAC,OAAIA,EAAE1F,KAAOqE,EAASkG,gBAC/D,aAAnBqR,EACLC,EAAgB/M,WAAWzK,GAE3BwX,EAAgBzM,gBAAgB/K,GAE/B,MAEF,QACEoM,EAAW1Q,KAAKsE,GAKnB,MAAuB,aAAnBuX,EACM,CACT/Q,SAAS,EACT5K,SAAUwQ,IAGT0K,EAAUlb,SAAS6b,GAAwBD,EACnC,CACThR,SAAS,EACT5K,SAAS,YAAKkb,EAAUlb,eAGrB,WACA2b,GAAkBnL,EAChBR,GACMtC,KAAS6C,YAEjBC,WAAWmL,GACXlL,IAAIrM,EAASrE,IACb+b,IAHH,MAGW1X,IACRuM,MAAK,WACP,EAAKsK,UAAS,SAAAC,GAAS,MAAK,CAC1BtQ,SAAS,EACT8O,QAASC,GAAsBuB,EAAUlb,UACzC6K,aAAc,CACfvH,SAAS,EACTU,QAAQ,WAAD,OAAaK,EAAb,kDAEJ,EAAK8W,wBAEPvK,OAAM,SAAAuD,GACR,EAAK8G,SAAS,CACZrQ,SAAS,EACTC,aAAc,CACfvH,SAAS,EACTU,QAAQ,qBAAD,OAAuBK,EAAvB,oBAA+C8P,EAAInQ,WAExD,EAAKmX,wBAIR,EAAKF,SAAS,CACfpQ,aAAc,CACZvH,SAAS,EACTU,QAAS,UAeb,EAAKqD,sBAAwB,SAAChD,EAAcD,GAAmC,IAAzB4L,IAAwB,yDACxE3L,GAAgBD,GACrB,EAAKM,2BAA2B,KAAM,MAAM,WAC1C,EAAKuW,UAAS,SAAAC,GAAS,aACrBA,EADqB,CAExBtQ,SAAS,OACJ,WACL,IAAI4F,EACJ,OAAQnM,EAAaU,OAAOC,eAC1B,IAAK,UACNwL,EAAa,WACb,MAEC,IAAK,UACNA,EAAa,WACb,MAEC,IAAK,UACNA,EAAa,WACb,MAEC,IAAK,UACNA,EAAa,WACb,MAEC,IAAK,gBACL,IAAK,eACNA,EAAa,gBAMd,GAAIA,EAAY,CACd,IAAMF,EAAK5C,KAAS6C,YACD,aAAfC,GAGDR,IACF5L,EAASmB,SAASiE,SAAQ,SAAA/D,GAE3BA,EAAEC,SAAS8D,SAAQ,SAAA7D,GACjB2K,EACAE,WAAW,YACXC,IAAI9K,EAAE5F,IACNgc,YAIFtW,EAAEsB,cAAcyC,SAAQ,SAAAxC,GACtBsJ,EACAE,WAAW,iBACXC,IAAIzJ,EAAEjH,IACNgc,YAIFzL,EACGE,WAAW,YACXC,IAAIhL,EAAE1F,IACNgc,YAIF3X,EAASsD,SAAS8B,SAAQ,SAAAwC,GAC3BsE,EACGE,WAAW,YACXC,IAAIzE,EAAEjM,IACNgc,YAIFzL,EACAE,WAAW,YACXC,IAAIrM,EAASrE,IACbgc,UAEF,EAAKd,UAAS,SAAAC,GAAc,IACrBlb,EAAYkb,EAAZlb,SAEL,MAAQ,CACTA,SAFCA,EAAWA,EAAS+L,QAAO,SAAAzG,GAAC,OAAIA,EAAEvF,KAAOqE,EAASrE,MAGnD6K,SAAS,EACT8O,QAASC,GAAsB3Z,GAC/B6K,aAAc,CACZvH,SAAS,EACTU,QAAQ,OAAD,OAASK,EAAT,sDAGP,EAAK8W,sBACmB,aAAf3K,EAEZ,EAAKyK,UAAS,SAAAC,GAAc,IACnBlb,EAAYkb,EAAZlb,SACD0V,EAAsB1V,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEC,SAASC,MAAK,SAAAC,GAAC,OAAIA,EAAE1F,KAAOqE,EAASrE,SAEtF,OADA2V,EAAoBsG,kBAAkB5X,EAASrE,IACvC,CACTC,SAAS,CACP0V,GADM,mBAEH1V,EAAS+L,QAAO,SAAAzG,GAAC,OAAIA,EAAEvF,KAAO2V,EAAoB3V,YAGrD,WACGiQ,GAELM,EACGE,WAAW,YACXC,IAAIrM,EAASrE,IACbgc,SAEF,EAAKd,UAAS,SAAAC,GAAS,MAAK,CAC7BtQ,SAAS,EACT8O,QAASC,GAAsBuB,EAAUlb,UACzC6K,aAAc,CACZvH,SAAS,EACTU,QAAQ,OAAD,OAASK,EAAT,sDAEJ,EAAK8W,wBAWgB,aAAf3K,EAEZ,EAAKyK,UAAS,SAAAC,GAAc,IACnBlb,EAAYkb,EAAZlb,SACD0V,EAAsB1V,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEC,SAASC,MAAK,SAAAC,GAAC,OAAIA,EAAE1F,KAAOqE,EAASkG,gBAGtF,OAFAoL,EAAoBuG,yBAAyB7X,EAAUA,EAASkG,WAExD,CACTtK,SAAS,CACP0V,GADM,mBAEH1V,EAAS+L,QAAO,SAAAzG,GAAC,OAAIA,EAAEvF,KAAO2V,EAAoB3V,YAGrD,WACGiQ,GAELM,EACGE,WAAW,YACXC,IAAIrM,EAASrE,IACbgc,SACApL,MAAK,WACP,EAAKsK,UAAS,SAAAC,GAAS,MAAK,CAC1BtQ,SAAS,EACT8O,QAASC,GAAsBuB,EAAUlb,UACzC6K,aAAc,CACfvH,SAAS,EACTU,QAAQ,OAAD,OAASK,EAAT,sDAEJ,EAAK8W,2BAIgB,aAAf3K,EAEZ,EAAKyK,UAAS,SAAAC,GAAc,IACnBlb,EAAYkb,EAAZlb,SACD0V,EAAsB1V,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEvF,KAAOqE,EAASgC,aAGjE,OAFAsP,EAAoBwG,kBAAkB9X,EAASrE,IAEvC,CACTC,SAAS,CACP0V,GADM,mBAEH1V,EAAS+L,QAAO,SAAAzG,GAAC,OAAIA,EAAEvF,KAAO2V,EAAoB3V,YAGrD,WACGiQ,GAELM,EACGE,WAAW,YACXC,IAAIrM,EAASrE,IACbgc,SACApL,MAAK,WACP,EAAKsK,SAAS,CACZrQ,SAAS,EACTC,aAAc,CACfvH,SAAS,EACTU,QAAQ,OAAD,OAASK,EAAT,oDAEL,EAAK8W,2BAIiB,kBAAf3K,EAEZ,EAAKyK,UAAS,SAAAC,GAAc,IACnBlb,EAAYkb,EAAZlb,SACD0V,EAAsB1V,EAASqF,MAAK,SAAAC,GAAC,OAAIA,EAAEC,SAASC,MAAK,SAAAC,GAAC,OAAIA,EAAE1F,KAAOqE,EAASkG,gBAGtF,OAFAoL,EAAoByG,8BAA8B/X,EAAUA,EAASkG,WAE7D,CACTtK,SAAS,CACP0V,GADM,mBAEH1V,EAAS+L,QAAO,SAAAzG,GAAC,OAAIA,EAAEvF,KAAO2V,EAAoB3V,YAGrD,WACGiQ,GAELM,EACGE,WAAW,iBACXC,IAAIrM,EAASrE,IACbgc,SACApL,MAAK,WACP,EAAKsK,SAAS,CACZrQ,SAAS,EACTC,aAAc,CACfvH,SAAS,EACTU,QAAQ,OAAD,OAASK,EAAT,oDAEL,EAAK8W,2BAKV,EAAKF,SAAS,CACZrQ,SAAS,EACTC,aAAc,CACfvH,SAAS,EACTU,QAAQ,+EAEN,EAAKmX,6BAcX,EAAKzW,2BAA6B,SAACL,EAAcD,EAAU0L,GACzD,EAAKmL,UAAS,SAAAC,GAAS,MAAK,CAC7B/W,eAAe,GAAD,GACT+W,EAAU/W,eADD,CAEZC,SAAUA,GAAsB8W,EAAU/W,eAAeC,SACzDC,aAAcA,GAA8B6W,EAAU/W,eAAeE,aACrEG,yBAA0B0W,EAAU/W,eAAeK,6BAEhDsL,IAGN,EAAK8J,MAAQ,CACXhP,SAAS,EACT5K,SAAU,GACV0H,SAAU,GACVnC,SAAU,GACVG,SAAU,GACVqB,cAAe,GACf2S,QAAS,GACT0C,WAAY,EAAKA,WACjB/I,YAAa,EAAKA,YAClBlP,eAAgB,CACjBE,aAAc,GACdD,SAAU,GACViD,sBAAuB,EAAKA,sBAC5B7C,yBAAyB,EACzBE,2BAA4B,EAAKA,4BAEhCuO,YAAa,EAAKA,YAClBuC,WAAY,EAAKA,WACjB3G,WAAY,EAAKA,WACjB4H,WAAY,EAAKA,WACjBtH,gBAAiB,EAAKA,gBACtBtE,aAAc,CACfvH,SAAS,EACTU,QAAS,KAvfU,EADrB,iFAigBuB,IAAD,OACrBsH,KACG+Q,iBAAiB,WAAY,WAAY,WAAY,WAAY,iBACjE1L,MAAK,SAAAiB,GAEP,EAAKqJ,UAAS,SAAAC,GAAc,IACnBxT,EAAyDwT,EAAzDxT,SAAUnC,EAA+C2V,EAA/C3V,SAAUG,EAAqCwV,EAArCxV,SAAUqB,EAA2BmU,EAA3BnU,cAAe/G,EAAYkb,EAAZlb,SA6CpD,OAxCAA,EAASwJ,SAAQ,SAAAlE,GAClBC,EACGwG,QAAO,SAAAtG,GAAC,OAAIA,EAAEW,YAAcd,EAAEvF,MAC9ByJ,SAAQ,SAAA/D,GACVH,EAAEkQ,WAAW/P,SAKbzF,EAASwJ,SAAQ,SAAAlE,GACAI,EAASqG,QAAO,SAAApG,GAAC,OAAIL,EAAEC,SAASC,MAAK,SAAAC,GAAC,OAAIA,EAAE1F,KAAO4F,EAAE2E,gBACvDd,SAAQ,SAAA7D,GACtBL,EAAEuJ,WAAWlJ,MAGQoB,EAAcgF,QAAO,SAAA/E,GAAC,OAAI1B,EAAEC,SAASC,MAAK,SAAAC,GAAC,OAAIA,EAAE1F,KAAOiH,EAAEsD,gBAC5Dd,SAAQ,SAAAxC,GAC3B1B,EAAE6J,gBAAgBnI,MAGFU,EAASqE,QAAO,SAAAC,GAAC,OAAIA,EAAE5F,YAAcd,EAAEvF,MACzCyJ,SAAQ,SAAAwC,GACtB1G,EAAEmR,WAAWzK,SAMdhM,EAASwJ,SAAQ,SAAAlE,GAClBA,EAAEkJ,uBAAsB,WACtB,EAAKyM,SAAS,CACfpQ,aAAc,CACZvH,SAAS,EACTU,QAAQ,wBAAD,OAA0BsB,EAAE9E,aAA5B,YAA4C8E,EAAE7E,MAA9C,aAAwD6E,EAAE5E,KAA1D,OAEL,EAAKya,2BAKD,CACTnb,WACA0Z,QAHiBC,GAAsB3Z,UAOtC4Q,OAAM,SAAAuD,GAER,EAAK8G,SAAS,CACZpQ,aAAc,CACfvH,SAAS,EACTU,QAAQ,UAAD,OAAYmQ,EAAInQ,WAErB,EAAKmX,0BAjkBV,+LAwoB4BmB,EAxoB5B,yBAwoB4BA,EAxoB5B,iCAyoBQC,QAAQC,IAAIF,EAAY3T,KAAI,SAAA6H,GAAU,OAAI,EAAKqK,gBAAgBrK,QAzoBvE,gIA6oBC,OACE,kBAAC1R,EAAD,CAAa+M,MAAOP,KAAKsO,OAC1B,kBAAC,EAAD,MACA,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAO6C,OAAK,EAACC,KAAK,IAAIC,OAAQ,SAAAzZ,GAAK,OAAI,kBAAC,GAAcA,MACtD,kBAAC,IAAD,CAAOwZ,KAAK,WACb,kBAAC,EAAD,OAEC,kBAAC,IAAD,CAAOA,KAAK,OAAOC,OAAQ,SAACzZ,GAAD,OAAW,kBAAC,GAAeA,MACtD,kBAAC,IAAD,CAAOwZ,KAAK,mBAAmBC,OAAQ,SAACzZ,GAAD,OAAW,kBAAC,GAAgBA,MACnE,kBAAC,IAAD,CAAOwZ,KAAK,mBAAmBC,OAAQ,SAACzZ,GAAD,OAAW,kBAAC,GAAgBA,MACnE,kBAAC,IAAD,CAAOwZ,KAAK,yBAAyBC,OAAQ,SAACzZ,GAAD,OAAW,kBAAC,GAAeA,MACxE,kBAAC,IAAD,CAAOwZ,KAAK,yBAAyBC,OAAQ,SAACzZ,GAAD,OAAW,kBAAC,GAAeA,MACxE,kBAAC,IAAD,CAAOwZ,KAAK,6BACXC,OAAQ,SAACzZ,GAAD,OAAW,kBAAC,GAAmBA,MACxC,kBAAC,IAAD,CAAOwZ,KAAK,yBAAyBC,OAAQ,SAACzZ,GAAD,OAAW,kBAAC,GAAeA,MACxE,kBAAC,IAAD,CAAOwZ,KAAK,8BACXC,OAAQ,SAACzZ,GAAD,OAAW,kBAAC,GAAoBA,MACzC,kBAAC,IAAD,CAAOwZ,KAAK,kCACXC,OAAQ,SAACzZ,GAAD,OAAW,kBAAC,GAAwBA,MAC7C,kBAAC,IAAD,CAAOwZ,KAAK,IAAIC,OAAQ,SAACzZ,GAAD,OAAW,kBAAC,EAAmBA,YAjqB3D,GAAyBtE,IAAM6D,WCjBXma,QACW,cAA7BC,OAAOC,SAASC,UAEa,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASpE,MAC1B,2D,cCPDqE,IAASL,OACP,kBAAC,IAAD,CAAeM,SAAS,sBACtB,kBAAC,GAAD,OAGFC,SAASC,eAAe,SDiHpB,kBAAmBC,WACxBA,UAAUC,cAAcC,MAAM3M,MAAK,SAAA4M,GACjCA,EAAaC,kB","file":"static/js/main.dceba66b.chunk.js","sourcesContent":["/**\r\n * AppContext.js\r\n */\r\nimport React from 'react';\r\n\r\n/**\r\n * AppContext - creates a \"global\" state for the app\r\n * @type {React.Context<{}>}\r\n */\r\nexport const AppContext = React.createContext({});\r\n\r\n/**\r\n * AppProvider - provides the context for child components to consume\r\n * @type {React.Provider<{}>}\r\n */\r\nexport const AppProvider = AppContext.Provider;\r\n\r\n/**\r\n * AppConsumer - allows child components to consume the context\r\n * @type {React.Consumer<{}>}\r\n */\r\nexport const AppConsumer = AppContext.Consumer;\r\n","/**\r\n * SearchVehicle.js\r\n */\r\nimport React, {useRef, useState} from 'react';\r\nimport {Typeahead} from 'react-bootstrap-typeahead';\r\nimport {AppConsumer} from \"../../AppContext/AppContext\";\r\nimport {Button, Form, FormGroup} from \"react-bootstrap\";\r\nimport { useHistory } from 'react-router-dom';\r\n\r\n/**\r\n * SearchVehicle component - allows the user to search for a vehicle (with typeahead) by\r\n * manufacturer, model or year\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport const SearchVehicle = () => {\r\n  const [selected, setSelected] = useState([]);\r\n  const typeaheadRef = useRef(null);\r\n  const history = useHistory();\r\n\r\n  const handleSubmit = e => {\r\n\te.preventDefault();\r\n\r\n\tif (selected && selected.length) {\r\n\t  history.push(`/show/${selected[0].id}`);\r\n\t}\r\n  };\r\n\r\n  return (\r\n\t<AppConsumer>\r\n\t  {\r\n\t\t({vehicles}) => (\r\n\t\t  <Form inline onSubmit={handleSubmit} className=\"mr-md-3\">\r\n\t\t\t<FormGroup>\r\n\t\t\t  <Typeahead\r\n\t\t\t\tid=\"search-vehicle\"\r\n\t\t\t\tlabelKey={(option) => `${option.manufacturer} ${option.model} (${option.year})`}\r\n\t\t\t\tfilterBy={['manufacturer', 'model', 'year']}\r\n\t\t\t\toptions={vehicles}\r\n\t\t\t\tplaceholder=\"Search for a vehicle...\"\r\n\t\t\t\thighlightOnlyResult\r\n\t\t\t\tminLength={1}\r\n\t\t\t\tonChange={selected => setSelected(selected)}\r\n\t\t\t\tref={typeaheadRef}\r\n\t\t\t  />\r\n\t\t\t  <Button variant=\"outline-primary\" type=\"submit\" className=\"ml-sm-3\">\r\n\t\t\t\tSearch\r\n\t\t\t  </Button>\r\n\t\t\t  <Button\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t  typeaheadRef.current.clear();\r\n\t\t\t\t  typeaheadRef.current.focus();\r\n\t\t\t\t}}\r\n\t\t\t\tvariant=\"outline-danger\"\r\n\t\t\t\tclassName=\"ml-sm-3\">\r\n\t\t\t\tClear\r\n\t\t\t  </Button>\r\n\t\t\t</FormGroup>\r\n\t\t  </Form>\r\n\t\t)\r\n\t  }\r\n\t</AppConsumer>\r\n  )\r\n};\r\n","/**\r\n * Navigation.js\r\n */\r\nimport React from 'react';\r\nimport {Navbar, Nav, NavDropdown} from 'react-bootstrap';\r\nimport {Link} from 'react-router-dom';\r\nimport NavItem from \"react-bootstrap/NavItem\";\r\nimport {SearchVehicle} from \"./SearchVehicle\";\r\n\r\n/**\r\n * Navigation component - renders a navbar to navigate through the app\r\n */\r\nexport class Navigation extends React.Component {\r\n  render() {\r\n\treturn (\r\n\t  <Navbar bg=\"light\" variant=\"light\" expand=\"lg\">\r\n\t\t<Navbar.Brand as={Link} to=\"/\" className=\"mr-lg-5\">Car Rental System</Navbar.Brand>\r\n\t\t<Navbar.Toggle aria-controls=\"navbar-collapse\"/>\r\n\t\t<Navbar.Collapse id=\"navbar-collapse\">\r\n\t\t  <Nav className=\"mr-auto\">\r\n\t\t\t<NavItem>\r\n\t\t\t  <Nav.Link as={Link} to=\"/\" className=\"mr-lg-3\">Home</Nav.Link>\r\n\t\t\t</NavItem>\r\n\t\t\t<NavDropdown className=\"mr-lg-4\" title=\"Manage vehicles\" id=\"manage-vehicles\">\r\n\t\t\t  <NavDropdown.Item as={Link} to=\"/browse\">Browse vehicles</NavDropdown.Item>\r\n\t\t\t  <NavDropdown.Item as={Link} to=\"/add\">Add a new vehicle</NavDropdown.Item>\r\n\t\t\t</NavDropdown>\r\n\t\t  </Nav>\r\n\t\t  <SearchVehicle />\r\n\t\t</Navbar.Collapse>\r\n\t  </Navbar>\r\n\t)\r\n  }\r\n}\r\n","/**\r\n * LoadingSpinner.js\r\n */\r\nimport React from 'react';\r\nimport { Spinner } from 'react-bootstrap';\r\n\r\n/**\r\n * LoadingSpinner component - renders a loading spinner, with a fallback for screen readers\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport const LoadingSpinner = () => (\r\n  <Spinner\r\n\tanimation=\"border\"\r\n\tvariant=\"success\"\r\n\trole=\"status\"\r\n\tstyle={{width: '5rem', height: '5rem'}}>\r\n\t<span className=\"sr-only\">Loading...</span>\r\n  </Spinner>\r\n);\r\n","/**\r\n * Notification.js\r\n */\r\nimport React, {useState} from 'react';\r\nimport {Toast} from \"react-bootstrap\";\r\n\r\n/**\r\n * @typedef {Object} NotificationProps\r\n * @property {boolean} display - determines whether a notification should be shown\r\n * @property {string} message - notification message\r\n */\r\n/**\r\n * Notification component - renders notifications as a Toast, which is dismissible and auto hides\r\n * in 3 seconds\r\n * @param {NotificationProps} props\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport const Notification = props => {\r\n  const [show, setShow] = useState(true);\r\n\r\n  return (\r\n\t<Toast\r\n\t  style={{\r\n\t\tdisplay: props.display ? \"block\" : \"none\",\r\n\t\tposition: 'absolute',\r\n\t\ttop: 0,\r\n\t\tleft: '50%',\r\n\t\ttransform: 'translateX(-50%)'\r\n\t  }}\r\n\t  onClose={() => setShow(false)}\r\n\t  show={show}\r\n\t  delay={3000}\r\n\t  autohide>\r\n\t  <Toast.Header>\r\n\t\t<strong className=\"mr-auto\">Notification</strong>\r\n\t  </Toast.Header>\r\n\t  <Toast.Body>\r\n\t\t{props.message}\r\n\t  </Toast.Body>\r\n\t</Toast>\r\n  )\r\n};\r\n","/**\r\n * DeleteResourceModal.js\r\n */\r\nimport React, {useContext} from 'react';\r\nimport {Button, ListGroup, Modal} from \"react-bootstrap\";\r\nimport {AppConsumer, AppContext} from \"../../AppContext/AppContext\";\r\nimport moment from \"moment\";\r\n\r\n/**\r\n * DeleteResourceModal component - displays a modal to confirm whether a resource (i.e. vehicle, booking,\r\n * journey, service or fuel purchase) should be deleted\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport const DeleteResourceModal = () => {\r\n  const {vehicles, deleteResource} = useContext(AppContext);\r\n  const {resource, resourceType} = deleteResource;\r\n\r\n  /**\r\n   * Renders all the information about a resource in a list\r\n   * @param {string} resourceType - one of: \"vehicle\", \"booking\", \"journey\", \"service\",\r\n   * \"fuelPurchase\" or \"fuel purchase\"\r\n   * @param {(Vehicle|Booking|Journey|Service|FuelPurchase)} resource - the resource object\r\n   * @returns {*}\r\n   */\r\n  const renderResourceInfo = (resourceType, resource) => {\r\n\tif (resourceType && resource) {\r\n\t  switch (resourceType.trim().toLowerCase()) {\r\n\t\tcase 'vehicle':\r\n\t\t  return (\r\n\t\t\t<ListGroup>\r\n\t\t\t  <ListGroup.Item>Manufacturer: {resource ? resource.manufacturer : ''}</ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>Model: {resource ? resource.model : ''}</ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>Year: {resource ? resource.year : ''}</ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>Registration\r\n\t\t\t\tnumber: {resource ? resource.registrationNumber : ''}</ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>Odometer\r\n\t\t\t\treading: {resource ? resource.odometerReading : 0} km</ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>Tank\r\n\t\t\t\tcapacity: {resource ? resource.tankCapacity : 0} L</ListGroup.Item>\r\n\t\t\t</ListGroup>\r\n\t\t  );\r\n\r\n\t\tcase 'journey':\r\n\t\t  return (\r\n\t\t\t<ListGroup>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tJourney\r\n\t\t\t\tvehicle: {resource && vehicles.find(v => v.bookings.some(b => b.journeys.some(j => j.id === resource.id))) ? `${vehicles.find(v => v.bookings.some(b => b.journeys.some(j => j.id === resource.id))).manufacturer} ${vehicles.find(v => v.bookings.some(b => b.journeys.some(j => j.id === resource.id))).model} (${vehicles.find(v => v.bookings.some(b => b.journeys.some(j => j.id === resource.id))).year})` : ''}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tJourney start date: {resource ? moment(resource.journeyStartedAt).format('DD/MM/YYYY') : ''}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tJourney end date: {resource ? moment(resource.journeyEndedAt).format('DD/MM/YYYY') : ''}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tJourney start odometer\r\n\t\t\t\treading: {resource ? `${resource.journeyStartOdometerReading} km` : ''}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tJourney end odometer\r\n\t\t\t\treading: {resource ? `${resource.journeyEndOdometerReading} km` : ''}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tJourney from: {resource ? resource.journeyFrom : ''}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tJourney to: {resource ? resource.journeyTo : ''}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t</ListGroup>\r\n\t\t  );\r\n\r\n\t\tcase 'booking':\r\n\t\t  return (\r\n\t\t\t<ListGroup>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tBooking\r\n\t\t\t\tvehicle: {resource ? `${vehicles.find(v => v.id === resource.vehicleID).manufacturer} ${vehicles.find(v => v.id === resource.vehicleID).model} (${vehicles.find(v => v.id === resource.vehicleID).year})` : ''}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tBooking start date: {resource ? moment(resource.startDate).format('DD/MM/YYYY') : ''}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tBooking end date: {resource ? moment(resource.endDate).format('DD/MM/YYYY') : ''}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tBooking start odometer reading: {resource ? `${resource.startOdometer} km` : ''}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tBooking type: {resource ? resource.bookingType === 'K' ? 'Per kilometer' : 'Per' +\r\n\t\t\t\t' day' : ''}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tBooking cost: {\r\n\t\t\t    `$ ${Number.parseFloat(resource.bookingCost).toFixed(2)}`\r\n\t\t\t  }\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t</ListGroup>\r\n\t\t  );\r\n\r\n\t\tcase 'service':\r\n\t\t  return (\r\n\t\t\t<ListGroup>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tService\r\n\t\t\t\tvehicle: {resource && vehicles.some(v => v.id === resource.vehicleID) ? `${vehicles.find(v => v.id === resource.vehicleID).manufacturer} ${vehicles.find(v => v.id === resource.vehicleID).model} (${vehicles.find(v => v.id === resource.vehicleID).year})` : ''}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tServiced at: {resource ? moment(resource.servicedAt).format('DD/MM/YYYY') : ''}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tService odometer reading: {resource ? `${resource.serviceOdometer} km` : ''}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t</ListGroup>\r\n\t\t  );\r\n\r\n\t\tcase 'fuelpurchase':\r\n\t\tcase 'fuel purchase':\r\n\t\t  return (\r\n\t\t\t<ListGroup>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tFuel purchased for\r\n\t\t\t\tvehicle: {resource && vehicles.find(v => v.bookings.some(b => b.fuelPurchases.some(f => f.id === resource.id))) ? `${vehicles.find(v => v.bookings.some(b => b.fuelPurchases.some(f => f.id === resource.id))).manufacturer} ${vehicles.find(v => v.bookings.some(b => b.fuelPurchases.some(f => f.id === resource.id))).model} (${vehicles.find(v => v.bookings.some(b => b.fuelPurchases.some(f => f.id === resource.id))).year})` : ''}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tFuel quantity: {resource ? `${resource.fuelQuantity} L` : ''}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tFuel\r\n\t\t\t\tprice: {resource ? `$ ${Number.parseFloat(resource.fuelPrice).toFixed(2)}` : ''}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t  <ListGroup.Item>\r\n\t\t\t\tTotal cost: {resource ? `$ ${(resource.fuelQuantity * resource.fuelPrice).toFixed(2)}` : ``}\r\n\t\t\t  </ListGroup.Item>\r\n\t\t\t</ListGroup>\r\n\t\t  );\r\n\r\n\t\tdefault:\r\n\t\t  return (\r\n\t\t\t<p className=\"text-center\">Error: resource info not found</p>\r\n\t\t  );\r\n\t  }\r\n\t}\r\n  };\r\n\r\n  return (\r\n\t<AppConsumer>\r\n\t  {\r\n\t\t({deleteResource}) => {\r\n\t\t  return (\r\n\t\t\t<Modal\r\n\t\t\t  size=\"lg\"\r\n\t\t\t  show={deleteResource.showDeleteResourceModal}\r\n\t\t\t  onHide={() => deleteResource.setDeleteResourceModalShow(null, null)}\r\n\t\t\t  aria-labelledby=\"delete-modal\"\r\n\t\t\t  centered\r\n\t\t\t>\r\n\t\t\t  <Modal.Header closeButton>\r\n\t\t\t\t<Modal.Title id=\"delete-modal\">\r\n\t\t\t\t  Delete confirmation\r\n\t\t\t\t</Modal.Title>\r\n\t\t\t  </Modal.Header>\r\n\t\t\t  <Modal.Body>\r\n\t\t\t\t<h3 className=\"mb-4\">Are you sure that you want to delete this {resourceType} from\r\n\t\t\t\t  the\r\n\t\t\t\t  system?</h3>\r\n\t\t\t\t<h4>{resourceType} information:</h4>\r\n\t\t\t  </Modal.Body>\r\n\t\t\t  {renderResourceInfo(resourceType, resource)}\r\n\t\t\t  <Modal.Footer>\r\n\t\t\t\t<Button\r\n\t\t\t\t  variant=\"danger\"\r\n\t\t\t\t  size=\"lg\"\r\n\t\t\t\t  className=\"mr-3\"\r\n\t\t\t\t  onClick={() => deleteResource.resource ? deleteResource.confirmDeleteResource(resourceType, resource) : ''}\r\n\t\t\t\t>\r\n\t\t\t\t  Delete\r\n\t\t\t\t</Button>\r\n\t\t\t\t<Button\r\n\t\t\t\t  variant=\"info\"\r\n\t\t\t\t  size=\"lg\"\r\n\t\t\t\t  onClick={() => deleteResource.setDeleteResourceModalShow(null)}\r\n\t\t\t\t>\r\n\t\t\t\t  Cancel\r\n\t\t\t\t</Button>\r\n\t\t\t  </Modal.Footer>\r\n\t\t\t</Modal>\r\n\t\t  )\r\n\t\t}\r\n\t  }\r\n\t</AppConsumer>\r\n  )\r\n};\r\n","/**\r\n * VehicleDetail.js\r\n */\r\nimport React, {useContext} from 'react';\r\nimport {Accordion, Button, ButtonGroup, Card, ListGroup} from \"react-bootstrap\";\r\nimport {Link} from \"react-router-dom\";\r\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\";\r\nimport {faCog, faEdit, faTrash} from \"@fortawesome/free-solid-svg-icons\";\r\nimport Dropdown from \"react-bootstrap/Dropdown\";\r\nimport moment from \"moment\";\r\nimport {DeleteResourceModal} from \"../Modals/DeleteResourceModal\";\r\nimport {AppContext} from \"../../AppContext/AppContext\";\r\n\r\n/**\r\n * @typedef {Object} VehicleDetailsProps\r\n * @property {Vehicle} vehicle - the selected vehicle\r\n */\r\n/**\r\n * VehicleDetails component - renders all the information about a single vehicle\r\n * @param {VehicleDetailsProps} props\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport const VehicleDetails = props => {\r\n  const {vehicle} = props;\r\n\r\n  const {\r\n    bookings: vehicleBookings,\r\n    services: vehicleServices\r\n  } = vehicle;\r\n\r\n  const {deleteResource} = useContext(AppContext);\r\n\r\n  return (\r\n    <>\r\n      <Accordion>\r\n        <Card style={{overflow: 'visible'}}>\r\n          <Card.Header>\r\n            <Accordion.Toggle\r\n              className=\"mr-auto\"\r\n              as={Button}\r\n              variant=\"link\"\r\n              eventKey={`${vehicle.manufacturer} ${vehicle.model} (${vehicle.year})`}\r\n            >\r\n              {`${vehicle.manufacturer} ${vehicle.model} (${vehicle.year})`}\r\n            </Accordion.Toggle>\r\n            <ButtonGroup aria-label=\"Options\">\r\n              <Link\r\n                to={`/edit/${vehicle.id}`}\r\n                className=\"mr-3\"\r\n              >\r\n                <Button\r\n                  variant=\"outline-warning\"\r\n                >\r\n                  <FontAwesomeIcon icon={faEdit}/>\r\n                </Button>\r\n              </Link>\r\n              <Button\r\n                onClick={() => deleteResource.setDeleteResourceModalShow('vehicle', vehicle)}\r\n                className=\"mr-3\"\r\n                variant=\"outline-danger\">\r\n                <FontAwesomeIcon icon={faTrash}/>\r\n              </Button>\r\n              <Dropdown drop=\"right\">\r\n                <Dropdown.Toggle variant=\"outline-secondary\">\r\n                  <FontAwesomeIcon icon={faCog}/>\r\n                </Dropdown.Toggle>\r\n                <Dropdown.Menu>\r\n                  <Dropdown.Item\r\n                    as={Link}\r\n                    to={`/addService/${vehicle.id}`}>\r\n                    Add service\r\n                  </Dropdown.Item>\r\n                  <Dropdown.Item\r\n                    as={Link}\r\n                    to={`/addBooking/${vehicle.id}`}>\r\n                    Add booking\r\n                  </Dropdown.Item>\r\n                  <Dropdown.Item\r\n                    as={Link}\r\n                    to={`/addJourney/${vehicle.id}`}>\r\n                    Add journey\r\n                  </Dropdown.Item>\r\n                  <Dropdown.Item\r\n                    as={Link}\r\n                    to={`/addFuelPurchase/${vehicle.id}`}>\r\n                    Add fuel purchase\r\n                  </Dropdown.Item>\r\n                </Dropdown.Menu>\r\n              </Dropdown>\r\n            </ButtonGroup>\r\n          </Card.Header>\r\n          <Accordion.Collapse\r\n            eventKey={`${vehicle.manufacturer} ${vehicle.model} (${vehicle.year})`}>\r\n            <Card.Body>\r\n              <ListGroup>\r\n                {\r\n                  Object.keys(\r\n                    vehicle.printDetails()\r\n                  )\r\n                    .map((field, index) => (\r\n                      <ListGroup.Item key={index}>\r\n                        {field}: {\r\n                        vehicle.printDetails()[field]\r\n                      }\r\n                      </ListGroup.Item>\r\n                    ))\r\n                }\r\n                <ListGroup.Item>\r\n                  Tank capacity: {vehicle.tankCapacity} L\r\n                </ListGroup.Item>\r\n                <ListGroup.Item>\r\n                  <Accordion>\r\n                    <Card>\r\n                      <Card.Header>\r\n                        <Accordion.Toggle\r\n                          className=\"mr-auto\"\r\n                          as={Button}\r\n                          variant=\"link\"\r\n                          eventKey=\"0\">\r\n                          Booking Records\r\n                        </Accordion.Toggle>\r\n                      </Card.Header>\r\n                      <Accordion.Collapse eventKey=\"0\">\r\n                        <Card.Body>\r\n                          {\r\n                            vehicleBookings &&\r\n                            vehicleBookings\r\n                              .sort((b1, b2) => (\r\n                                moment(b2.startDate).isBefore(moment(b1.startDate))\r\n                              ))\r\n                              .map((booking, index) => (\r\n                                <Accordion key={index}>\r\n                                  <Card>\r\n                                    <Card.Header>\r\n                                      <Accordion.Toggle\r\n                                        className=\"mr-auto\"\r\n                                        as={Button}\r\n                                        variant=\"link\"\r\n                                        eventKey={index}>\r\n                                        {`${new Date(booking.startDate).toLocaleDateString(\"en-AU\")} - ${new Date(booking.endDate).toLocaleDateString(\"en-AU\")}`}\r\n                                      </Accordion.Toggle>\r\n                                      <Button\r\n                                        onClick={() => deleteResource.setDeleteResourceModalShow('booking', booking)}\r\n                                        className=\"mr-3\"\r\n                                        variant=\"outline-danger\">\r\n                                        <FontAwesomeIcon icon={faTrash}/>\r\n                                      </Button>\r\n                                    </Card.Header>\r\n                                    <Accordion.Collapse eventKey={index}>\r\n                                      <Card.Body>\r\n                                        <ListGroup key={booking.id}>\r\n                                          <ListGroup.Item>\r\n                                            Start\r\n                                            Date: {new Date(booking.startDate).toLocaleDateString(\"en-AU\")}\r\n                                          </ListGroup.Item>\r\n                                          <ListGroup.Item>\r\n                                            End\r\n                                            Date: {new Date(booking.endDate).toLocaleDateString(\"en-AU\")}\r\n                                          </ListGroup.Item>\r\n                                          <ListGroup.Item>\r\n                                            Start\r\n                                            Odometer: {booking.startOdometer} km\r\n                                          </ListGroup.Item>\r\n\t\t\t\t\t\t\t\t\t\t  <ListGroup.Item>\r\n\t\t\t\t\t\t\t\t\t\t\tEnd\r\n\t\t\t\t\t\t\t\t\t\t\tOdometer: {booking.endOdometer ? `${booking.endOdometer} km` : `Pending`}\r\n\t\t\t\t\t\t\t\t\t\t  </ListGroup.Item>\r\n                                          <ListGroup.Item>\r\n                                            Booking\r\n                                            Type: {booking.bookingType === 'D' ? 'Per day' : 'Per kilometer'}\r\n                                          </ListGroup.Item>\r\n                                          <ListGroup.Item>\r\n                                            Booking cost: {\r\n                                            booking.bookingCost ? `$ ${Number.parseFloat(booking.bookingCost).toFixed(2)}` : 'Pending'\r\n                                          }\r\n                                          </ListGroup.Item>\r\n                                        </ListGroup>\r\n                                      </Card.Body>\r\n                                    </Accordion.Collapse>\r\n                                  </Card>\r\n                                </Accordion>\r\n                              ))\r\n                          }\r\n                        </Card.Body>\r\n                      </Accordion.Collapse>\r\n                    </Card>\r\n                  </Accordion>\r\n                </ListGroup.Item>\r\n                <ListGroup.Item>\r\n                  <Accordion>\r\n                    <Card>\r\n                      <Card.Header>\r\n                        <Accordion.Toggle\r\n                          className=\"mr-auto\"\r\n                          as={Button}\r\n                          variant=\"link\"\r\n                          eventKey=\"1\">\r\n                          Journey Records\r\n                        </Accordion.Toggle>\r\n                      </Card.Header>\r\n                      <Accordion.Collapse\r\n                        eventKey=\"1\">\r\n                        <Card.Body>\r\n                          {\r\n                            vehicle.bookings &&\r\n\t\t\t\t\t\t\t  vehicle\r\n\t\t\t\t\t\t\t\t.bookings\r\n\t\t\t\t\t\t\t\t.reduce((journeys, b) => {\r\n\t\t\t\t\t\t\t\t  b.journeys.forEach(j => {\r\n\t\t\t\t\t\t\t\t    journeys.push(j);\r\n\t\t\t\t\t\t\t\t  });\r\n\t\t\t\t\t\t\t\t  return journeys;\r\n\t\t\t\t\t\t\t\t}, [])\r\n                              .sort((journey1, journey2) => {\r\n                                const journey1StartedAt = new Date(journey1.journeyStartedAt);\r\n                                const journey2StartedAt = new Date(journey2.journeyStartedAt);\r\n                                if (journey1StartedAt > journey2StartedAt) {\r\n                                  return -1;\r\n                                } else if (journey1StartedAt < journey2StartedAt) {\r\n                                  return 1;\r\n                                }\r\n                                return 0;\r\n                              })\r\n                              .map((journey, index) => (\r\n                                <Accordion key={index}>\r\n                                  <Card>\r\n                                    <Card.Header>\r\n                                      <Accordion.Toggle\r\n                                        className=\"mr-auto\"\r\n                                        as={Button}\r\n                                        variant=\"link\"\r\n                                        eventKey={index}>\r\n                                        {`${new Date(journey.journeyStartedAt).toLocaleDateString(\"en-AU\")} - ${new Date(journey.journeyEndedAt).toLocaleDateString(\"en-AU\")}`}\r\n                                      </Accordion.Toggle>\r\n                                      <Button\r\n                                        onClick={() => deleteResource.setDeleteResourceModalShow('journey', journey)}\r\n                                        className=\"mr-3\"\r\n                                        variant=\"outline-danger\">\r\n                                        <FontAwesomeIcon icon={faTrash}/>\r\n                                      </Button>\r\n                                    </Card.Header>\r\n                                    <Accordion.Collapse eventKey={index}>\r\n                                      <Card.Body>\r\n                                        <ListGroup key={journey.id}>\r\n                                          <ListGroup.Item>\r\n                                            Journey started\r\n                                            at: {new Date(journey.journeyStartedAt).toLocaleDateString(\"en-AU\")}\r\n                                          </ListGroup.Item>\r\n                                          <ListGroup.Item>\r\n                                            Journey ended\r\n                                            at: {new Date(journey.journeyEndedAt).toLocaleDateString(\"en-AU\")}\r\n                                          </ListGroup.Item>\r\n                                          <ListGroup.Item>\r\n                                            Journey start odometer\r\n                                            reading: {journey.journeyStartOdometerReading} km\r\n                                          </ListGroup.Item>\r\n                                          <ListGroup.Item>\r\n                                            Journey end odometer\r\n                                            reading: {journey.journeyEndOdometerReading} km\r\n                                          </ListGroup.Item>\r\n                                          <ListGroup.Item>\r\n                                            Journey from: {journey.journeyFrom}\r\n                                          </ListGroup.Item>\r\n                                          <ListGroup.Item>\r\n                                            Journey to: {journey.journeyTo}\r\n                                          </ListGroup.Item>\r\n                                        </ListGroup>\r\n                                      </Card.Body>\r\n                                    </Accordion.Collapse>\r\n                                  </Card>\r\n                                </Accordion>\r\n                              ))\r\n                          }\r\n                        </Card.Body>\r\n                      </Accordion.Collapse>\r\n                    </Card>\r\n                  </Accordion>\r\n                </ListGroup.Item>\r\n                <ListGroup.Item>\r\n                  <Accordion>\r\n                    <Card>\r\n                      <Card.Header>\r\n                        <Accordion.Toggle\r\n                          className=\"mr-auto\"\r\n                          as={Button}\r\n                          variant=\"link\"\r\n                          eventKey=\"2\">\r\n                          Service Records\r\n                        </Accordion.Toggle>\r\n                      </Card.Header>\r\n                      <Accordion.Collapse\r\n                        eventKey=\"2\">\r\n                        <Card.Body>\r\n                          {\r\n                            vehicleServices\r\n                              .sort((service1, service2) => {\r\n                                const service1At = new Date(service1.servicedAt);\r\n                                const service2At = new Date(service2.servicedAt);\r\n\r\n                                if (service1At > service2At) {\r\n                                  return -1;\r\n                                } else if (service1At > service2At) {\r\n                                  return 1;\r\n                                }\r\n                                return 0;\r\n                              })\r\n                              .map((service, index) => (\r\n                                <Accordion key={index}>\r\n                                  <Card key={service.id}>\r\n                                    <Card.Header>\r\n                                      <Accordion.Toggle\r\n                                        className=\"mr-auto\"\r\n                                        as={Button}\r\n                                        variant=\"link\"\r\n                                        eventKey={index}>\r\n                                        {new Date(service.servicedAt).toLocaleDateString(\"en-AU\")}\r\n                                      </Accordion.Toggle>\r\n                                      <Button\r\n                                        onClick={() => deleteResource.setDeleteResourceModalShow('service', service)}\r\n                                        className=\"mr-3\"\r\n                                        variant=\"outline-danger\">\r\n                                        <FontAwesomeIcon icon={faTrash}/>\r\n                                      </Button>\r\n                                    </Card.Header>\r\n                                    <Accordion.Collapse\r\n                                      eventKey={index}>\r\n                                      <Card.Body>\r\n                                        <ListGroup>\r\n                                          <ListGroup.Item>\r\n                                            Serviced\r\n                                            at: {new Date(service.servicedAt).toLocaleDateString(\"en-AU\")}\r\n                                          </ListGroup.Item>\r\n                                          <ListGroup.Item>\r\n                                            Service\r\n                                            odometer: {service.serviceOdometer} km\r\n                                          </ListGroup.Item>\r\n                                        </ListGroup>\r\n                                      </Card.Body>\r\n                                    </Accordion.Collapse>\r\n                                  </Card>\r\n                                </Accordion>\r\n                              ))\r\n                          }\r\n                        </Card.Body>\r\n                      </Accordion.Collapse>\r\n                    </Card>\r\n                  </Accordion>\r\n                </ListGroup.Item>\r\n                <ListGroup.Item>\r\n                  <Accordion>\r\n                    <Card>\r\n                      <Card.Header>\r\n                        <Accordion.Toggle\r\n                          className=\"mr-auto\"\r\n                          as={Button}\r\n                          variant=\"link\"\r\n                          eventKey=\"3\">\r\n                          Fuel Purchase Records\r\n                        </Accordion.Toggle>\r\n                      </Card.Header>\r\n                      <Accordion.Collapse\r\n                        eventKey=\"3\">\r\n                        <Card.Body>\r\n                          {\r\n\t\t\t\t\t\t\tvehicle\r\n\t\t\t\t\t\t\t  .bookings\r\n\t\t\t\t\t\t\t  .reduce((fuelPurchases, b) => {\r\n\t\t\t\t\t\t\t\tb.fuelPurchases.forEach(f => {\r\n\t\t\t\t\t\t\t\t  fuelPurchases.push(f);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\treturn fuelPurchases;\r\n\t\t\t\t\t\t\t  }, [])\r\n                              .sort((fuelPurchase1, fuelPurchase2) => {\r\n                                const bookingFuelPurchase1 = vehicleBookings.find(booking => booking.id === fuelPurchase1.bookingID);\r\n                                const booking1StartedAt = new Date(bookingFuelPurchase1.startDate);\r\n                                const bookingFuelPurchase2 = vehicleBookings.find(booking => booking.id === fuelPurchase2.bookingID);\r\n                                const booking2StartedAt = new Date(bookingFuelPurchase2.startDate);\r\n                                if (booking1StartedAt > booking2StartedAt) {\r\n                                  return -1;\r\n                                } else if (booking1StartedAt < booking2StartedAt) {\r\n                                  return 1;\r\n                                }\r\n                                return 0;\r\n                              })\r\n                              .map((fuelPurchase, index) => (\r\n                                <Accordion key={index}>\r\n                                  <Card>\r\n                                    <Card.Header>\r\n                                      <Accordion.Toggle\r\n                                        className=\"mr-auto\"\r\n                                        as={Button}\r\n                                        variant=\"link\"\r\n                                        eventKey={index}>\r\n                                        {`${new Date(vehicleBookings.find(booking => booking.id === fuelPurchase.bookingID).startDate).toLocaleDateString(\"en-AU\")} - ${new Date(vehicleBookings.find(booking => booking.id === fuelPurchase.bookingID).endDate).toLocaleDateString(\"en-AU\")}`}\r\n                                      </Accordion.Toggle>\r\n                                      <Button\r\n                                        onClick={() => deleteResource.setDeleteResourceModalShow('fuel purchase', fuelPurchase)}\r\n                                        className=\"mr-3\"\r\n                                        variant=\"outline-danger\">\r\n                                        <FontAwesomeIcon icon={faTrash}/>\r\n                                      </Button>\r\n                                    </Card.Header>\r\n                                    <Accordion.Collapse eventKey={index}>\r\n                                      <Card.Body>\r\n                                        <ListGroup key={fuelPurchase.id}>\r\n                                          <ListGroup.Item>\r\n                                            Fuel\r\n                                            quantity: {fuelPurchase.fuelQuantity} L\r\n                                          </ListGroup.Item>\r\n                                          <ListGroup.Item>\r\n                                            Fuel price (per litre):\r\n                                            $ {Number.parseFloat(fuelPurchase.fuelPrice).toFixed(2)}\r\n                                          </ListGroup.Item>\r\n                                          <ListGroup.Item>\r\n                                            Total cost:\r\n                                            $ {(Number.parseFloat(fuelPurchase.fuelQuantity) * Number.parseFloat(fuelPurchase.fuelPrice)).toFixed(2)}\r\n                                          </ListGroup.Item>\r\n                                        </ListGroup>\r\n                                      </Card.Body>\r\n                                    </Accordion.Collapse>\r\n                                  </Card>\r\n                                </Accordion>\r\n                              ))\r\n                          }\r\n                        </Card.Body>\r\n                      </Accordion.Collapse>\r\n                    </Card>\r\n                  </Accordion>\r\n                </ListGroup.Item>\r\n              </ListGroup>\r\n            </Card.Body>\r\n          </Accordion.Collapse>\r\n        </Card>\r\n      </Accordion>\r\n      <DeleteResourceModal/>\r\n    </>\r\n  )\r\n}\r\n","/**\r\n * BrowseVehicle.js\r\n */\r\nimport React from 'react';\r\nimport {Col, Container, Row} from 'react-bootstrap'\r\nimport {LoadingSpinner} from \"../LoadingSpinner/LoadingSpinner\";\r\nimport {AppConsumer} from \"../../AppContext/AppContext\";\r\nimport {Notification} from \"../Notification/Notification\";\r\nimport {DeleteResourceModal} from \"../Modals/DeleteResourceModal\";\r\nimport {VehicleDetails} from \"../ShowVehicle/VehicleDetails\";\r\n\r\n/**\r\n * BrowseVehicle component - shows all vehicles\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport const BrowseVehicles = () => {\r\n  return (\r\n    <AppConsumer>\r\n      {\r\n        ({loading, vehicles, notification}) => (\r\n          <Container>\r\n            {\r\n              notification.display ?\r\n                (\r\n                  <Notification\r\n                    display={notification.display}\r\n                    message={notification.message}/>\r\n                ) : ''\r\n            }\r\n            <Row>\r\n              <Col>\r\n                <h2 className=\"text-center my-5\">All vehicles</h2>\r\n              </Col>\r\n            </Row>\r\n            <DeleteResourceModal/>\r\n            {\r\n              loading ?\r\n                (\r\n                  <Row className=\"justify-content-center mt-5\">\r\n                    <LoadingSpinner/>\r\n                  </Row>\r\n                ) :\r\n                (\r\n                  vehicles.map((v, i) => (\r\n                    <VehicleDetails\r\n                      key={i}\r\n                      vehicle={v}\r\n                    />\r\n                  ))\r\n                )\r\n            }\r\n          </Container>\r\n        )\r\n      }\r\n    </AppConsumer>\r\n  )\r\n};\r\n","/**\r\n * Service.js\r\n */\r\nimport moment from \"moment\";\r\n\r\n/**\r\n * Service model class\r\n * @class\r\n */\r\nexport class Service {\r\n  _id;\r\n  _vehicleID;\r\n  _serviceOdometer;\r\n  _servicedAt;\r\n  _createdAt;\r\n  _updatedAt;\r\n\r\n  /**\r\n   * Creates a new Service\r\n   * @param {string} vehicleID - ID of the vehicle associated with this service\r\n   * @param {number} serviceOdometer - odometer reading for this service\r\n   * @param {Date|string} servicedAt - when this service is due\r\n   * @param {string} id - ID of this service\r\n   * @param {string} createdAt - timestamp generated when this service is created\r\n   * @param {string|null} updatedAt - timestamp generated when this service is updated\r\n   */\r\n  constructor(vehicleID, serviceOdometer, servicedAt, id = require('uuid/v4')(), createdAt = moment().format('DD/MM/YYYY hh:mm:ss A'), updatedAt = null) {\r\n\tthis._id = id;\r\n\tthis._vehicleID = vehicleID;\r\n\tthis._serviceOdometer = serviceOdometer;\r\n\tthis._servicedAt = servicedAt;\r\n\tthis._createdAt = createdAt;\r\n\tthis._updatedAt = updatedAt;\r\n  }\r\n\r\n  get id() {\r\n\treturn this._id;\r\n  }\r\n\r\n  set id(value) {\r\n\tthis._id = value;\r\n  }\r\n\r\n  get vehicleID() {\r\n\treturn this._vehicleID;\r\n  }\r\n\r\n  set vehicleID(value) {\r\n\tthis._vehicleID = value;\r\n  }\r\n\r\n  get serviceOdometer() {\r\n\treturn this._serviceOdometer;\r\n  }\r\n\r\n  set serviceOdometer(value) {\r\n\tthis._serviceOdometer = value;\r\n  }\r\n\r\n  get servicedAt() {\r\n\treturn this._servicedAt;\r\n  }\r\n\r\n  set servicedAt(value) {\r\n\tthis._servicedAt = value;\r\n  }\r\n\r\n  get createdAt() {\r\n\treturn this._createdAt;\r\n  }\r\n\r\n  set createdAt(value) {\r\n\tthis._createdAt = value;\r\n  }\r\n\r\n  get updatedAt() {\r\n\treturn this._updatedAt;\r\n  }\r\n\r\n  set updatedAt(value) {\r\n\tthis._updatedAt = value;\r\n  }\r\n\r\n  /**\r\n   * Gets the number of services done up to today\r\n   * @param {Array<Service>} services - full list of services to be scanned\r\n   * @returns {number} numberOfServicesDone - number of services done up to this date\r\n   */\r\n  static getTotalServicesDone = services => {\r\n\treturn services.filter(s => moment(s.servicedAt).isBefore(moment())).length;\r\n  };\r\n\r\n  /**\r\n   * Gets the {@link serviceOdometer} of the latest service done up to this date\r\n   * @param {Array<Service>} services - full list of services to be scanned\r\n   * @returns {string|number} serviceOdometer - the latest service odometer reading or an error\r\n   * message, when no services in {@link services} have been made before this date\r\n   */\r\n  static getLastServiceOdometerReading = services => {\r\n\tif (services.length) {\r\n\t  const now = moment();\r\n\t  const servicesCopy = [...services];\r\n\t  const firstServicesBeforeToday = servicesCopy.sort((firstService, secondService) => {\r\n\t\tconst firstServiceDate = moment(firstService.servicedAt);\r\n\t\tconst secondServiceDate = moment(secondService.servicedAt);\r\n\t\treturn secondServiceDate.diff(firstServiceDate, 'days');\r\n\t  }).find(s => moment(s.servicedAt).isBefore(now));\r\n\r\n\t  if (firstServicesBeforeToday) {\r\n\t\treturn firstServicesBeforeToday.serviceOdometer;\r\n\t  }\r\n\t  return 'No services have been scheduled before today'\r\n\t}\r\n\treturn 'No services have been scheduled yet';\r\n  };\r\n\r\n  /**\r\n   * Determines whether there a service due\r\n   * @param {Array<Service>} services - full list of services to be scanned\r\n   * @returns {boolean} serviceDue\r\n   */\r\n  static requiresService = services => {\r\n\treturn services.some(service => moment(service.servicedAt).isSameOrAfter(moment(), 'days'));\r\n  }\r\n}\r\n","/**\r\n * Firebase.js\r\n */\r\nimport firebase from 'firebase';\r\n\r\n/**\r\n * Basic configuration object to connect to firebase\r\n * @type {{storageBucket: *, apiKey: *, messagingSenderId: *, appId: *, projectId: string, databaseURL: *, authDomain: *}}\r\n */\r\nconst config = {\r\n  apiKey: process.env.API_KEY || 'AIzaSyBN2bR0_A7pSJQ3W-yU8_e8jgfj1HVHg98',\r\n  authDomain: process.env.AUTH_DOMAIN || 'car-rental-system-725f7.firebaseapp.com',\r\n  databaseURL: process.env.DATABASE_URL || 'https://car-rental-system-725f7.firebaseio.com',\r\n  projectId: process.env.PROJECT_ID || 'car-rental-system-725f7',\r\n  storageBucket: process.env.STORAGE_BUCKET || 'car-rental-system-725f7.appspot.com',\r\n  messagingSenderId: process.env.MESSAGING_SENDER_ID || '533494537845',\r\n  appId: process.env.APP_ID || '533494537845:web:8886eede71aaf00dde623c'\r\n};\r\n\r\nfirebase.initializeApp(config);\r\n\r\nexport { firebase };\r\n","/**\r\n * Vehicle.js\r\n */\r\nimport moment from \"moment\";\r\nimport {Service} from \"./Service\";\r\nimport {firebase} from \"../Firebase/Firebase\";\r\n\r\n/**\r\n * Vehicle model class\r\n * @class\r\n */\r\nexport class Vehicle {\r\n  _id;\r\n  _manufacturer;\r\n  _model;\r\n  _year;\r\n  _odometerReading;\r\n  _registrationNumber;\r\n  _tankCapacity;\r\n  _fuelEconomy;\r\n  _bookings = [];\r\n  _services = [];\r\n  _createdAt;\r\n  _updatedAt;\r\n\r\n\r\n  /**\r\n   * Creates a new Vehicle\r\n   * @param {string} manufacturer - manufacturer brand of this vehicle\r\n   * @param {string} model - model of this vehicle\r\n   * @param {number} year - year of this vehicle\r\n   * @param {number} odometerReading - odometer reading of this vehicle\r\n   * @param {string} registrationNumber - registration number of this vehicle\r\n   * @param {number} tankCapacity - tank capacity of this vehicle\r\n   * @param {string} id - ID of this vehicle\r\n   * @param {string} createdAt - timestamp generated when this vehicle is created\r\n   * @param {string|null} updatedAt - timestamp generated when this vehicle is updated\r\n   */\r\n  constructor(manufacturer, model, year, odometerReading, registrationNumber, tankCapacity, id = require('uuid/v4')(), createdAt = moment().format('DD/MM/YYYY hh:mm:ss A'), updatedAt = null) {\r\n\tthis._id = id;\r\n\tthis._manufacturer = manufacturer;\r\n\tthis._model = model;\r\n\tthis._year = year;\r\n\tthis._odometerReading = odometerReading;\r\n\tthis._registrationNumber = registrationNumber;\r\n\tthis._tankCapacity = tankCapacity;\r\n\tthis._fuelEconomy = this.calculateFuelEconomy();\r\n\tthis._createdAt = createdAt;\r\n\tthis._updatedAt = updatedAt;\r\n  }\r\n\r\n  /**\r\n   * Adds a new booking to {@link bookings}\r\n   * @param {Booking} newBooking - new booking to be added to {@link bookings}\r\n   */\r\n  addBooking(newBooking) {\r\n\tthis.bookings.push(newBooking);\r\n\tthis.updateVehicleOdometer();\r\n  }\r\n\r\n  /**\r\n   * Removes a booking from {@link bookings} by its ID\r\n   * @param {string} bookingID - the ID of the booking to be removed\r\n   */\r\n  removeBookingByID(bookingID) {\r\n\tif (bookingID) {\r\n\t  const bookingsCopy = [...this.bookings];\r\n\t  const bookingToBeDeleted = bookingsCopy.find(booking => booking.id === bookingID);\r\n\r\n\t  if (bookingToBeDeleted) {\r\n\t\tthis.bookings = bookingsCopy.filter(booking => booking.id !== bookingToBeDeleted.id);\r\n\t\tthis.updateVehicleOdometer();\r\n\t  }\r\n\t}\r\n  }\r\n\r\n  /**\r\n   * Removes a journey from {@link journeys} by its associated bookingID\r\n   * @param {Journey} journey - the journey to be removed\r\n   * @param {string} bookingID - the ID of the booking that contains the journey to be removed\r\n   */\r\n  removeJourneyByBookingID(journey, bookingID) {\r\n\tthis.bookings.find(b => b.id === bookingID).removeJourney(journey);\r\n\tthis.updateVehicleOdometer();\r\n  }\r\n\r\n  /**\r\n   * Adds a new journey to {@link journeys}\r\n   * @param {Journey} newJourney - the new journey to be added\r\n   */\r\n  addJourney(newJourney) {\r\n\tthis.bookings.find(b => b.id === newJourney.bookingID).addJourney(newJourney);\r\n\tthis.updateVehicleOdometer();\r\n  }\r\n\r\n  /**\r\n   * Adds a new service to {@link services}\r\n   * @param {Service} newService - new service to be added\r\n   */\r\n  addService(newService) {\r\n\tthis.services.push(newService);\r\n  }\r\n\r\n  removeServiceByID(serviceID) {\r\n\tif (serviceID) {\r\n\t  const servicesCopy = [...this.services];\r\n\t  const serviceToBeDeleted = servicesCopy.find(service => service.id === serviceID);\r\n\r\n\t  if (serviceToBeDeleted) {\r\n\t\tthis.services = servicesCopy.filter(service => service.id !== serviceToBeDeleted.id);\r\n\t  }\r\n\t}\r\n  }\r\n\r\n  /**\r\n   * Adds a fuelPurchase to {@link fuelPurchases}\r\n   * @param {FuelPurchase} newFuelPurchase - The new fuel purchase to be added\r\n   */\r\n  addFuelPurchase(newFuelPurchase) {\r\n\tthis.bookings.find(b => b.id === newFuelPurchase.bookingID).addFuelPurchase(newFuelPurchase);\r\n  }\r\n\r\n  /**\r\n   * Removes a fuel purchase based on its bookingID\r\n   * @param {FuelPurchase} fuelPurchase - The fuel purchase to be removed\r\n   * @param {string} bookingID - The ID of the booking associated with this fuel purchase\r\n   */\r\n  removeFuelPurchaseByBookingID(fuelPurchase, bookingID) {\r\n\tthis.bookings.find(b => b.id === bookingID).removeFuelPurchase(fuelPurchase);\r\n  }\r\n\r\n  get bookings() {\r\n\treturn this._bookings;\r\n  }\r\n\r\n  set bookings(value) {\r\n\tthis._bookings = value;\r\n  }\r\n\r\n  get journeys() {\r\n\treturn this._bookings.reduce((journeys, b) => {\r\n\t  b.journeys.forEach(j => {\r\n\t\tjourneys.push(j);\r\n\t  });\r\n\t  return journeys;\r\n\t}, []);\r\n  }\r\n\r\n  get services() {\r\n\treturn this._services;\r\n  }\r\n\r\n  set services(value) {\r\n\tthis._services = value;\r\n  }\r\n\r\n  get fuelPurchases() {\r\n\treturn this._fuelPurchases;\r\n  }\r\n\r\n  set fuelPurchases(value) {\r\n\tthis._fuelPurchases = value;\r\n  }\r\n\r\n  get id() {\r\n\treturn this._id;\r\n  }\r\n\r\n  set id(value) {\r\n\tthis._id = value;\r\n  }\r\n\r\n  get manufacturer() {\r\n\treturn this._manufacturer;\r\n  }\r\n\r\n  set manufacturer(value) {\r\n\tthis._manufacturer = value;\r\n  }\r\n\r\n  get model() {\r\n\treturn this._model;\r\n  }\r\n\r\n  set model(value) {\r\n\tthis._model = value;\r\n  }\r\n\r\n  get year() {\r\n\treturn this._year;\r\n  }\r\n\r\n  set year(value) {\r\n\tthis._year = value;\r\n  }\r\n\r\n  get odometerReading() {\r\n\treturn this._odometerReading;\r\n  }\r\n\r\n  set odometerReading(value) {\r\n\tthis._odometerReading = value;\r\n  }\r\n\r\n  get registrationNumber() {\r\n\treturn this._registrationNumber;\r\n  }\r\n\r\n  set registrationNumber(value) {\r\n\tthis._registrationNumber = value;\r\n  }\r\n\r\n  get tankCapacity() {\r\n\treturn this._tankCapacity;\r\n  }\r\n\r\n  set tankCapacity(value) {\r\n\tthis._tankCapacity = value;\r\n  }\r\n\r\n  get createdAt() {\r\n\treturn this._createdAt;\r\n  }\r\n\r\n  set createdAt(value) {\r\n\tthis._createdAt = value;\r\n  }\r\n\r\n  get updatedAt() {\r\n\treturn this._updatedAt;\r\n  }\r\n\r\n  set updatedAt(value) {\r\n\tthis._updatedAt = value;\r\n  }\r\n\r\n  /**\r\n   * Returns an object that contains all details of this vehicle in a readable format\r\n   * @returns {{Vehicle: string, \"Revenue recorded\": string, \"Kilometers since the last service\": (string), \"Requires service\": (string), \"Total services done\": (number|string), \"Total Kilometers Travelled\": string, \"Fuel economy\": string, \"Registration Number\": (string)}}\r\n   */\r\n  printDetails() {\r\n\treturn ({\r\n\t  'Vehicle': `${this.manufacturer} ${this.model} (${this.year})`,\r\n\t  'Registration Number': this.registrationNumber,\r\n\t  'Total Kilometers Travelled': `${this.odometerReading} km`,\r\n\t  'Total services done': Service.getTotalServicesDone(this.services),\r\n\t  'Revenue recorded': `$ ${Number.parseFloat(this.calculateRevenueRecorded()).toFixed(2)}`,\r\n\t  'Kilometers since the last service': Number.parseFloat(Service.getLastServiceOdometerReading(this.services)) ? `${this.odometerReading - Service.getLastServiceOdometerReading(this.services)} km` : Service.getLastServiceOdometerReading(this.services),\r\n\t  'Fuel economy': `${this.calculateFuelEconomy()}`,\r\n\t  'Requires service': Service.requiresService(this.services) ? 'Yes' : 'No'\r\n\t})\r\n  }\r\n\r\n  /**\r\n   * Calculates total revenue associated with this vehicle based on its bookings\r\n   * @returns {number} totalRevenue - total revenue recorded for this vehicle\r\n   */\r\n  calculateRevenueRecorded() {\r\n\treturn this.bookings.reduce((total, b) => {\r\n\t  if (Number.parseFloat(b.bookingCost)) {\r\n\t\ttotal += b.bookingCost;\r\n\t  }\r\n\t  return total;\r\n\t}, 0);\r\n  }\r\n\r\n  /**\r\n   * Calculates the fuel economy for this vehicle by dividing the total cost of all fuel purchases by\r\n   * the total distance travelled across all recorded journeys\r\n   * @returns {string} fuelEconomy - The fuel economy in a readable format\r\n   */\r\n  calculateFuelEconomy() {\r\n\tconst fuelPurchases =\r\n\t  this.bookings.reduce((fuelPurchases, booking) => {\r\n\t\tfuelPurchases.push(...booking.fuelPurchases);\r\n\t\treturn fuelPurchases;\r\n\t  }, []);\r\n\r\n\tconst totalFuelPurchaseCost = fuelPurchases.reduce((totalCost, fuelPurchase) => {\r\n\t  totalCost += fuelPurchase.fuelPrice * fuelPurchase.fuelQuantity;\r\n\t  return totalCost;\r\n\t}, 0);\r\n\r\n\tconst totalDistanceTravelled = this.calculateTotalDistanceTravelled();\r\n\r\n\tif (Number.isNaN(totalFuelPurchaseCost) || Number.isNaN(totalDistanceTravelled) || !Number.isFinite((totalFuelPurchaseCost / totalDistanceTravelled))) {\r\n\t  return 'Not enough data recorded to calculate fuel economy';\r\n\t}\r\n\tconst fuelEconomy = (totalFuelPurchaseCost / totalDistanceTravelled);\r\n\treturn `${(fuelEconomy * 100).toFixed(2)} L / 100 km`;\r\n  }\r\n\r\n  /**\r\n   * Calculates the total distance travelled by this vehicle for all recorded journeys\r\n   * @returns {number} totalDistance - The total distance travelled\r\n   */\r\n  calculateTotalDistanceTravelled() {\r\n\treturn (\r\n\t  this.bookings.reduce((totalDistance, booking) => {\r\n\t\tbooking.journeys.forEach(j => {\r\n\t\t  totalDistance += j.journeyEndOdometerReading - j.journeyStartOdometerReading\r\n\t\t}, 0);\r\n\t\treturn totalDistance;\r\n\t  }, 0)\r\n\t)\r\n  }\r\n\r\n  /**\r\n   * Updates this vehicle's odometer based on its journeys\r\n   * @param {Function|undefined} callback - runs after the vehicle has been updated on firebase\r\n   * @param {Boolean} updateRemote - if true, also updates the remote database (defaults to true)\r\n   */\r\n  updateVehicleOdometer(callback = undefined, updateRemote = true) {\r\n\tif (this.bookings.length) {\r\n\t  // get all journeys that end today\r\n\t  if (this.bookings.length) {\r\n\t\tconst todaysJourneys = this.bookings.reduce((j, b) => {\r\n\t\t  if (b.journeys.length) {\r\n\t\t\tj.push(...b.journeys.filter(j => moment(j.journeyEndedAt).isSame(moment(), 'days')));\r\n\t\t  }\r\n\t\t  return j;\r\n\t\t}, []);\r\n\r\n\r\n\t\t// get greatest journeyEndOdometerReading for all journeys that end today\r\n\t\tconst greatestEndOdometer = todaysJourneys.reduce((greatestEndOdometer, j) => {\r\n\t\t  return Math.max(greatestEndOdometer, j.journeyEndOdometerReading);\r\n\t\t}, 0);\r\n\r\n\t\t// update odometer reading for this vehicle\r\n\t\tthis.odometerReading = greatestEndOdometer ? greatestEndOdometer : this.odometerReading;\r\n\r\n\t\tif (updateRemote) {\r\n\t\t  // update vehicle on firebase\r\n\t\t  const db = firebase.firestore();\r\n\t\t  db\r\n\t\t\t.collection('vehicles')\r\n\t\t\t.doc(this.id)\r\n\t\t\t.update({\r\n\t\t\t  '_odometerReading': this.odometerReading,\r\n\t\t\t  '_updatedAt': moment().format('DD/MM/YYYY hh:mm:ss a')\r\n\t\t\t})\r\n\t\t\t.then(callback)\r\n\t\t\t.catch(console.dir)\r\n\t\t}\r\n\t  }\r\n\t}\r\n  }\r\n}\r\n","/**\r\n * VehicleForm.js\r\n */\r\nimport React, {useContext, useRef} from 'react';\r\nimport {useHistory} from 'react-router-dom';\r\nimport {Button, Col, Container, Form, Row} from \"react-bootstrap\";\r\nimport {Notification} from \"../Notification/Notification\";\r\nimport {LoadingSpinner} from \"../LoadingSpinner/LoadingSpinner\";\r\nimport {Formik} from \"formik\";\r\nimport moment from \"moment\";\r\nimport {AppContext} from \"../../AppContext/AppContext\";\r\nimport * as yup from \"yup\";\r\n\r\n/**\r\n * Schema to validate VehicleForm\r\n * @type {Schema}\r\n */\r\nconst schema = yup.object().shape({\r\n  manufacturer: yup.string().trim().required('This field is required'),\r\n  model: yup.string().trim().required('This field is required'),\r\n  year: yup\r\n\t.number()\r\n\t.min(moment().subtract(70, 'years').get(\"year\"), 'Too old')\r\n\t.max(\r\n\t  moment()\r\n\t\t.add(1, 'year')\r\n\t\t.get('year'),\r\n\t  'Invalid year'\r\n\t),\r\n  registrationNumber: yup\r\n\t.string()\r\n\t.trim()\r\n\t.length(7, '7 characters are required')\r\n\t.matches(/^[A-Za-z0-9]{7}$/, 'Only letters and numbers are valid')\r\n\t.required('This field is required'),\r\n  odometerReading: yup.number().min(0, 'Invalid reading').required('This field is required'),\r\n  tankCapacity: yup.number().min(0, 'Invalid tank capacity')\r\n});\r\n\r\n/**\r\n * @typedef {Object} VehicleFormProps\r\n * @property {string} type - one of: \"add\" or \"edit\"\r\n * @property {Vehicle} vehicle - the vehicle to be edited, if {@link type} === \"edit\"\r\n * @property {Function} handleSubmit - fired on submission if all form fields are valid\r\n */\r\n/**\r\n * VehicleForm component - provides a form for the user to add or edit a vehicle\r\n * @param {VehicleFormProps} props\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport const VehicleForm = props => {\r\n  const {loading, notification} = useContext(AppContext);\r\n  const history = useHistory();\r\n  const manufacturerInputRef = useRef(null);\r\n  let {vehicle, handleSubmit, type} = props;\r\n\r\n  return (\r\n\t<Container>\r\n\t  {\r\n\t\tnotification && notification.display ?\r\n\t\t  (\r\n\t\t\t<Notification\r\n\t\t\t  display={notification.display}\r\n\t\t\t  message={notification.message}/>\r\n\t\t  ) : ''\r\n\t  }\r\n\t  <Row>\r\n\t\t<Col>\r\n\r\n\t\t\t{\r\n\t\t\t  type === 'add' ?\r\n\t\t\t\t(\r\n\t\t\t\t  <h2 className=\"text-center my-5\">Add a new vehicle</h2>\r\n\t\t\t\t)\r\n\t\t\t\t:\r\n\t\t\t\t(\r\n\t\t\t\t  <h2 className=\"text-center my-5\">\r\n\t\t\t\t\tEdit\r\n\t\t\t\t\tvehicle: {vehicle ? `${vehicle.manufacturer} ${vehicle.model} (${vehicle.year})` : ``}\r\n\t\t\t\t  </h2>\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t</Col>\r\n\t  </Row>\r\n\t  {\r\n\t\tloading ?\r\n\t\t  (\r\n\t\t\t<Row className=\"justify-content-center mt-5\">\r\n\t\t\t  <LoadingSpinner/>\r\n\t\t\t</Row>\r\n\t\t  )\r\n\t\t  :\r\n\t\t  (\r\n\t\t\t<Formik\r\n\t\t\t  validationSchema={schema}\r\n\t\t\t  onSubmit={(values) => handleSubmit(values)}\r\n\t\t\t  initialValues={{\r\n\t\t\t\tmanufacturer: vehicle ? vehicle.manufacturer : ``,\r\n\t\t\t\tmodel: vehicle ? vehicle.model : ``,\r\n\t\t\t\tyear: vehicle ? vehicle.year : ``,\r\n\t\t\t\tregistrationNumber: vehicle ? vehicle.registrationNumber : ``,\r\n\t\t\t\todometerReading: vehicle ? vehicle.odometerReading : ``,\r\n\t\t\t\ttankCapacity: vehicle ? vehicle.tankCapacity : ``\r\n\t\t\t  }}\r\n\t\t\t>\r\n\t\t\t  {({\r\n\t\t\t\t  handleSubmit,\r\n\t\t\t\t  handleChange,\r\n\t\t\t\t  resetForm,\r\n\t\t\t\t  values,\r\n\t\t\t\t  touched,\r\n\t\t\t\t  errors,\r\n\t\t\t\t  isSubmitting\r\n\t\t\t\t}) => (\r\n\t\t\t\t<Form noValidate onSubmit={handleSubmit}>\r\n\t\t\t\t  <Form.Row className=\"mb-lg-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"manufacturer\" lg=\"4\" md=\"12\">\r\n\t\t\t\t\t  <Form.Label>Manufacturer:<span className=\"text-danger\">*</span></Form.Label>\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tref={manufacturerInputRef}\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"manufacturer\"\r\n\t\t\t\t\t\tvalue={values.manufacturer}\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tplaceholder=\"Manufacturer...\"\r\n\t\t\t\t\t\tisInvalid={!!errors.manufacturer}\r\n\t\t\t\t\t\tisValid={touched.manufacturer && !errors.manufacturer}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.manufacturer}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"model\" lg=\"4\" md=\"12\">\r\n\t\t\t\t\t  <Form.Label>Model:<span className=\"text-danger\">*</span></Form.Label>\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"model\"\r\n\t\t\t\t\t\tvalue={values.model}\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tplaceholder=\"Model...\"\r\n\t\t\t\t\t\tisValid={touched.model && !errors.model}\r\n\t\t\t\t\t\tisInvalid={!!errors.model}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.model}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"year\" lg=\"4\" md=\"12\">\r\n\t\t\t\t\t  <Form.Label>Year:</Form.Label>\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"year\"\r\n\t\t\t\t\t\tvalue={values.year}\r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tmin={moment().subtract(60, 'years').get(\"year\")}\r\n\t\t\t\t\t\tmax={moment().add(1, 'year').get(\"year\")}\r\n\t\t\t\t\t\tstep=\"1\"\r\n\t\t\t\t\t\tplaceholder=\"Year...\"\r\n\t\t\t\t\t\tisValid={touched.year && !errors.year}\r\n\t\t\t\t\t\tisInvalid={!!errors.year}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.year}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t  </Form.Row>\r\n\t\t\t\t  <Form.Row className=\"mb-lg-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"registrationNumber\" lg=\"6\" md=\"12\">\r\n\t\t\t\t\t  <Form.Label>Registration Number:<span\r\n\t\t\t\t\t\tclassName=\"text-danger\">*</span></Form.Label>\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"registrationNumber\"\r\n\t\t\t\t\t\tvalue={values.registrationNumber}\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tplaceholder=\"Registration Number...\"\r\n\t\t\t\t\t\tisValid={touched.registrationNumber && !errors.registrationNumber}\r\n\t\t\t\t\t\tisInvalid={!!errors.registrationNumber}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.registrationNumber}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t  </Form.Row>\r\n\r\n\t\t\t\t  <Form.Row className=\"mb-lg-3\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"odometerReading\" lg=\"6\" md=\"12\">\r\n\t\t\t\t\t  <Form.Label>Odometer Reading (in kilometres):<span\r\n\t\t\t\t\t\tclassName=\"text-danger\">*</span></Form.Label>\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"odometerReading\"\r\n\t\t\t\t\t\tvalue={values.odometerReading}\r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tplaceholder=\"Odometer Reading...\"\r\n\t\t\t\t\t\tisValid={touched.odometerReading && !errors.odometerReading}\r\n\t\t\t\t\t\tisInvalid={!!errors.odometerReading}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.odometerReading}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t  </Form.Row>\r\n\r\n\t\t\t\t  <Form.Row className=\"mb-lg-5\">\r\n\t\t\t\t\t<Form.Group as={Col} controlId=\"tankCapacity\" lg=\"6\" md=\"12\">\r\n\t\t\t\t\t  <Form.Label>Tank Capacity (in litres):</Form.Label>\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"tankCapacity\"\r\n\t\t\t\t\t\tvalue={values.tankCapacity}\r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tplaceholder=\"Tank Capacity...\"\r\n\t\t\t\t\t\tisValid={touched.tankCapacity && !errors.tankCapacity}\r\n\t\t\t\t\t\tisInvalid={!!errors.tankCapacity}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.tankCapacity}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Form.Group>\r\n\t\t\t\t  </Form.Row>\r\n\t\t\t\t  <Row className=\"justify-content-center\">\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t  variant=\"primary\"\r\n\t\t\t\t\t  size=\"lg\"\r\n\t\t\t\t\t  type=\"submit\"\r\n\t\t\t\t\t  className=\"mr-5\"\r\n\t\t\t\t\t  disabled={isSubmitting}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t  {\r\n\t\t\t\t\t\ttype === 'add' ? `Add vehicle` : `Edit vehicle`\r\n\t\t\t\t\t  }\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t  variant=\"warning\"\r\n\t\t\t\t\t  size=\"lg\"\r\n\t\t\t\t\t  className=\"mr-5\"\r\n\t\t\t\t\t  onClick={() => {\r\n\t\t\t\t\t\tresetForm();\r\n\t\t\t\t\t\tmanufacturerInputRef.current.focus()\r\n\t\t\t\t\t  }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t  {\r\n\t\t\t\t\t    type === 'add' ? `Clear` : `Restore`\r\n\t\t\t\t\t  }\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t  variant=\"danger\"\r\n\t\t\t\t\t  size=\"lg\"\r\n\t\t\t\t\t  onClick={() => history.push(`/browse`)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t  Cancel\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t  </Row>\r\n\t\t\t\t</Form>\r\n\t\t\t  )}\r\n\t\t\t</Formik>\r\n\t\t  )\r\n\t  }\r\n\t</Container>\r\n  )\r\n};\r\n","/**\r\n * AddVehicle.js\r\n */\r\nimport React, {useContext} from 'react';\r\nimport {useHistory} from 'react-router-dom';\r\nimport {AppContext} from \"../../AppContext/AppContext\";\r\nimport {Vehicle} from \"../../Models/Vehicle\";\r\nimport {VehicleForm} from \"../VehicleForm/VehicleForm\";\r\n\r\n/**\r\n *\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport const AddVehicle = () => {\r\n  const {addResource} = useContext(AppContext);\r\n  const history = useHistory();\r\n\r\n  return (\r\n\t<VehicleForm\r\n\t  type=\"add\"\r\n\t  handleSubmit={values => {\r\n\t\tconst {manufacturer, model, year, odometerReading, registrationNumber, tankCapacity} = values;\r\n\t\tconst vehicleToBeAdded = new Vehicle(manufacturer, model, year, odometerReading, registrationNumber, tankCapacity);\r\n\r\n\t\taddResource('vehicle', vehicleToBeAdded);\r\n\t\thistory.push(`/show/${vehicleToBeAdded.id}`);\r\n\t  }}/>\r\n  )\r\n};\r\n","/**\r\n * EditVehicle.js\r\n */\r\nimport React, {useContext} from 'react';\r\nimport {useHistory, useParams} from 'react-router-dom';\r\nimport {AppContext} from \"../../AppContext/AppContext\";\r\nimport {Vehicle} from \"../../Models/Vehicle\";\r\nimport moment from \"moment\";\r\nimport {VehicleForm} from \"../VehicleForm/VehicleForm\";\r\n\r\nconst cloneDeep = require('lodash.clonedeep');\r\n\r\n/**\r\n * EditVehicle component - renders a form to edit a vehicle\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport const EditVehicle = () => {\r\n  const {vehicles, editVehicle} = useContext(AppContext);\r\n  const history = useHistory();\r\n  const {vehicleID} = useParams();\r\n\r\n  const vehicleToBeEdited = vehicles.find(v => v.id === vehicleID);\r\n  let vehicle = cloneDeep(vehicleToBeEdited);\r\n\r\n  return (\r\n\t<VehicleForm\r\n\t  type=\"edit\"\r\n\t  vehicle={vehicle}\r\n\t  handleSubmit={values => {\r\n\t\tfor (let field in values) {\r\n\t\t  if (vehicle.hasOwnProperty(`_${field}`)) {\r\n\t\t\tvehicle[field] = values[field];\r\n\t\t  }\r\n\t\t}\r\n\t\tvehicle.updatedAt = moment().format('DD/MM/YYYY hh:mm:ss A');\r\n\t\teditVehicle(vehicle);\r\n\t\thistory.push(`/show/${vehicle.id}`);\r\n\t  }}\r\n\t/>\r\n  )\r\n};\r\n","/**\r\n * Booking.js\r\n */\r\nimport moment from \"moment\";\r\nimport {firebase} from \"../Firebase/Firebase\";\r\n\r\n/**\r\n * Booking model class\r\n * @class\r\n */\r\nexport class Booking {\r\n  _id;\r\n  _vehicleID;\r\n  _bookingType;\r\n  _journeys = [];\r\n  _fuelPurchases = [];\r\n  _bookingCost;\r\n  _startDate;\r\n  _endDate;\r\n  _startOdometer;\r\n  _endOdometer;\r\n  _createdAt;\r\n  _updatedAt;\r\n\r\n  /**\r\n   * Creates a new Booking\r\n   * @param {string} vehicleID - ID of the vehicle associated with this booking\r\n   * @param {string} bookingType - one of: \"D\" (per day) or \"K\" (per kilometre)\r\n   * @param {Date|string} startDate - booking start date in the format YYYY-MM-DD\r\n   * @param {Date|string} endDate - booking end date in the format YYYY-MM-DD\r\n   * @param {number} startOdometer - initial odometer reading of the vehicle\r\n   * @param {number|null} endOdometer - final odometer reading of the vehicle\r\n   * @param {number} id - ID of this booking\r\n   * @param {string} createdAt - timestamp generated when this booking is created\r\n   * @param {string|null} updatedAt - timestamp generated when this booking is updated\r\n   */\r\n  constructor(vehicleID, bookingType, startDate, endDate, startOdometer, endOdometer = null, id = require('uuid/v4')(), createdAt = moment().format('DD/MM/YYYY hh:mm:ss A'), updatedAt = null) {\r\n\tthis._id = id;\r\n\tthis._vehicleID = vehicleID;\r\n\tthis._bookingType = bookingType;\r\n\tthis._startDate = startDate;\r\n\tthis._endDate = endDate;\r\n\tthis._startOdometer = startOdometer;\r\n\tthis._endOdometer = endOdometer;\r\n\tthis._createdAt = createdAt;\r\n\tthis._updatedAt = updatedAt;\r\n\tthis._bookingCost = this.calculateBookingCost();\r\n  }\r\n\r\n  get id() {\r\n\treturn this._id;\r\n  }\r\n\r\n  set id(value) {\r\n\tthis._id = value;\r\n  }\r\n\r\n  get vehicleID() {\r\n\treturn this._vehicleID;\r\n  }\r\n\r\n  set vehicleID(value) {\r\n\tthis._vehicleID = value;\r\n  }\r\n\r\n  get bookingType() {\r\n\treturn this._bookingType;\r\n  }\r\n\r\n  set bookingType(value) {\r\n\tthis._bookingType = value;\r\n  }\r\n\r\n  get startDate() {\r\n\treturn this._startDate;\r\n  }\r\n\r\n  set startDate(value) {\r\n\tthis._startDate = value;\r\n  }\r\n\r\n  get endDate() {\r\n\treturn this._endDate;\r\n  }\r\n\r\n  set endDate(value) {\r\n\tthis._endDate = value;\r\n  }\r\n\r\n  get startOdometer() {\r\n\treturn this._startOdometer;\r\n  }\r\n\r\n  set startOdometer(value) {\r\n\tthis._startOdometer = value;\r\n  }\r\n\r\n  get endOdometer() {\r\n\treturn this._endOdometer;\r\n  }\r\n\r\n  set endOdometer(value) {\r\n\tthis._endOdometer = value;\r\n  }\r\n\r\n  get createdAt() {\r\n\treturn this._createdAt;\r\n  }\r\n\r\n  set createdAt(value) {\r\n\tthis._createdAt = value;\r\n  }\r\n\r\n  get updatedAt() {\r\n\treturn this._updatedAt;\r\n  }\r\n\r\n  set updatedAt(value) {\r\n\tthis._updatedAt = value;\r\n  }\r\n\r\n  get journeys() {\r\n\treturn this._journeys;\r\n  }\r\n\r\n  set journeys(value) {\r\n\tthis._journeys = value;\r\n  }\r\n\r\n  get bookingCost() {\r\n\treturn this._bookingCost;\r\n  }\r\n\r\n  set bookingCost(value) {\r\n\tthis._bookingCost = value;\r\n  }\r\n\r\n\r\n  get fuelPurchases() {\r\n\treturn this._fuelPurchases;\r\n  }\r\n\r\n  set fuelPurchases(newFuelPurchases) {\r\n\tthis._fuelPurchases = newFuelPurchases;\r\n  }\r\n\r\n  /**\r\n   * Update endOdometer for this booking if at least one journey has been added\r\n   * @param {Boolean} updateRemote - Provides the option to also update endOdometer in the\r\n   * remote database. Defaults to true.\r\n   * @param {Function|undefined} callback - An optional callback that runs after this booking\r\n   * has been updated on firebase\r\n   */\r\n  updateEndOdometer(callback = undefined, updateRemote = true) {\r\n\tif (this.journeys.length) {\r\n\t  let lastJourney = this.journeys[0];\r\n\t  this.journeys.forEach((j, i) => {\r\n\t\tif (j.journeyEndOdometerReading > lastJourney.journeyEndOdometerReading) {\r\n\t\t  lastJourney = this.journeys[i];\r\n\t\t}\r\n\t  });\r\n\t  this.endOdometer = lastJourney.journeyEndOdometerReading;\r\n\t} else {\r\n\t  this.endOdometer = null;\r\n\t}\r\n\tif (updateRemote) {\r\n\t  // update endOdometer on firebase\r\n\t  const db = firebase.firestore();\r\n\t  db\r\n\t\t.collection('bookings')\r\n\t\t.doc(this.id)\r\n\t\t.update({\r\n\t\t  '_endOdometer': this.endOdometer,\r\n\t\t  '_updatedAt': moment().format('DD/MM/YYYY hh:mm:ss a')\r\n\t\t})\r\n\t\t.then(callback)\r\n\t\t.catch(err => console.dir(err))\r\n\t}\r\n  }\r\n\r\n  /**\r\n   * Adds a new fuel purchase to this booking\r\n   * @param {FuelPurchase} newFuelPurchase - new fuel purchase to be added to this.fuelPurchases\r\n   */\r\n  addFuelPurchase(newFuelPurchase) {\r\n\tthis.fuelPurchases.push(newFuelPurchase);\r\n  }\r\n\r\n  /**\r\n   * Adds a new journey to this booking and updates booking cost\r\n   * @param {Journey} newJourney - new journey to be added to this.journeys\r\n   */\r\n  addJourney(newJourney) {\r\n\tthis.journeys.push(newJourney);\r\n\tthis.updateEndOdometer();\r\n\tthis.bookingCost = this.calculateBookingCost();\r\n  }\r\n\r\n  /**\r\n   * Removes a journey from this.journeys and updated booking cost\r\n   * @param {Journey} journey - the journey to be removed\r\n   */\r\n  removeJourney(journey) {\r\n\tthis.journeys = this.journeys.filter(j => j.id !== journey.id);\r\n\tthis.updateEndOdometer();\r\n\tthis.bookingCost = this.calculateBookingCost();\r\n  }\r\n\r\n  /**\r\n   * Removes a fuel purchase from this.fuelPurchases\r\n   * @param {FuelPurchase} fuelPurchase - the fuel purchase to be removed\r\n   */\r\n  removeFuelPurchase(fuelPurchase) {\r\n\tthis.fuelPurchases = this.fuelPurchases.filter(f => f.id !== fuelPurchase.id);\r\n  }\r\n\r\n  /**\r\n   * Calculates the cost of this booking based on its type and journeys\r\n   * @returns {number} bookingCost - the cost of this booking\r\n   */\r\n  calculateBookingCost() {\r\n\tlet bookingCost = 0;\r\n\tif (this.bookingType === 'D') {\r\n\t  let days = moment(this.endDate).diff(this.startDate, 'days');\r\n\t  if (days === 0) days = 1;\r\n\t  bookingCost = days * 100;\r\n\t} else {\r\n\t  if (this.endOdometer) {\r\n\t\tbookingCost = (this.endOdometer - this.startOdometer);\r\n\t  }\r\n\t}\r\n\treturn bookingCost;\r\n  }\r\n}\r\n","/**\r\n * WarningModal.js\r\n */\r\nimport React from 'react';\r\nimport {Button, Modal} from \"react-bootstrap\";\r\n\r\n/**\r\n * @typedef {Object} WarningModalProps\r\n * @property {boolean} show - determines whether this modal should be rendered\r\n * @property {Function} cancelHandler - sets {@link show} to false\r\n * @property {Function} acceptHandler - fires when the user confirms conflict resolution\r\n * @property {string} header - title of this warning modal\r\n * @property {string} body - body message of this warning modal\r\n * @property {string} accept - text of the accept button\r\n * @property {string} cancel - text of the cancel button\r\n *\r\n */\r\n/**\r\n * WarningModal component - renders a warning modal that allows the user to choose an action\r\n * @param {WarningModalProps} props\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport const WarningModal = props => {\r\n  return (\r\n\t<Modal\r\n\t  show={props.show}\r\n\t  onHide={props.cancelHandler}\r\n\t  size=\"xl\"\r\n\t  aria-labelledby=\"contained-modal-title-vcenter\"\r\n\t  centered\r\n\t>\r\n\t  <Modal.Header closeButton>\r\n\t\t<Modal.Title id=\"contained-modal-title-vcenter\">\r\n\t\t  Warning\r\n\t\t</Modal.Title>\r\n\t  </Modal.Header>\r\n\t  <Modal.Body>\r\n\t\t<h4>{props.header}</h4>\r\n\t\t<p>\r\n\t\t  {props.body}\r\n\t\t</p>\r\n\t  </Modal.Body>\r\n\t  <Modal.Footer>\r\n\t\t<Button\r\n\t\tonClick={props.acceptHandler}\r\n\t\tsize=\"lg\"\r\n\t\tvariant=\"danger\"\r\n\t\t>\r\n\t\t  {props.accept}\r\n\t\t</Button>\r\n\t\t<Button\r\n\t\t  variant=\"info\"\r\n\t\t  size=\"lg\"\r\n\t\t  onClick={props.cancelHandler}>\r\n\t\t  {props.cancel}\r\n\t\t</Button>\r\n\t  </Modal.Footer>\r\n\t</Modal>\r\n  )\r\n};\r\n","/**\r\n * AddBooking.js\r\n */\r\nimport React, {useContext, useEffect, useState} from 'react';\r\nimport {useHistory, useParams} from 'react-router-dom';\r\nimport {Button, Col, Container, Form, Row} from \"react-bootstrap\";\r\nimport {AppContext} from \"../../AppContext/AppContext\";\r\nimport {Notification} from \"../Notification/Notification\";\r\nimport {LoadingSpinner} from \"../LoadingSpinner/LoadingSpinner\";\r\nimport Moment from 'moment';\r\nimport {extendMoment} from 'moment-range';\r\nimport {Booking} from \"../../Models/Booking\";\r\nimport * as yup from \"yup\";\r\nimport {WarningModal} from \"../Modals/WarningModal\";\r\nimport {Formik} from \"formik\";\r\n\r\nconst moment = extendMoment(Moment);\r\nconst cloneDeep = require('lodash.clonedeep');\r\n\r\n/**\r\n * AddBooking component\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport const AddBooking = () => {\r\n  const {loading, notification, vehicles, addResource, deleteResource} = useContext(AppContext);\r\n  const [bookingConflict, setBookingConflict] = useState({status: false, booking: null});\r\n  const [serviceConflict, setServiceConflict] = useState({status: false, service: null});\r\n  const [bookingToBeAdded, setBookingToBeAdded] = useState(null);\r\n  const [addBooking, setAddBooking] = useState(false);\r\n  const {vehicleID} = useParams();\r\n  const history = useHistory();\r\n  const vehicleToBeModified = vehicles.find(v => v.id === vehicleID);\r\n  const vehicle = cloneDeep(vehicleToBeModified);\r\n\r\n  // Defines a schema for the AddBooking form\r\n  const schema = yup.object().shape({\r\n\tbookingType: yup.string().required('This field is required'),\r\n\tstartDate: yup\r\n\t  .date()\r\n\t  .min(moment().subtract(1, 'day'), 'Start date cannot be earlier than today')\r\n\t  .max(moment(moment(), 'YYYY-MM-DD').add(1, 'year'), 'Invalid date')\r\n\t  .required('This field is required'),\r\n\tendDate: yup\r\n\t  .date()\r\n\t  .min(moment().subtract(1, 'day'), 'Invalid date')\r\n\t  .min(yup.ref('startDate'), 'End date cannot be earlier start date')\r\n\t  .max(moment(moment(), 'YYYY-MM-DD').add(1, 'year'), 'Invalid date')\r\n\t  .required('This field is required'),\r\n\tstartOdometer: yup\r\n\t  .number()\r\n\t  .min(vehicle ? vehicle.odometerReading : 0, 'Cannot be lower than current odometer reading')\r\n\t  .required('This field is required')\r\n  });\r\n\r\n  // Deletes a resource from both the context and firebase,\r\n  // then adds a new resource\r\n  const confirmDeleteConflictedResource = (conflictedResourceType, conflictedResource, newResourceType, newResource) => {\r\n\tdeleteResource.confirmDeleteResource(conflictedResourceType, conflictedResource);\r\n\tdeleteResource.setDeleteResourceModalShow(null, null, () => {\r\n\t  addResource(newResourceType, newResource);\r\n\t  history.push(`/show/${vehicle.id}`);\r\n\t});\r\n  };\r\n\r\n  // Detects changes on addBooking\r\n  // Adds a new booking if form is valid and there are no conflicts\r\n  useEffect(() => {\r\n\tif (addBooking && bookingToBeAdded) {\r\n\t  addResource('booking', bookingToBeAdded);\r\n\t  history.push(`/show/${vehicle.id}`);\r\n\t}\r\n  }, [addBooking]);\r\n\r\n  return (\r\n\t<Container>\r\n\t  {\r\n\t\tnotification && notification.display ?\r\n\t\t  (\r\n\t\t\t<Notification\r\n\t\t\t  display={notification.display}\r\n\t\t\t  message={notification.message}/>\r\n\t\t  ) : ''\r\n\t  }\r\n\t  <Row>\r\n\t\t<Col>\r\n\t\t  <h2 className=\"text-center my-5\">Add new booking\r\n\t\t\tfor: {vehicle ? `${vehicle.manufacturer} ${vehicle.model} (${vehicle.year})` : ''}</h2>\r\n\t\t</Col>\r\n\t  </Row>\r\n\t  <WarningModal\r\n\t\tonHide={() => setBookingConflict({status: false})}\r\n\t\tshow={bookingConflict.status}\r\n\t\theader=\"Booking conflict\"\r\n\t\tbody={`New booking could not be added to the system, because there is another booking scheduled between ${bookingConflict.booking ? moment(bookingConflict.booking.startDate, 'YYYY-MM-DD').format('DD/MM/YYYY') : ''} and ${bookingConflict.booking ? moment(bookingConflict.booking.endDate, 'YYYY-MM-DD').format('DD/MM/YYYY') : ''}. Would you like to cancel the other booking and add this one now?`}\r\n\t\taccept=\"Yes, cancel the other booking\"\r\n\t\tcancel=\"No, keep it as it is\"\r\n\t\tacceptHandler={() => {\r\n\t\t  confirmDeleteConflictedResource('booking', bookingConflict.booking, 'booking', bookingToBeAdded);\r\n\t\t}}\r\n\t\tcancelHandler={() => setBookingConflict({status: false})}\r\n\t  />\r\n\t  <WarningModal\r\n\t\tonHide={() => setServiceConflict({status: false})}\r\n\t\tshow={serviceConflict.status}\r\n\t\theader=\"Service conflict\"\r\n\t\tbody={`New booking could not be added to the system, because there is a service scheduled for ${serviceConflict.service ? moment(serviceConflict.service.servicedAt, 'YYYY-MM-DD').format('DD/MM/YYYY') : ''}. Would you like to cancel that service and add this booking?`}\r\n\t\taccept=\"Yes, cancel the service\"\r\n\t\tcancel=\"No, keep it as it is\"\r\n\t\tacceptHandler={() => {\r\n\t\t  confirmDeleteConflictedResource('service', serviceConflict.service, 'booking', bookingToBeAdded);\r\n\t\t}}\r\n\t\tcancelHandler={() => setServiceConflict({status: false})}\r\n\t  />\r\n\t  {\r\n\t\tloading ?\r\n\t\t  (\r\n\t\t\t<Row className=\"justify-content-center mt-5\">\r\n\t\t\t  <LoadingSpinner/>\r\n\t\t\t</Row>\r\n\t\t  )\r\n\t\t  :\r\n\t\t  (\r\n\t\t\t<Formik\r\n\t\t\t  validationSchema={schema}\r\n\t\t\t  onSubmit={(values) => {\r\n\t\t\t\tconst {bookingType, startDate, endDate, startOdometer} = values;\r\n\t\t\t\tconst booking = new Booking(vehicle.id, bookingType, startDate, endDate, startOdometer);\r\n\t\t\t\tsetBookingToBeAdded(booking);\r\n\r\n\t\t\t\t// check booking conflicts\r\n\t\t\t\tif (vehicle.bookings.some(b => {\r\n\t\t\t\t  return moment.range(moment(b.startDate, 'YYYY-MM-DD'), moment(b.endDate, 'YYYY-MM-DD')).overlaps(moment.range(moment(startDate, 'YYYY-MM-DD'), moment(endDate, 'YYYY-MM-DD')))\r\n\t\t\t\t})) {\r\n\t\t\t\t  const bookingConflict = vehicle.bookings.find(b => moment.range(moment(b.startDate, 'YYYY-MM-DD'), moment(b.endDate, 'YYYY-MM-DD')).overlaps(moment.range(moment(startDate, 'YYYY-MM-DD'), moment(endDate, 'YYYY-MM-DD'))));\r\n\t\t\t\t  setBookingConflict({\r\n\t\t\t\t\tstatus: true,\r\n\t\t\t\t\tbooking: bookingConflict\r\n\t\t\t\t  });\r\n\t\t\t\t}\r\n\t\t\t\t// check service conflicts\r\n\t\t\t\telse if (vehicle.services.some(s => moment(s.servicedAt, 'YYYY-MM-DD').within(moment.range(moment(startDate, 'YYYY-MM-DD'), moment(endDate, 'YYYY-MM-DD'))))) {\r\n\r\n\t\t\t\t  const serviceConflict = vehicle.services.find(s => moment(s.servicedAt, 'YYYY-MM-DD').within(moment.range(moment(startDate, 'YYYY-MM-DD'), moment(endDate, 'YYYY-MM-DD'))));\r\n\t\t\t\t  setServiceConflict({\r\n\t\t\t\t\tstatus: true,\r\n\t\t\t\t\tservice: serviceConflict\r\n\t\t\t\t  });\r\n\t\t\t\t} else {\r\n\t\t\t\t  // All good, add new booking\r\n\t\t\t\t  setAddBooking(true);\r\n\t\t\t\t}\r\n\t\t\t  }}\r\n\t\t\t  initialValues={{\r\n\t\t\t\tbookingType: 'D',\r\n\t\t\t\tstartDate: moment(moment(), 'YYYY-MM-DD').format('YYYY-MM-DD'),\r\n\t\t\t\tendDate: moment(moment(), 'YYYY-MM-DD').add(1, 'day').format('YYYY-MM-DD'),\r\n\t\t\t\tstartOdometer: vehicle ? vehicle.odometerReading : 0\r\n\t\t\t  }}\r\n\t\t\t>\r\n\t\t\t  {({\r\n\t\t\t\t  handleSubmit,\r\n\t\t\t\t  handleChange,\r\n\t\t\t\t  resetForm,\r\n\t\t\t\t  values,\r\n\t\t\t\t  touched,\r\n\t\t\t\t  errors,\r\n\t\t\t\t  isSubmitting\r\n\t\t\t\t}) => (\r\n\t\t\t\t<Form\r\n\t\t\t\t  onSubmit={handleSubmit}\r\n\t\t\t\t>\r\n\t\t\t\t  <Form.Group as={Row} controlId=\"bookingType\">\r\n\t\t\t\t\t<Form.Label column=\"true\" sm=\"2\">Booking Type:<span\r\n\t\t\t\t\t  className=\"text-danger\">*</span></Form.Label>\r\n\t\t\t\t\t<Col sm=\"10\">\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tas=\"select\"\r\n\t\t\t\t\t\tname=\"bookingType\"\r\n\t\t\t\t\t\tvalue={values.bookingType}\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tisValid={touched.bookingType && !errors.bookingType}\r\n\t\t\t\t\t\tisInvalid={!!errors.bookingType}\r\n\t\t\t\t\t  >\r\n\t\t\t\t\t\t<option\r\n\t\t\t\t\t\t  value=\"D\">\r\n\t\t\t\t\t\t  Per day\r\n\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t<option\r\n\t\t\t\t\t\t  value=\"K\">\r\n\t\t\t\t\t\t  Per kilometer\r\n\t\t\t\t\t\t</option>\r\n\t\t\t\t\t  </Form.Control>\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.bookingType}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t  </Form.Group>\r\n\t\t\t\t  <Form.Group as={Row} controlId=\"startDate\">\r\n\t\t\t\t\t<Form.Label column=\"true\" sm=\"2\">Start Date:<span\r\n\t\t\t\t\t  className=\"text-danger\">*</span></Form.Label>\r\n\t\t\t\t\t<Col sm=\"10\">\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"startDate\"\r\n\t\t\t\t\t\tvalue={values.startDate}\r\n\t\t\t\t\t\ttype=\"date\"\r\n\t\t\t\t\t\tisInvalid={!!errors.startDate}\r\n\t\t\t\t\t\tisValid={touched.startDate && !errors.startDate}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.startDate}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t  </Form.Group>\r\n\t\t\t\t  <Form.Group as={Row} controlId=\"endDate\">\r\n\t\t\t\t\t<Form.Label column=\"true\" sm=\"2\">End Date:<span\r\n\t\t\t\t\t  className=\"text-danger\">*</span></Form.Label>\r\n\t\t\t\t\t<Col sm=\"10\">\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"endDate\"\r\n\t\t\t\t\t\tvalue={values.endDate}\r\n\t\t\t\t\t\ttype=\"date\"\r\n\t\t\t\t\t\tisInvalid={!!errors.endDate}\r\n\t\t\t\t\t\tisValid={touched.endDate && !errors.endDate}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.endDate}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t  </Form.Group>\r\n\t\t\t\t  <Form.Group as={Row} controlId=\"startOdometer\">\r\n\t\t\t\t\t<Form.Label column=\"true\" sm=\"2\">Start Odometer:<span\r\n\t\t\t\t\t  className=\"text-danger\">*</span></Form.Label>\r\n\t\t\t\t\t<Col sm=\"10\">\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"startOdometer\"\r\n\t\t\t\t\t\tvalue={values.startOdometer}\r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tplaceholder=\"Start odometer...\"\r\n\t\t\t\t\t\tisValid={touched.startOdometer && !errors.startOdometer}\r\n\t\t\t\t\t\tisInvalid={!!errors.startOdometer}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.startOdometer}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t  </Form.Group>\r\n\t\t\t\t  <Row className=\"justify-content-center my-5\">\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t  variant=\"primary\"\r\n\t\t\t\t\t  size=\"lg\"\r\n\t\t\t\t\t  type=\"submit\"\r\n\t\t\t\t\t  className=\"mr-5\"\r\n\t\t\t\t\t  disabled={isSubmitting}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t  Add booking\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t  variant=\"warning\"\r\n\t\t\t\t\t  size=\"lg\"\r\n\t\t\t\t\t  className=\"mr-5\"\r\n\t\t\t\t\t  onClick={resetForm}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t  Clear\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t  variant=\"danger\"\r\n\t\t\t\t\t  size=\"lg\"\r\n\t\t\t\t\t  onClick={() => history.push(`/show/${vehicleID}`)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t  Cancel\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t  </Row>\r\n\t\t\t\t</Form>\r\n\t\t\t  )}\r\n\t\t\t</Formik>\r\n\t\t  )\r\n\t  }\r\n\t</Container>\r\n  )\r\n};\r\n","/**\r\n * AddService.js\r\n */\r\nimport React, {useContext, useEffect, useState} from 'react';\r\nimport {useHistory, useParams} from 'react-router-dom';\r\nimport {AppContext} from \"../../AppContext/AppContext\";\r\nimport {Button, Col, Container, Form, Row} from \"react-bootstrap\";\r\nimport {Notification} from \"../Notification/Notification\";\r\nimport {LoadingSpinner} from \"../LoadingSpinner/LoadingSpinner\";\r\nimport {Service} from \"../../Models/Service\";\r\nimport {Formik} from \"formik\";\r\nimport Moment from \"moment\";\r\nimport {extendMoment} from 'moment-range';\r\nimport * as yup from \"yup\";\r\nimport {WarningModal} from \"../Modals/WarningModal\";\r\n\r\nconst cloneDeep = require('lodash.clonedeep');\r\nconst moment = extendMoment(Moment);\r\n\r\n/**\r\n * AddService component\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport const AddService = () => {\r\n  const {loading, notification, vehicles, addResource, deleteResource} = useContext(AppContext);\r\n  const [bookingConflict, setBookingConflict] = useState({status: false, booking: null});\r\n  const [serviceConflict, setServiceConflict] = useState({status: false, service: null});\r\n  const [serviceToBeAdded, setServiceToBeAdded] = useState(null);\r\n  const [addService, setAddService] = useState(false);\r\n  const {vehicleID} = useParams();\r\n  const history = useHistory();\r\n  const vehicleToBeModified = vehicles.find(v => v.id === vehicleID);\r\n  const vehicle = cloneDeep(vehicleToBeModified);\r\n\r\n  // Deletes a resource from both the context and firebase,\r\n  // then adds a new resource\r\n  const confirmDeleteConflictedResource = (conflictedResourceType, conflictedResource, newResourceType, newResource) => {\r\n\tdeleteResource.confirmDeleteResource(conflictedResourceType, conflictedResource);\r\n\tdeleteResource.setDeleteResourceModalShow(null, null, () => {\r\n\t  addResource(newResourceType, newResource);\r\n\t  history.push(`/show/${vehicle.id}`);\r\n\t});\r\n  };\r\n\r\n  // Defines a schema for the form to add a service\r\n  const schema = yup.object().shape({\r\n\tservicedAt: yup\r\n\t  .date()\r\n\t  .min(moment().subtract(1, 'day'), 'Invalid date')\r\n\t  .required('This field is required'),\r\n\tserviceOdometer: yup\r\n\t  .number()\r\n\t  .min(vehicle ? vehicle.odometerReading : 0,\r\n\t\t'Invalid service odometer')\r\n\t  .required('This field is required')\r\n  });\r\n\r\n  // Detects changes on addService\r\n  // Adds a service if form is valid and there are no conflicts\r\n  useEffect(() => {\r\n\tif (addService && serviceToBeAdded) {\r\n\t  addResource('service', serviceToBeAdded);\r\n\t  history.push(`/show/${vehicle.id}`);\r\n\t}\r\n  }, [addService]);\r\n\r\n  return (\r\n\t<Container>\r\n\t  {\r\n\t\tnotification && notification.display ?\r\n\t\t  (\r\n\t\t\t<Notification\r\n\t\t\t  display={notification.display}\r\n\t\t\t  message={notification.message}/>\r\n\t\t  ) : ''\r\n\t  }\r\n\t  <Row>\r\n\t\t<Col>\r\n\t\t  <h2 className=\"text-center my-5\">Register new service\r\n\t\t\tfor: {vehicle ? `${vehicle.manufacturer} ${vehicle.model} (${vehicle.year})` : ''}</h2>\r\n\t\t</Col>\r\n\t  </Row>\r\n\t  <WarningModal\r\n\t\tonHide={() => setBookingConflict({status: false})}\r\n\t\tshow={bookingConflict.status}\r\n\t\theader=\"Booking conflict\"\r\n\t\tbody={`New service could not be added to the system, because there is a booking scheduled between ${bookingConflict.booking ? moment(bookingConflict.booking.startDate, 'YYYY-MM-DD').format('DD/MM/YYYY') : ''} and ${bookingConflict.booking ? moment(bookingConflict.booking.endDate, 'YYYY-MM-DD').format('DD/MM/YYYY') : ''}. Would you like to cancel the booking and add this service now?`}\r\n\t\taccept=\"Yes, cancel this booking\"\r\n\t\tcancel=\"No, keep it as it is\"\r\n\t\tacceptHandler={() => {\r\n\t\t  confirmDeleteConflictedResource('booking', bookingConflict.booking, 'service', serviceToBeAdded);\r\n\t\t}}\r\n\t\tcancelHandler={() => setBookingConflict({status: false})}\r\n\t  />\r\n\t  <WarningModal\r\n\t\tonHide={() => setServiceConflict({status: false})}\r\n\t\tshow={serviceConflict.status}\r\n\t\theader=\"Service conflict\"\r\n\t\tbody={`New service could not be added to the system, because there is another service also scheduled for ${serviceConflict.service ? moment(serviceConflict.service.servicedAt, 'YYYY-MM-DD').format('DD/MM/YYYY') : ''}. Would you like to cancel that service and add this one instead?`}\r\n\t\taccept=\"Yes, cancel the other service\"\r\n\t\tcancel=\"No, keep it as it is\"\r\n\t\tacceptHandler={() => {\r\n\t\t  confirmDeleteConflictedResource('service', serviceConflict.service, 'service', serviceToBeAdded);\r\n\t\t}}\r\n\t\tcancelHandler={() => setServiceConflict({status: false})}\r\n\t  />\r\n\t  {\r\n\t\tloading ?\r\n\t\t  (\r\n\t\t\t<Row className=\"justify-content-center mt-5\">\r\n\t\t\t  <LoadingSpinner/>\r\n\t\t\t</Row>\r\n\t\t  )\r\n\t\t  :\r\n\t\t  (\r\n\t\t\t<Formik\r\n\t\t\t  validationSchema={schema}\r\n\t\t\t  onSubmit={(values) => {\r\n\t\t\t\tconst {serviceOdometer, servicedAt} = values;\r\n\t\t\t\tconst service = new Service(vehicle.id, serviceOdometer, servicedAt);\r\n\t\t\t\tsetServiceToBeAdded(service);\r\n\r\n\t\t\t\t// check booking conflicts\r\n\t\t\t\tif (vehicle.bookings.some(b => moment(servicedAt, 'YYYY-MM-DD').within(moment.range(b.startDate, b.endDate)))) {\r\n\t\t\t\t  const bookingConflict = vehicle.bookings.find(b => moment(servicedAt, 'YYYY-MM-DD').within(moment.range(b.startDate, b.endDate)));\r\n\t\t\t\t  setBookingConflict({\r\n\t\t\t\t\tstatus: true,\r\n\t\t\t\t\tbooking: bookingConflict\r\n\t\t\t\t  });\r\n\t\t\t\t}\r\n\t\t\t\t// check service conflicts\r\n\t\t\t\telse if (vehicle.services.some(s => moment(s.servicedAt, 'YYYY-MM-DD').isSame(moment(servicedAt, 'YYYY-MM-DD')))) {\r\n\t\t\t\t  const serviceConflict = vehicle.services.find(s => moment(s.servicedAt, 'YYYY-MM-DD').isSame(moment(servicedAt, 'YYYY-MM-DD')));\r\n\t\t\t\t  setServiceConflict({\r\n\t\t\t\t\tstatus: true,\r\n\t\t\t\t\tservice: serviceConflict\r\n\t\t\t\t  });\r\n\t\t\t\t} else {\r\n\t\t\t\t  setAddService(true);\r\n\t\t\t\t}\r\n\t\t\t  }}\r\n\t\t\t  initialValues={{\r\n\t\t\t\tservicedAt: moment(moment(), 'YYYY-MM-DD').format('YYYY-MM-DD'),\r\n\t\t\t\tserviceOdometer: vehicle ? vehicle.odometerReading : 0\r\n\t\t\t  }}\r\n\t\t\t>\r\n\t\t\t  {({\r\n\t\t\t\t  handleSubmit,\r\n\t\t\t\t  handleChange,\r\n\t\t\t\t  resetForm,\r\n\t\t\t\t  values,\r\n\t\t\t\t  touched,\r\n\t\t\t\t  errors,\r\n\t\t\t\t  isSubmitting\r\n\t\t\t\t}) => (\r\n\t\t\t\t<Form noValidate onSubmit={handleSubmit}>\r\n\t\t\t\t  <Form.Group as={Row} controlId=\"servicedAt\">\r\n\t\t\t\t\t<Form.Label column=\"true\" sm=\"2\">Serviced at:<span\r\n\t\t\t\t\t  className=\"text-danger\">*</span></Form.Label>\r\n\t\t\t\t\t<Col sm=\"10\">\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"servicedAt\"\r\n\t\t\t\t\t\tvalue={values.servicedAt}\r\n\t\t\t\t\t\ttype=\"date\"\r\n\t\t\t\t\t\tisInvalid={!!errors.servicedAt}\r\n\t\t\t\t\t\tisValid={touched.servicedAt && !errors.servicedAt}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.servicedAt}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t  </Form.Group>\r\n\r\n\t\t\t\t  <Form.Group as={Row} controlId=\"serviceOdometer\">\r\n\t\t\t\t\t<Form.Label column=\"true\" sm=\"2\">Service odometer:<span\r\n\t\t\t\t\t  className=\"text-danger\">*</span></Form.Label>\r\n\t\t\t\t\t<Col sm=\"10\">\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"serviceOdometer\"\r\n\t\t\t\t\t\tvalue={values.serviceOdometer}\r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tplaceholder=\"Service odometer...\"\r\n\t\t\t\t\t\tisValid={touched.serviceOdometer && !errors.serviceOdometer}\r\n\t\t\t\t\t\tisInvalid={!!errors.serviceOdometer}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.serviceOdometer}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t  </Form.Group>\r\n\r\n\t\t\t\t  <Row className=\"justify-content-center\">\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t  variant=\"primary\"\r\n\t\t\t\t\t  size=\"lg\"\r\n\t\t\t\t\t  type=\"submit\"\r\n\t\t\t\t\t  className=\"mr-5\"\r\n\t\t\t\t\t  disabled={isSubmitting}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t  Add service\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t  variant=\"warning\"\r\n\t\t\t\t\t  size=\"lg\"\r\n\t\t\t\t\t  className=\"mr-5\"\r\n\t\t\t\t\t  onClick={() => {\r\n\t\t\t\t\t\tresetForm();\r\n\t\t\t\t\t  }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t  Clear\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t  variant=\"danger\"\r\n\t\t\t\t\t  size=\"lg\"\r\n\t\t\t\t\t  onClick={() => history.push(`/show/${vehicleID}`)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t  Cancel\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t  </Row>\r\n\t\t\t\t</Form>\r\n\t\t\t  )}\r\n\t\t\t</Formik>\r\n\t\t  )\r\n\t  }\r\n\t</Container>\r\n  )\r\n};\r\n","/**\r\n * AddJourney.js\r\n */\r\nimport React, {useContext} from 'react';\r\nimport {AppConsumer, AppContext} from \"../../AppContext/AppContext\";\r\nimport {Accordion, Button, Card, Col, Container, ListGroup, Row} from \"react-bootstrap\";\r\nimport {Notification} from \"../Notification/Notification\";\r\nimport {LoadingSpinner} from \"../LoadingSpinner/LoadingSpinner\";\r\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\";\r\nimport {faPlus} from \"@fortawesome/free-solid-svg-icons/faPlus\";\r\nimport {Link, useParams, useHistory} from \"react-router-dom\";\r\nconst cloneDeep = require('lodash.clonedeep');\r\n\r\n/**\r\n * AddJourney component - navigates to AddJourneyForm once a booking is selected\r\n */\r\nexport const AddJourney = () => {\r\n  const {vehicles} = useContext(AppContext);\r\n  const {vehicleID} = useParams();\r\n  const vehicle = cloneDeep(vehicles.find(v => v.id === vehicleID));\r\n  const history = useHistory();\r\n\r\n  return (\r\n\t<AppConsumer>\r\n\t  {\r\n\t\t({loading, notification}) => (\r\n\t\t  <Container>\r\n\t\t\t{\r\n\t\t\t  notification.display ?\r\n\t\t\t\t(\r\n\t\t\t\t  <Notification\r\n\t\t\t\t\tdisplay={notification.display}\r\n\t\t\t\t\tmessage={notification.message}/>\r\n\t\t\t\t) : ''\r\n\t\t\t}\r\n\t\t\t<Row>\r\n\t\t\t  <Col>\r\n\t\t\t\t<h2 className=\"text-center my-5\">\r\n\t\t\t\t  Select a booking to add a new journey for {vehicle ?\r\n\t\t\t\t  `${vehicle.manufacturer} ${vehicle.model} (${vehicle.year})`\r\n\t\t\t\t  : ''}\r\n\t\t\t\t</h2>\r\n\t\t\t  </Col>\r\n\t\t\t</Row>\r\n\t\t\t{\r\n\t\t\t  loading ?\r\n\t\t\t\t(\r\n\t\t\t\t  <Row className=\"justify-content-center mt-5\">\r\n\t\t\t\t\t<LoadingSpinner/>\r\n\t\t\t\t  </Row>\r\n\t\t\t\t) :\r\n\t\t\t\t(\r\n\t\t\t\t  <Accordion>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t  vehicle ?\r\n\t\t\t\t\t\t(\r\n\t\t\t\t\t\t  vehicle\r\n\t\t\t\t\t\t\t.bookings\r\n\t\t\t\t\t\t\t.filter(booking => booking.vehicleID === vehicle.id)\r\n\t\t\t\t\t\t\t.sort((booking1, booking2) => {\r\n\t\t\t\t\t\t\t  const booking1StartDate = new Date(booking1.startDate);\r\n\t\t\t\t\t\t\t  const booking2StartDate = new Date(booking2.startDate);\r\n\r\n\t\t\t\t\t\t\t  if (booking1StartDate > booking2StartDate) {\r\n\t\t\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t\t\t  } else if (booking1StartDate < booking2StartDate) {\r\n\t\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t\t  }\r\n\t\t\t\t\t\t\t  return 0;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.map((booking, index) => (\r\n\t\t\t\t\t\t\t  <Card\r\n\t\t\t\t\t\t\t\tdata-testid={`booking-${booking.id}`}\r\n\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\tstyle={{overflow: 'visible'}}\r\n\t\t\t\t\t\t\t  >\r\n\t\t\t\t\t\t\t\t<Card.Header>\r\n\t\t\t\t\t\t\t\t  <Accordion.Toggle\r\n\t\t\t\t\t\t\t\t\tclassName=\"mr-auto\"\r\n\t\t\t\t\t\t\t\t\tas={Button}\r\n\t\t\t\t\t\t\t\t\tvariant=\"link\"\r\n\t\t\t\t\t\t\t\t\teventKey={index}>\r\n\t\t\t\t\t\t\t\t\t{`${new Date(booking.startDate).toLocaleDateString('en-AU')}`}\r\n\t\t\t\t\t\t\t\t  </Accordion.Toggle>\r\n\t\t\t\t\t\t\t\t  <Link to={`/addJourneyForm/${booking.id}`}>\r\n\t\t\t\t\t\t\t\t\t<Button variant=\"outline-success\">\r\n\t\t\t\t\t\t\t\t\t  <FontAwesomeIcon icon={faPlus}/>\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t  </Link>\r\n\t\t\t\t\t\t\t\t</Card.Header>\r\n\t\t\t\t\t\t\t\t<Accordion.Collapse eventKey={index}>\r\n\t\t\t\t\t\t\t\t  <Card.Body>\r\n\t\t\t\t\t\t\t\t\t<ListGroup>\r\n\t\t\t\t\t\t\t\t\t  <ListGroup.Item>\r\n\t\t\t\t\t\t\t\t\t\tStart\r\n\t\t\t\t\t\t\t\t\t\tDate: {`${new Date(booking.startDate).toLocaleDateString('en-AU')}`}\r\n\t\t\t\t\t\t\t\t\t  </ListGroup.Item>\r\n\t\t\t\t\t\t\t\t\t  <ListGroup.Item>\r\n\t\t\t\t\t\t\t\t\t\tEnd\r\n\t\t\t\t\t\t\t\t\t\tDate: {`${new Date(booking.endDate).toLocaleDateString('en-AU')}`}\r\n\t\t\t\t\t\t\t\t\t  </ListGroup.Item>\r\n\t\t\t\t\t\t\t\t\t  <ListGroup.Item>\r\n\t\t\t\t\t\t\t\t\t\tStart Odometer: {booking.startOdometer} km\r\n\t\t\t\t\t\t\t\t\t  </ListGroup.Item>\r\n\t\t\t\t\t\t\t\t\t  <ListGroup.Item>\r\n\t\t\t\t\t\t\t\t\t\tBooking\r\n\t\t\t\t\t\t\t\t\t\tType: {booking.bookingType === 'D' ? 'Per day' : 'Per km'}\r\n\t\t\t\t\t\t\t\t\t  </ListGroup.Item>\r\n\t\t\t\t\t\t\t\t\t</ListGroup>\r\n\t\t\t\t\t\t\t\t  </Card.Body>\r\n\t\t\t\t\t\t\t\t</Accordion.Collapse>\r\n\t\t\t\t\t\t\t  </Card>\r\n\t\t\t\t\t\t\t))\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t: ''\r\n\t\t\t\t\t}\r\n\t\t\t\t  </Accordion>\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\t<Button\r\n\t\t\t  className=\"my-5\"\r\n\t\t\t  style={{\r\n\t\t\t\tposition: 'relative',\r\n\t\t\t\tleft: '50%',\r\n\t\t\t\ttransform: 'translateX(-50%)'\r\n\t\t\t  }}\r\n\t\t\t  variant=\"danger\"\r\n\t\t\t  size=\"lg\"\r\n\t\t\t  onClick={() => history.push(`/show/${vehicle.id}`)}\r\n\t\t\t>\r\n\t\t\t  Cancel\r\n\t\t\t</Button>\r\n\t\t  </Container>\r\n\t\t)\r\n\t  }\r\n\t</AppConsumer>\r\n  )\r\n};\r\n","/**\r\n * Journey.js\r\n */\r\nimport moment from \"moment\";\r\n\r\n/**\r\n * Journey model class\r\n * @class\r\n */\r\nexport class Journey {\r\n  _id;\r\n  _bookingID;\r\n  _journeyStartOdometerReading;\r\n  _journeyEndOdometerReading;\r\n  _journeyStartedAt;\r\n  _journeyEndedAt;\r\n  _journeyFrom;\r\n  _journeyTo;\r\n  _createdAt;\r\n  _updatedAt;\r\n\r\n  /**\r\n   * Creates a new Journey\r\n   * @param {string} bookingID - ID of the booking associated with this journey\r\n   * @param {number} journeyStartOdometerReading - odometer reading at the start of this journey\r\n   * @param {number} journeyEndOdometerReading - odometer reading at the end of this journey\r\n   * @param {Date|string} journeyStartedAt - start date of this journey\r\n   * @param {Date|string} journeyEndedAt - end date of this journey\r\n   * @param {string} journeyFrom - location where the journey started\r\n   * @param {string} journeyTo - location where the journey ended\r\n   * @param {string} id - ID of this journey\r\n   * @param {string} createdAt - timestamp generated when this journey is created\r\n   * @param {string|null} updatedAt - timestamp generated when this journey is updated\r\n   */\r\n  constructor(bookingID, journeyStartOdometerReading, journeyEndOdometerReading, journeyStartedAt, journeyEndedAt, journeyFrom, journeyTo, id = require('uuid/v4')(), createdAt = moment().format('DD/MM/YYYY hh:mm:ss A'), updatedAt = null) {\r\n\tthis._id = id;\r\n\tthis._bookingID = bookingID;\r\n\tthis._journeyStartOdometerReading = journeyStartOdometerReading;\r\n\tthis._journeyEndOdometerReading = journeyEndOdometerReading;\r\n\tthis._journeyStartedAt = journeyStartedAt;\r\n\tthis._journeyEndedAt = journeyEndedAt;\r\n\tthis._journeyFrom = journeyFrom;\r\n\tthis._journeyTo = journeyTo;\r\n\tthis._createdAt = createdAt;\r\n\tthis._updatedAt = updatedAt;\r\n  }\r\n\r\n  get id() {\r\n\treturn this._id;\r\n  }\r\n\r\n  set id(value) {\r\n\tthis._id = value;\r\n  }\r\n\r\n  get bookingID() {\r\n\treturn this._bookingID;\r\n  }\r\n\r\n  set bookingID(value) {\r\n\tthis._bookingID = value;\r\n  }\r\n\r\n  get journeyStartOdometerReading() {\r\n\treturn this._journeyStartOdometerReading;\r\n  }\r\n\r\n  set journeyStartOdometerReading(value) {\r\n\tthis._journeyStartOdometerReading = value;\r\n  }\r\n\r\n  get journeyEndOdometerReading() {\r\n\treturn this._journeyEndOdometerReading;\r\n  }\r\n\r\n  set journeyEndOdometerReading(value) {\r\n\tthis._journeyEndOdometerReading = value;\r\n  }\r\n\r\n  get journeyStartedAt() {\r\n\treturn this._journeyStartedAt;\r\n  }\r\n\r\n  set journeyStartedAt(value) {\r\n\tthis._journeyStartedAt = value;\r\n  }\r\n\r\n  get journeyEndedAt() {\r\n\treturn this._journeyEndedAt;\r\n  }\r\n\r\n  set journeyEndedAt(value) {\r\n\tthis._journeyEndedAt = value;\r\n  }\r\n\r\n  get journeyFrom() {\r\n\treturn this._journeyFrom;\r\n  }\r\n\r\n  set journeyFrom(value) {\r\n\tthis._journeyFrom = value;\r\n  }\r\n\r\n  get journeyTo() {\r\n\treturn this._journeyTo;\r\n  }\r\n\r\n  set journeyTo(value) {\r\n\tthis._journeyTo = value;\r\n  }\r\n\r\n  get createdAt() {\r\n\treturn this._createdAt;\r\n  }\r\n\r\n  set createdAt(value) {\r\n\tthis._createdAt = value;\r\n  }\r\n\r\n  get updatedAt() {\r\n\treturn this._updatedAt;\r\n  }\r\n\r\n  set updatedAt(value) {\r\n\tthis._updatedAt = value;\r\n  }\r\n}\r\n","/**\r\n * AddJourneyForm component\r\n */\r\nimport React, {useContext, useEffect, useState} from 'react';\r\nimport {AppContext} from \"../../AppContext/AppContext\";\r\nimport {useHistory, useParams} from 'react-router-dom';\r\nimport {Notification} from \"../Notification/Notification\";\r\nimport {Button, Col, Container, Form, Row} from \"react-bootstrap\";\r\nimport {LoadingSpinner} from \"../LoadingSpinner/LoadingSpinner\";\r\nimport {Journey} from \"../../Models/Journey\";\r\nimport {extendMoment} from \"moment-range\";\r\nimport Moment from \"moment\";\r\nimport * as yup from \"yup\";\r\nimport {Formik} from \"formik\";\r\n\r\nconst moment = extendMoment(Moment);\r\nconst cloneDeep = require('lodash.clonedeep');\r\n\r\n/**\r\n * AddJourneyForm component\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport const AddJourneyForm = () => {\r\n  const {loading, notification, vehicles, addResource} = useContext(AppContext);\r\n  const [journeyToBeAdded, setJourneyToBeAdded] = useState(null);\r\n  const [addJourney, setAddJourney] = useState(false);\r\n  const {bookingID} = useParams();\r\n  const history = useHistory();\r\n  const vehicleToBeModified = vehicles.find(v => v.bookings.some(b => b.id === bookingID));\r\n  const vehicle = cloneDeep(vehicleToBeModified);\r\n  const booking = vehicle ? vehicle.bookings.find(b => b.id === bookingID) : null;\r\n  const associatedBooking = cloneDeep(booking);\r\n\r\n  // Defines a schema for the form to add a new journey\r\n  const schema = yup.object().shape({\r\n\tjourneyStartOdometerReading: yup\r\n\t  .number()\r\n\t  .min(associatedBooking ? associatedBooking.startOdometer : 0, 'Invalid odometer reading')\r\n\t  .required('This field is required'),\r\n\tjourneyEndOdometerReading: yup\r\n\t  .number()\r\n\t  .min(associatedBooking ? associatedBooking.startOdometer : 0, 'Invalid odometer reading')\r\n\t  .min(\r\n\t\tyup.ref('journeyStartOdometerReading'),\r\n\t\t'Cannot be lower than journey start odometer reading'\r\n\t  )\r\n\t  .required('This field is required'),\r\n\tjourneyStartedAt: yup\r\n\t  .date()\r\n\t  .min(associatedBooking ? moment(associatedBooking.startDate, 'YYYY-MM-DD') : moment(moment(), 'YYYY-MM-DD').format('YYYY-MM-DD'), 'Cannot be earlier than booking start date')\r\n\t  .required('This field is required'),\r\n\tjourneyEndedAt: yup\r\n\t  .date()\r\n\t  .min(associatedBooking ? moment(associatedBooking.startDate, 'YYYY-MM-DD') : moment(moment(), 'YYYY-MM-DD').format('YYYY-MM-DD'), 'Cannot be earlier than booking start date')\r\n\t  .min(yup.ref('journeyStartedAt'), 'Cannot be earlier than journey start date')\r\n\t  .max(associatedBooking ? moment(associatedBooking.endDate, 'YYYY-MM-DD') : moment(moment(), 'YYYY-MM-DD').format('YYYY-MM-DD'), 'Cannot be later than booking end date')\r\n\t  .required('This field is required'),\r\n\tjourneyFrom: yup\r\n\t  .string(),\r\n\tjourneyTo: yup\r\n\t  .string()\r\n  });\r\n\r\n  // Detects changes on addJourney\r\n  // Adds a new journey if form is valid\r\n  useEffect(() => {\r\n\tif (addJourney && journeyToBeAdded) {\r\n\t  addResource('journey', journeyToBeAdded);\r\n\t  history.push(`/show/${vehicle.id}`);\r\n\t}\r\n  }, [addJourney]);\r\n\r\n  return (\r\n\t<Container>\r\n\t  {\r\n\t\tnotification && notification.display ?\r\n\t\t  (\r\n\t\t\t<Notification\r\n\t\t\t  display={notification.display}\r\n\t\t\t  message={notification.message}/>\r\n\t\t  ) : ''\r\n\t  }\r\n\t  <Row>\r\n\t\t<Col>\r\n\t\t  <h2 className=\"text-center my-5\">Add new journey\r\n\t\t\tfor {vehicle ? `${vehicle.manufacturer} ${vehicle.model} (${vehicle.year})` : ''},\r\n\t\t\tbooked\r\n\t\t\tfor: {associatedBooking ? `${moment(associatedBooking.startDate, 'YYYY-MM-DD').format('DD/MM/YYYY')}` : ''} - {associatedBooking ? `${moment(associatedBooking.endDate, 'YYYY-MM-DD').format('DD/MM/YYYY')}` : ''}</h2>\r\n\t\t</Col>\r\n\t  </Row>\r\n\t  {\r\n\t\tloading ?\r\n\t\t  (\r\n\t\t\t<Row className=\"justify-content-center mt-5\">\r\n\t\t\t  <LoadingSpinner/>\r\n\t\t\t</Row>\r\n\t\t  )\r\n\t\t  :\r\n\t\t  (\r\n\t\t\t<Formik\r\n\t\t\t  validationSchema={schema}\r\n\t\t\t  onSubmit={(values) => {\r\n\t\t\t\tconst {journeyStartOdometerReading, journeyEndOdometerReading, journeyStartedAt, journeyEndedAt, journeyFrom, journeyTo} = values;\r\n\t\t\t\tconst journey = new Journey(bookingID, journeyStartOdometerReading, journeyEndOdometerReading, journeyStartedAt, journeyEndedAt, journeyFrom, journeyTo);\r\n\t\t\t\tsetJourneyToBeAdded(journey);\r\n\t\t\t\tsetAddJourney(true);\r\n\t\t\t  }}\r\n\t\t\t  initialValues={{\r\n\t\t\t\tjourneyStartOdometerReading: associatedBooking ? associatedBooking.startOdometer : 0,\r\n\t\t\t\tjourneyEndOdometerReading: associatedBooking ? associatedBooking.startOdometer : 0,\r\n\t\t\t\tjourneyStartedAt: associatedBooking ? associatedBooking.startDate : moment(moment(), 'YYYY-MM-DD').format('YYYY-MM-DD'),\r\n\t\t\t\tjourneyEndedAt: associatedBooking ? associatedBooking.startDate : moment(moment(), 'YYYY-MM-DD').format('YYYY-MM-DD'),\r\n\t\t\t\tjourneyFrom: '',\r\n\t\t\t\tjourneyTo: ''\r\n\t\t\t  }}\r\n\t\t\t>\r\n\t\t\t  {({\r\n\t\t\t\t  handleSubmit,\r\n\t\t\t\t  handleChange,\r\n\t\t\t\t  resetForm,\r\n\t\t\t\t  values,\r\n\t\t\t\t  touched,\r\n\t\t\t\t  errors,\r\n\t\t\t\t  isSubmitting\r\n\t\t\t\t}) => (\r\n\t\t\t\t<Form\r\n\t\t\t\t  onSubmit={handleSubmit}\r\n\t\t\t\t>\r\n\t\t\t\t  <Form.Group as={Row} controlId=\"journeyStartedAt\">\r\n\t\t\t\t\t<Form.Label column=\"true\" sm=\"2\">Journey started at:<span\r\n\t\t\t\t\t  className=\"text-danger\">*</span></Form.Label>\r\n\t\t\t\t\t<Col sm=\"10\">\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"journeyStartedAt\"\r\n\t\t\t\t\t\tvalue={values.journeyStartedAt}\r\n\t\t\t\t\t\ttype=\"date\"\r\n\t\t\t\t\t\tisValid={touched.journeyStartedAt && !errors.journeyStartedAt}\r\n\t\t\t\t\t\tisInvalid={!!errors.journeyStartedAt}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.journeyStartedAt}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t  </Form.Group>\r\n\t\t\t\t  <Form.Group as={Row} controlId=\"journeyEndedAt\">\r\n\t\t\t\t\t<Form.Label column=\"true\" sm=\"2\">Journey ended at:<span\r\n\t\t\t\t\t  className=\"text-danger\">*</span></Form.Label>\r\n\t\t\t\t\t<Col sm=\"10\">\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"journeyEndedAt\"\r\n\t\t\t\t\t\tvalue={values.journeyEndedAt}\r\n\t\t\t\t\t\ttype=\"date\"\r\n\t\t\t\t\t\tisValid={touched.journeyEndedAt && !errors.journeyEndedAt}\r\n\t\t\t\t\t\tisInvalid={!!errors.journeyEndedAt}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.journeyEndedAt}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t  </Form.Group>\r\n\t\t\t\t  <Form.Group as={Row} controlId=\"journeyStartOdometerReading\">\r\n\t\t\t\t\t<Form.Label column=\"true\" sm=\"2\">Journey start odometer reading:<span\r\n\t\t\t\t\t  className=\"text-danger\">*</span></Form.Label>\r\n\t\t\t\t\t<Col sm=\"10\">\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"journeyStartOdometerReading\"\r\n\t\t\t\t\t\tvalue={values.journeyStartOdometerReading}\r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tplaceholder=\"Journey start odometer reading...\"\r\n\t\t\t\t\t\tisValid={touched.journeyStartOdometerReading && !errors.journeyStartOdometerReading}\r\n\t\t\t\t\t\tisInvalid={!!errors.journeyStartOdometerReading}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.journeyStartOdometerReading}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t  </Form.Group>\r\n\t\t\t\t  <Form.Group as={Row} controlId=\"journeyEndOdometerReading\">\r\n\t\t\t\t\t<Form.Label column=\"true\" sm=\"2\">Journey end odometer reading:<span\r\n\t\t\t\t\t  className=\"text-danger\">*</span></Form.Label>\r\n\t\t\t\t\t<Col sm=\"10\">\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"journeyEndOdometerReading\"\r\n\t\t\t\t\t\tvalue={values.journeyEndOdometerReading}\r\n\t\t\t\t\t\tplaceholder=\"Journey end odometer reading...\"\r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tisValid={touched.journeyEndOdometerReading && !errors.journeyEndOdometerReading}\r\n\t\t\t\t\t\tisInvalid={!!errors.journeyEndOdometerReading}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.journeyEndOdometerReading}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t  </Form.Group>\r\n\t\t\t\t  <Form.Group as={Row} controlId=\"journeyFrom\">\r\n\t\t\t\t\t<Form.Label column=\"true\" sm=\"2\">Journey from:</Form.Label>\r\n\t\t\t\t\t<Col sm=\"10\">\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"journeyFrom\"\r\n\t\t\t\t\t\tvalue={values.journeyFrom}\r\n\t\t\t\t\t\tplaceholder=\"Journey from...\"\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tisValid={touched.journeyFrom && !errors.journeyFrom}\r\n\t\t\t\t\t\tisInvalid={!!errors.journeyFrom}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.journeyFrom}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t  </Form.Group>\r\n\t\t\t\t  <Form.Group as={Row} controlId=\"journeyTo\">\r\n\t\t\t\t\t<Form.Label column=\"true\" sm=\"2\">Journey to:</Form.Label>\r\n\t\t\t\t\t<Col sm=\"10\">\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"journeyTo\"\r\n\t\t\t\t\t\tvalue={values.journeyTo}\r\n\t\t\t\t\t\tplaceholder=\"Journey to...\"\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tisValid={touched.journeyTo && !errors.journeyTo}\r\n\t\t\t\t\t\tisInvalid={!!errors.journeyTo}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.journeyTo}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t  </Form.Group>\r\n\t\t\t\t  <Row className=\"justify-content-center my-5\">\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t  variant=\"primary\"\r\n\t\t\t\t\t  size=\"lg\"\r\n\t\t\t\t\t  type=\"submit\"\r\n\t\t\t\t\t  className=\"mr-5\"\r\n\t\t\t\t\t  disabled={isSubmitting}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t  Add journey\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t  variant=\"warning\"\r\n\t\t\t\t\t  size=\"lg\"\r\n\t\t\t\t\t  className=\"mr-5\"\r\n\t\t\t\t\t  onClick={resetForm}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t  Clear\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t  variant=\"danger\"\r\n\t\t\t\t\t  size=\"lg\"\r\n\t\t\t\t\t  onClick={() => history.push(`/show/${vehicle.id}`)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t  Cancel\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t  </Row>\r\n\t\t\t\t</Form>\r\n\t\t\t  )}\r\n\t\t\t</Formik>\r\n\t\t  )\r\n\t  }\r\n\t</Container>\r\n  )\r\n};\r\n","/**\r\n * AddFuelPurchase.js\r\n */\r\nimport React, {useContext} from 'react';\r\nimport {AppConsumer, AppContext} from \"../../AppContext/AppContext\";\r\nimport {Notification} from \"../Notification/Notification\";\r\nimport {Accordion, Button, Card, Col, Container, ListGroup, Row} from \"react-bootstrap\";\r\nimport {LoadingSpinner} from \"../LoadingSpinner/LoadingSpinner\";\r\nimport {Link, useHistory, useParams} from \"react-router-dom\";\r\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\";\r\nimport {faPlus} from \"@fortawesome/free-solid-svg-icons/faPlus\";\r\n\r\nconst cloneDeep = require('lodash.clonedeep');\r\n\r\n/**\r\n * AddFuelPurchase component - navigates to AddFuelPurchaseForm once a booking is selected\r\n */\r\nexport const AddFuelPurchase = () => {\r\n  const {vehicles} = useContext(AppContext);\r\n  const {vehicleID} = useParams();\r\n  const vehicle = cloneDeep(vehicles.find(v => v.id === vehicleID));\r\n  const history = useHistory();\r\n\r\n  return (\r\n\t<AppConsumer>\r\n\t  {\r\n\t\t({loading, notification}) => (\r\n\t\t  <Container>\r\n\t\t\t{\r\n\t\t\t  notification.display ?\r\n\t\t\t\t(\r\n\t\t\t\t  <Notification\r\n\t\t\t\t\tdisplay={notification.display}\r\n\t\t\t\t\tmessage={notification.message}/>\r\n\t\t\t\t) : ''\r\n\t\t\t}\r\n\t\t\t<Row>\r\n\t\t\t  <Col>\r\n\t\t\t\t<h2 className=\"text-center my-5\">\r\n\t\t\t\t  Select a booking to register a new fuel purchase for {vehicle ?\r\n\t\t\t\t  `${vehicle.manufacturer} ${vehicle.model} (${vehicle.year})`\r\n\t\t\t\t  : ''}\r\n\t\t\t\t</h2>\r\n\t\t\t  </Col>\r\n\t\t\t</Row>\r\n\t\t\t{\r\n\t\t\t  loading ?\r\n\t\t\t\t(\r\n\t\t\t\t  <Row className=\"justify-content-center mt-5\">\r\n\t\t\t\t\t<LoadingSpinner/>\r\n\t\t\t\t  </Row>\r\n\t\t\t\t) :\r\n\t\t\t\t(\r\n\t\t\t\t  <Accordion>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t  vehicle ?\r\n\t\t\t\t\t\t(\r\n\t\t\t\t\t\t  vehicle\r\n\t\t\t\t\t\t\t.bookings\r\n\t\t\t\t\t\t\t.filter(booking => booking.vehicleID === vehicle.id)\r\n\t\t\t\t\t\t\t.sort((booking1, booking2) => {\r\n\t\t\t\t\t\t\t  const booking1StartDate = new Date(booking1.startDate);\r\n\t\t\t\t\t\t\t  const booking2StartDate = new Date(booking2.startDate);\r\n\r\n\t\t\t\t\t\t\t  if (booking1StartDate > booking2StartDate) {\r\n\t\t\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t\t\t  } else if (booking1StartDate < booking2StartDate) {\r\n\t\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t\t  }\r\n\t\t\t\t\t\t\t  return 0;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.map((booking, index) => (\r\n\t\t\t\t\t\t\t  <Card\r\n\t\t\t\t\t\t\t\tdata-testid={`booking-${booking.id}`}\r\n\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\tstyle={{overflow: 'visible'}}>\r\n\t\t\t\t\t\t\t\t<Card.Header>\r\n\t\t\t\t\t\t\t\t  <Accordion.Toggle\r\n\t\t\t\t\t\t\t\t\tclassName=\"mr-auto\"\r\n\t\t\t\t\t\t\t\t\tas={Button}\r\n\t\t\t\t\t\t\t\t\tvariant=\"link\"\r\n\t\t\t\t\t\t\t\t\teventKey={index}>\r\n\t\t\t\t\t\t\t\t\t{`${new Date(booking.startDate).toLocaleDateString('en-AU')}`}\r\n\t\t\t\t\t\t\t\t  </Accordion.Toggle>\r\n\t\t\t\t\t\t\t\t  <Link to={`/addFuelPurchaseForm/${booking.id}`}>\r\n\t\t\t\t\t\t\t\t\t<Button variant=\"outline-success\">\r\n\t\t\t\t\t\t\t\t\t  <FontAwesomeIcon icon={faPlus}/>\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t  </Link>\r\n\t\t\t\t\t\t\t\t</Card.Header>\r\n\t\t\t\t\t\t\t\t<Accordion.Collapse eventKey={index}>\r\n\t\t\t\t\t\t\t\t  <Card.Body>\r\n\t\t\t\t\t\t\t\t\t<ListGroup>\r\n\t\t\t\t\t\t\t\t\t  <ListGroup.Item>\r\n\t\t\t\t\t\t\t\t\t\tStart\r\n\t\t\t\t\t\t\t\t\t\tDate: {`${new Date(booking.startDate).toLocaleDateString('en-AU')}`}\r\n\t\t\t\t\t\t\t\t\t  </ListGroup.Item>\r\n\t\t\t\t\t\t\t\t\t  <ListGroup.Item>\r\n\t\t\t\t\t\t\t\t\t\tEnd\r\n\t\t\t\t\t\t\t\t\t\tDate: {`${new Date(booking.endDate).toLocaleDateString('en-AU')}`}\r\n\t\t\t\t\t\t\t\t\t  </ListGroup.Item>\r\n\t\t\t\t\t\t\t\t\t  <ListGroup.Item>\r\n\t\t\t\t\t\t\t\t\t\tStart Odometer: {booking.startOdometer} km\r\n\t\t\t\t\t\t\t\t\t  </ListGroup.Item>\r\n\t\t\t\t\t\t\t\t\t  <ListGroup.Item>\r\n\t\t\t\t\t\t\t\t\t\tBooking\r\n\t\t\t\t\t\t\t\t\t\tType: {booking.bookingType === 'D' ? 'Per day' : 'Per km'}\r\n\t\t\t\t\t\t\t\t\t  </ListGroup.Item>\r\n\t\t\t\t\t\t\t\t\t</ListGroup>\r\n\t\t\t\t\t\t\t\t  </Card.Body>\r\n\t\t\t\t\t\t\t\t</Accordion.Collapse>\r\n\t\t\t\t\t\t\t  </Card>\r\n\t\t\t\t\t\t\t))\r\n\t\t\t\t\t\t) : ''\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t  </Accordion>\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\t<Button\r\n\t\t\t  className=\"my-5\"\r\n\t\t\t  style={{\r\n\t\t\t\tposition: 'relative',\r\n\t\t\t\tleft: '50%',\r\n\t\t\t\ttransform: 'translateX(-50%)'\r\n\t\t\t  }}\r\n\t\t\t  variant=\"danger\"\r\n\t\t\t  size=\"lg\"\r\n\t\t\t  onClick={() => history.push(`/show/${vehicle.id}`)}\r\n\t\t\t>\r\n\t\t\t  Cancel\r\n\t\t\t</Button>\r\n\t\t  </Container>\r\n\t\t)\r\n\t  }\r\n\t</AppConsumer>\r\n  )\r\n};\r\n","/**\r\n * FuelPurchase.js\r\n */\r\nimport moment from \"moment\";\r\n\r\n/**\r\n * FuelPurchase model class\r\n * @class FuelPurchase\r\n */\r\nexport class FuelPurchase {\r\n  _id;\r\n  _bookingID;\r\n  _createdAt;\r\n  _fuelPrice;\r\n  _fuelQuantity;\r\n  _updatedAt;\r\n\r\n  /**\r\n   * Creates a new FuelPurchase\r\n   * @param {string} bookingID - ID of the booking associated with this fuel purchase\r\n   * @param {number} fuelQuantity - amount of fuel of this purchase (in litres)\r\n   * @param {number} fuelPrice - price per litre of this fuel purchase\r\n   * @param {string} id - ID of this fuel purchase\r\n   * @param {string} createdAt - timestamp generated when this fuel purchase is created\r\n   * @param {string|null} updatedAt - timestamp generated when this fuel purchase is updated\r\n   */\r\n  constructor(bookingID, fuelQuantity, fuelPrice, id = require('uuid/v4')(), createdAt = moment().format('DD/MM/YYYY hh:mm:ss A'), updatedAt = null) {\r\n    this._id = id;\r\n    this._bookingID = bookingID;\r\n    this._fuelPrice = fuelPrice;\r\n    this._fuelQuantity = fuelQuantity;\r\n    this._createdAt = createdAt;\r\n    this._updatedAt = updatedAt;\r\n  }\r\n\r\n  get id() {\r\n    return this._id;\r\n  }\r\n\r\n  set id(value) {\r\n    this._id = value;\r\n  }\r\n\r\n  get bookingID() {\r\n    return this._bookingID;\r\n  }\r\n\r\n  set bookingID(value) {\r\n    this._bookingID = value;\r\n  }\r\n\r\n  get fuelQuantity() {\r\n    return this._fuelQuantity;\r\n  }\r\n\r\n  set fuelQuantity(value) {\r\n    this._fuelQuantity = value;\r\n  }\r\n\r\n  get fuelPrice() {\r\n    return this._fuelPrice;\r\n  }\r\n\r\n  set fuelPrice(value) {\r\n    this._fuelPrice = value;\r\n  }\r\n\r\n  get createdAt() {\r\n    return this._createdAt;\r\n  }\r\n\r\n  set createdAt(value) {\r\n    this._createdAt = value;\r\n  }\r\n\r\n  get updatedAt() {\r\n    return this._updatedAt;\r\n  }\r\n\r\n  set updatedAt(value) {\r\n    this._updatedAt = value;\r\n  }\r\n}\r\n","/**\r\n * AddFuelPurchaseForm.js\r\n */\r\nimport React, {useContext, useEffect, useState} from 'react';\r\nimport {useHistory, useParams} from 'react-router-dom';\r\nimport {AppContext} from \"../../AppContext/AppContext\";\r\nimport {Notification} from \"../Notification/Notification\";\r\nimport {Button, Col, Container, Form, Row} from \"react-bootstrap\";\r\nimport {LoadingSpinner} from \"../LoadingSpinner/LoadingSpinner\";\r\nimport {FuelPurchase} from \"../../Models/FuelPurchase\";\r\nimport Moment from 'moment';\r\nimport * as yup from \"yup\";\r\nimport {Formik} from \"formik\";\r\n\r\nconst moment = require('moment-range').extendMoment(Moment);\r\nconst cloneDeep = require('lodash.clonedeep');\r\n\r\n/**\r\n * AddFuelPurchaseForm component\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport const AddFuelPurchaseForm = () => {\r\n  const {loading, notification, vehicles, addResource} = useContext(AppContext);\r\n  const [fuelPurchaseToBeAdded, setFuelPurchaseToBeAdded] = useState(null);\r\n  const [addFuelPurchase, setAddFuelPurchase] = useState(false);\r\n  const {bookingID} = useParams();\r\n  const history = useHistory();\r\n  const vehicleToBeModified = vehicles.find(v => v.bookings.some(b => b.id === bookingID));\r\n  const vehicle = cloneDeep(vehicleToBeModified);\r\n  const booking = vehicle ? vehicle.bookings.find(b => b.id === bookingID) : null;\r\n  const associatedBooking = cloneDeep(booking);\r\n\r\n  // Defines a schema for the form to add a new fuel purchase\r\n  const schema = yup.object().shape({\r\n\tfuelQuantity: yup\r\n\t  .number()\r\n\t  .moreThan(0, 'Invalid fuel quantity')\r\n\t  .max(\r\n\t\tvehicle ?\r\n\t\t  vehicle.tankCapacity : 0,\r\n\t\t'Cannot be greater than the tank capacity of this vehicle'\r\n\t  )\r\n\t  .required('This field is required'),\r\n\tfuelPrice: yup\r\n\t  .number()\r\n\t  .moreThan(0, 'Invalid price')\r\n\t  .required('This field  is required')\r\n  });\r\n\r\n  // Detects changes on addFuelPurchase\r\n  // Adds a new fuel purchase if form is valid\r\n  useEffect(() => {\r\n\tif (addFuelPurchase && fuelPurchaseToBeAdded) {\r\n\t  addResource('fuel purchase', fuelPurchaseToBeAdded);\r\n\t  history.push(`/show/${vehicle.id}`);\r\n\t}\r\n  }, [addFuelPurchase]);\r\n\r\n  return (\r\n\t<Container>\r\n\t  {\r\n\t\tnotification && notification.display ?\r\n\t\t  (\r\n\t\t\t<Notification\r\n\t\t\t  display={notification.display}\r\n\t\t\t  message={notification.message}/>\r\n\t\t  ) : ''\r\n\t  }\r\n\t  <Row>\r\n\t\t<Col>\r\n\t\t  <h2 className=\"text-center my-5\">Register new fuel purchase\r\n\t\t\tfor {vehicle ? `${vehicle.manufacturer} ${vehicle.model} (${vehicle.year})` : ''},\r\n\t\t\tbooked\r\n\t\t\tfor: {associatedBooking ? `${moment(associatedBooking.startDate, 'YYYY-MM-DD').format('DD/MM/YYYY')}` : ''} - {associatedBooking ? `${moment(associatedBooking.endDate, 'YYYY-MM-DD').format('DD/MM/YYYY')}` : ''}</h2>\r\n\t\t</Col>\r\n\t  </Row>\r\n\t  {\r\n\t\tloading ?\r\n\t\t  (\r\n\t\t\t<Row className=\"justify-content-center mt-5\">\r\n\t\t\t  <LoadingSpinner/>\r\n\t\t\t</Row>\r\n\t\t  )\r\n\t\t  :\r\n\t\t  (\r\n\t\t\t<Formik\r\n\t\t\t  validationSchema={schema}\r\n\t\t\t  onSubmit={(values) => {\r\n\t\t\t\tconst {fuelQuantity, fuelPrice} = values;\r\n\t\t\t\tconst fuelPurchase = new FuelPurchase(bookingID, fuelQuantity, fuelPrice);\r\n\t\t\t\tsetFuelPurchaseToBeAdded(fuelPurchase);\r\n\t\t\t\tsetAddFuelPurchase(true);\r\n\t\t\t  }}\r\n\t\t\t  initialValues={{\r\n\t\t\t\tfuelQuantity: vehicle ? vehicle.tankCapacity : '',\r\n\t\t\t\tfuelPrice: ''\r\n\t\t\t  }}\r\n\t\t\t>\r\n\t\t\t  {({\r\n\t\t\t\t  handleSubmit,\r\n\t\t\t\t  handleChange,\r\n\t\t\t\t  resetForm,\r\n\t\t\t\t  values,\r\n\t\t\t\t  touched,\r\n\t\t\t\t  errors,\r\n\t\t\t\t  isSubmitting\r\n\t\t\t\t}) => (\r\n\t\t\t\t<Form\r\n\t\t\t\t  onSubmit={handleSubmit}\r\n\t\t\t\t>\r\n\t\t\t\t  <Form.Group as={Row} controlId=\"fuelQuantity\">\r\n\t\t\t\t\t<Form.Label column=\"true\" sm=\"2\">Fuel quantity:<span\r\n\t\t\t\t\t  className=\"text-danger\">*</span></Form.Label>\r\n\t\t\t\t\t<Col sm=\"10\">\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"fuelQuantity\"\r\n\t\t\t\t\t\tvalue={values.fuelQuantity}\r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tplaceholder=\"Fuel quantity (L)...\"\r\n\t\t\t\t\t\tisValid={touched.fuelQuantity && !errors.fuelQuantity}\r\n\t\t\t\t\t\tisInvalid={!!errors.fuelQuantity}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.fuelQuantity}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t  </Form.Group>\r\n\t\t\t\t  <Form.Group as={Row} controlId=\"fuelPrice\">\r\n\t\t\t\t\t<Form.Label column=\"true\" sm=\"2\">Fuel price per litre:<span\r\n\t\t\t\t\t  className=\"text-danger\">*</span></Form.Label>\r\n\t\t\t\t\t<Col sm=\"10\">\r\n\t\t\t\t\t  <Form.Control\r\n\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\tname=\"fuelPrice\"\r\n\t\t\t\t\t\tvalue={values.fuelPrice}\r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tplaceholder=\"Fuel price ($ / L)...\"\r\n\t\t\t\t\t\tisValid={touched.fuelPrice && !errors.fuelPrice}\r\n\t\t\t\t\t\tisInvalid={!!errors.fuelPrice}\r\n\t\t\t\t\t  />\r\n\t\t\t\t\t  <Form.Control.Feedback type=\"invalid\">\r\n\t\t\t\t\t\t{errors.fuelPrice}\r\n\t\t\t\t\t  </Form.Control.Feedback>\r\n\t\t\t\t\t</Col>\r\n\t\t\t\t  </Form.Group>\r\n\t\t\t\t  <Row className=\"justify-content-center my-5\">\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t  variant=\"primary\"\r\n\t\t\t\t\t  size=\"lg\"\r\n\t\t\t\t\t  type=\"submit\"\r\n\t\t\t\t\t  className=\"mr-5\"\r\n\t\t\t\t\t  disabled={isSubmitting}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t  Add fuel purchase\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t  variant=\"warning\"\r\n\t\t\t\t\t  size=\"lg\"\r\n\t\t\t\t\t  className=\"mr-5\"\r\n\t\t\t\t\t  onClick={resetForm}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t  Clear\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t  variant=\"danger\"\r\n\t\t\t\t\t  size=\"lg\"\r\n\t\t\t\t\t  onClick={() => history.push(`/show/${vehicle.id}`)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t  Cancel\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t  </Row>\r\n\t\t\t\t</Form>\r\n\t\t\t  )}\r\n\t\t\t</Formik>\r\n\t\t  )\r\n\t  }\r\n\t</Container>\r\n  )\r\n};\r\n","/**\r\n * ShowVehicle.js\r\n */\r\nimport React, {useContext} from 'react';\r\nimport {AppContext} from \"../../AppContext/AppContext\";\r\nimport {Button, Col, Container, Row} from \"react-bootstrap\";\r\nimport {LoadingSpinner} from \"../LoadingSpinner/LoadingSpinner\";\r\nimport {useHistory} from 'react-router-dom';\r\nimport {VehicleDetails} from \"./VehicleDetails\";\r\nimport {Notification} from \"../Notification/Notification\";\r\n\r\n/**\r\n * ShowVehicle component - rendered when the user navigates to /show/:vehicleID\r\n * @param props\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport const ShowVehicle = props => {\r\n  const history = useHistory();\r\n  const {\r\n\tvehicles,\r\n\tbookings,\r\n\tjourneys,\r\n\tservices,\r\n\tfuelPurchases,\r\n\tloading,\r\n\tnotification\r\n  } = useContext(AppContext);\r\n  let vehicle, vehicleBookings, vehicleJourneys, vehicleServices, vehicleFuelPurchases;\r\n  vehicle = vehicles.find(v => v.id === props.match.params.vehicleID);\r\n  if (vehicle) {\r\n\tvehicleBookings = bookings.filter(b => b.vehicleID === vehicle.id);\r\n\tvehicleJourneys = journeys.filter(j => vehicleBookings.some(b => b.id === j.bookingID));\r\n\tvehicleServices = services.filter(s => s.vehicleID === vehicle.id);\r\n\tvehicleFuelPurchases = fuelPurchases.filter(f => vehicleBookings.some(b => b.id === f.bookingID));\r\n  }\r\n\r\n  return (\r\n\t<Container>\r\n\t  {\r\n\t\tnotification.display ?\r\n\t\t  (\r\n\t\t\t<Notification\r\n\t\t\t  display={notification.display}\r\n\t\t\t  message={notification.message}/>\r\n\t\t  ) : ''\r\n\t  }\r\n\t  {\r\n\t\tvehicle ?\r\n\t\t  (\r\n\t\t\t<>\r\n\t\t\t  <Row>\r\n\t\t\t\t<Col>\r\n\t\t\t\t  <h2 className=\"text-center my-5\">\r\n\t\t\t\t\t{`${vehicle.manufacturer} ${vehicle.model} (${vehicle.year})`}\r\n\t\t\t\t  </h2>\r\n\t\t\t\t</Col>\r\n\t\t\t  </Row>\r\n\t\t\t  {\r\n\t\t\t\tloading ?\r\n\t\t\t\t  (\r\n\t\t\t\t\t<Row className=\"justify-content-center mt-5\">\r\n\t\t\t\t\t  <LoadingSpinner/>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t  )\r\n\t\t\t\t  :\r\n\t\t\t\t  <VehicleDetails\r\n\t\t\t\t\tvehicle={vehicle}\r\n\t\t\t\t\tbookings={vehicleBookings}\r\n\t\t\t\t\tjourneys={vehicleJourneys}\r\n\t\t\t\t\tservices={vehicleServices}\r\n\t\t\t\t\tfuelPurchases={vehicleFuelPurchases}\r\n\t\t\t\t  />\r\n\t\t\t  }\r\n\t\t\t</>\r\n\t\t  )\r\n\t\t  :\r\n\t\t  (\r\n\t\t\t<>\r\n\t\t\t  <Row className=\"justify-content-center\">\r\n\t\t\t\t<Col>\r\n\t\t\t\t  <h2 className=\"text-center my-5\">Sorry, no vehicles were found</h2>\r\n\t\t\t\t</Col>\r\n\t\t\t  </Row>\r\n\t\t\t</>\r\n\t\t  )\r\n\t  }\r\n\t  <Row className=\"my-5\">\r\n\t\t<Col className=\"text-center\">\r\n\t\t  <Button\r\n\t\t\tonClick={() => history.push(`/browse`)}\r\n\t\t\tvariant=\"primary\"\r\n\t\t\tsize=\"lg\">\r\n\t\t\tBrowse vehicles\r\n\t\t  </Button>\r\n\t\t</Col>\r\n\t  </Row>\r\n\t</Container>\r\n  )\r\n};\r\n","/**\r\n * Header.js\r\n */\r\nimport React from 'react';\r\n\r\n/**\r\n * @typedef {Object} HeaderProps\r\n * @property {string} headerText - the title of this header\r\n */\r\n/**\r\n * Header component\r\n * @param {HeaderProps} props\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport const Header = props => (\r\n  <h1 className=\"display-5 text-center my-4\">{props.headerText}</h1>\r\n);\r\n","/**\r\n * RevenueChart.js\r\n */\r\nimport React from 'react';\r\nimport {\r\n  Bar,\r\n  BarChart,\r\n  CartesianGrid,\r\n  Legend,\r\n  ResponsiveContainer,\r\n  Tooltip,\r\n  XAxis,\r\n  YAxis\r\n} from \"recharts\";\r\n\r\n/**\r\n * @typedef {Object} RevenueProps\r\n * @property {Array} data - contains the total revenue for each month/year\r\n */\r\n/**\r\n * RevenueChart component - renders a bar chart with the total revenue recorded per month and year\r\n * @param {RevenueProps} props\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport const RevenueChart = props => {\r\n  const CustomTooltip = ({payload, label, active}) => {\r\n\tif (active && payload) {\r\n\t  return (\r\n\t\t<div className=\"bg-light text-dark text-center p-2 border border-dark\">\r\n\t\t  <p className=\"font-weight-bold\">{label}</p>\r\n\t\t  <p>Revenue: <span\r\n\t\t\tclassName=\"text-success\">{`$ ${Number.parseFloat(payload[0].value).toFixed(2)}`}</span>\r\n\t\t  </p>\r\n\t\t</div>\r\n\t  )\r\n\t}\r\n\treturn null;\r\n  };\r\n\r\n  return (\r\n\t<ResponsiveContainer width=\"100%\" height={300}>\r\n\t  <BarChart data={props.data}>\r\n\t\t<CartesianGrid stroke=\"#ccc\" strokeDasharray=\"5 5\"/>\r\n\t\t<XAxis dataKey=\"monthAndYear\"/>\r\n\t\t<YAxis/>\r\n\t\t<Tooltip content={<CustomTooltip/>}/>\r\n\t\t<Legend/>\r\n\t\t<Bar dataKey=\"revenue\" barSize={20} fill=\"#8884d8\"/>\r\n\t  </BarChart>\r\n\t</ResponsiveContainer>\r\n  );\r\n};\r\n","/**\r\n * Dashboard.js\r\n */\r\nimport React, {useContext} from 'react';\r\nimport {Button, Container, Row} from \"react-bootstrap\";\r\nimport {Header} from \"../Header/Header\";\r\nimport {AppContext} from \"../../AppContext/AppContext\";\r\nimport {LoadingSpinner} from \"../LoadingSpinner/LoadingSpinner\";\r\nimport {RevenueChart} from \"./RevenueChart\";\r\n\r\n/**\r\n * Dashboard component - the first component displayed when the app starts\r\n * @param props\r\n * @returns {*}\r\n * @constructor\r\n */\r\nexport const Dashboard = props => {\r\n  const {loading, revenue} = useContext(AppContext);\r\n\r\n  return (\r\n\t<Container className=\"text-center\">\r\n\t  <Header headerText=\"Welcome to the Car Rental System\"/>\r\n\t  {\r\n\t\tloading ?\r\n\t\t  (\r\n\t\t\t<Row className=\"justify-content-center mt-5\">\r\n\t\t\t  <LoadingSpinner/>\r\n\t\t\t</Row>\r\n\t\t  ) :\r\n\t\t  (\r\n\t\t\t<>\r\n\t\t\t  <h2 className=\"my-5 text-center\">Revenue history (last 6 months):</h2>\r\n\t\t\t  <Row>\r\n\t\t\t\t<RevenueChart data={revenue}/>\r\n\t\t\t  </Row>\r\n\t\t\t</>\r\n\t\t  )\r\n\t  }\r\n\t  <Button\r\n\t\tsize=\"lg\"\r\n\t\tvariant=\"primary\"\r\n\t\tclassName=\"mt-5\"\r\n\t\tonClick={() => props.history.push('/browse')}\r\n\t  >\r\n\t\tBrowse vehicles\r\n\t  </Button>\r\n\t</Container>\r\n  )\r\n};\r\n","import moment from \"moment\";\r\n\r\n/**\r\n * @typedef {Object} Revenue\r\n * @property {string} monthAndYear - month / year of the revenue recorded\r\n * @property {number} revenue - revenue recorded for this month and year\r\n */\r\n/**\r\n * Calculates and maps total revenue generated (by month and year, for the last 6 months) by all\r\n * vehicles in the system\r\n * @param {Array<Vehicle>} vehicles - vehicles registered in the system\r\n * @param {Object} state - current state of the App component (optional)\r\n * @returns {Array<Revenue>} data - mapped revenue data\r\n */\r\nexport const calculateTotalRevenue = (vehicles, state = null) => {\r\n  let data = [];\r\n  vehicles = vehicles || state.vehicles;\r\n  if (vehicles && vehicles.length) {\r\n\tvehicles.forEach(v => {\r\n\t  const vehicleRevenue =\r\n\t\tv\r\n\t\t  .bookings\r\n\t\t  .reduce((mappedBookings, b) => {\r\n\t\t\tconst {bookingCost} = b;\r\n\t\t\tconst bookingMonthAndYear = moment(b.startDate, \"YYYY-MM-DD\").format('MMMM YYYY');\r\n\t\t\tconst mappedBooking = {\r\n\t\t\t  bookingMonthAndYear,\r\n\t\t\t  bookingCost\r\n\t\t\t};\r\n\t\t\tmappedBookings.push(mappedBooking);\r\n\t\t\treturn mappedBookings;\r\n\t\t  }, [])\r\n\t\t  .sort((mappedBooking1, mappedBooking2) => {\r\n\t\t\treturn moment(mappedBooking1.bookingMonthAndYear, 'MMMM YYYY').isSameOrBefore(moment(mappedBooking2.bookingMonthAndYear, 'MMMM YYYY'))\r\n\t\t  })\r\n\t\t  .reduce((bookingsByMonthAndYear, mappedBooking) => {\r\n\t\t\tif (bookingsByMonthAndYear.some(b => moment(b.monthAndYear, 'MMMM YYYY').isSame(moment(mappedBooking.bookingMonthAndYear, 'MMMM YYYY')))) {\r\n\t\t\t  bookingsByMonthAndYear[bookingsByMonthAndYear.findIndex(entry => moment(entry.monthAndYear, 'MMMM YYYY').isSame(moment(mappedBooking.bookingMonthAndYear, 'MMMM YYYY')))].revenue += mappedBooking.bookingCost;\r\n\t\t\t} else {\r\n\t\t\t  bookingsByMonthAndYear.push({\r\n\t\t\t\tmonthAndYear: mappedBooking.bookingMonthAndYear,\r\n\t\t\t\trevenue: mappedBooking.bookingCost\r\n\t\t\t  })\r\n\t\t\t}\r\n\t\t\treturn bookingsByMonthAndYear;\r\n\t\t  }, []);\r\n\t  data.push(...vehicleRevenue);\r\n\t});\r\n\tdata =\r\n\t  data\r\n\t\t.reduce((mappedRevenue, entry) => {\r\n\t\t  if (mappedRevenue.some(r => moment(r.monthAndYear, 'MMMM YYYY').isSame(moment(entry.monthAndYear, 'MMMM YYYY')))) {\r\n\t\t\tmappedRevenue[mappedRevenue.findIndex(r => moment(r.monthAndYear, 'MMMM YYYY').isSame(moment(entry.monthAndYear, 'MMMM YYYY')))].revenue += entry.revenue;\r\n\t\t  } else {\r\n\t\t\tmappedRevenue.push({\r\n\t\t\t  monthAndYear: entry.monthAndYear,\r\n\t\t\t  revenue: entry.revenue\r\n\t\t\t})\r\n\t\t  }\r\n\t\t  return mappedRevenue;\r\n\t\t}, []);\r\n  }\r\n  return data\r\n\t.sort((revenue1, revenue2) => {\r\n\t  return moment(revenue1.monthAndYear, 'MMMM YYYY').diff(moment(revenue2.monthAndYear, 'MMMM' +\r\n\t\t' YYYY'))\r\n\t})\r\n\t.filter(revenue => moment(revenue.monthAndYear, 'MMMM YYYY').isSameOrBefore(moment(moment(), 'MMMM YYYY')))\r\n\t.filter(revenue => moment(revenue.monthAndYear, 'MMMM YYYY').isSameOrAfter(moment(moment(), 'MMMM YYYY').subtract(6, 'months')));\r\n};\r\n","/**\r\n * App.js\r\n */\r\nimport React from 'react';\r\nimport {Navigation} from \"../Navigation/Navigation\";\r\nimport {BrowseVehicles} from \"../BrowseVehicles/BrowseVehicles\";\r\nimport {Route, Switch} from 'react-router-dom';\r\nimport {AddVehicle} from \"../AddVehicle/AddVehicle\";\r\nimport {firebase} from \"../../Firebase/Firebase\";\r\nimport {AppProvider} from \"../../AppContext/AppContext\";\r\nimport {EditVehicle} from \"../EditVehicle/EditVehicle\";\r\nimport {AddBooking} from \"../AddBooking/AddBooking\";\r\nimport {AddService} from \"../AddService/AddService\";\r\nimport {AddJourney} from \"../AddJourney/AddJourney\";\r\nimport {AddJourneyForm} from \"../AddJourney/AddJourneyForm\";\r\nimport {AddFuelPurchase} from \"../AddFuelPurchase/AddFuelPurchase\";\r\nimport {AddFuelPurchaseForm} from \"../AddFuelPurchase/AddFuelPurchaseForm\";\r\nimport {ShowVehicle} from \"../ShowVehicle/ShowVehicle\";\r\nimport {Vehicle} from \"../../Models/Vehicle\";\r\nimport {Booking} from \"../../Models/Booking\";\r\nimport {Journey} from \"../../Models/Journey\";\r\nimport {Service} from \"../../Models/Service\";\r\nimport {FuelPurchase} from \"../../Models/FuelPurchase\";\r\nimport {Dashboard} from \"../Dashboard/Dashboard\";\r\nimport {calculateTotalRevenue} from \"./calculateTotalRevenue\";\r\n\r\n/**\r\n * App component - entry point of this application\r\n */\r\nexport class App extends React.Component {\r\n  constructor(props) {\r\n\tsuper(props);\r\n\r\n\t/**\r\n\t * Automatically dismisses notifications after 3.5 secs\r\n\t */\r\n\tthis.dismissNotification = () => {\r\n\t  setTimeout(() => {\r\n\t\tthis.setState({\r\n\t\t  notification: {\r\n\t\t\tdisplay: false,\r\n\t\t\tmessage: ''\r\n\t\t  }\r\n\t\t})\r\n\t  }, 3500)\r\n\t};\r\n\r\n\t/**\r\n\t * Edits a vehicle and updates both the state and firebase\r\n\t * @param {Vehicle} vehicle - a vehicle object that has the same ID as the vehicle to be\r\n\t * edited (for immutability), containing updated data\r\n\t * @param {Boolean} updateRemote - optional parameter to also update the remote database\r\n\t * (defaults to true)\r\n\t */\r\n\tthis.editVehicle = (vehicle, updateRemote = true) => {\r\n\t  let fieldsChanged = {};\r\n\t  this.setState({\r\n\t\tloading: true\r\n\t  }, () => {\r\n\t\tthis.setState(prevState => {\r\n\t\t  const {vehicles} = {...prevState};\r\n\t\t  const oldVehicleIndex = vehicles.findIndex(v => v.id === vehicle.id);\r\n\t\t  const oldVehicle = vehicles[oldVehicleIndex];\r\n\t\t  fieldsChanged = Object\r\n\t\t\t.keys(oldVehicle)\r\n\t\t\t.reduce((fields, field) => {\r\n\t\t\t  if ((oldVehicle[field] !== vehicle[field]) && !Array.isArray(vehicle[field])) {\r\n\t\t\t\tfields[field] = vehicle[field];\r\n\t\t\t  }\r\n\t\t\t  return fields;\r\n\t\t\t}, {});\r\n\t\t  vehicles[oldVehicleIndex] = vehicle;\r\n\r\n\t\t  return ({\r\n\t\t\t...prevState,\r\n\t\t\tvehicles\r\n\t\t  })\r\n\t\t}, () => {\r\n\t\t  if (updateRemote) {\r\n\t\t\tconst db = firebase.firestore();\r\n\r\n\t\t\treturn db\r\n\t\t\t  .collection('vehicles')\r\n\t\t\t  .doc(vehicle.id)\r\n\t\t\t  .update(fieldsChanged)\r\n\t\t\t  .then(() => {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t  loading: false,\r\n\t\t\t\t  notification: {\r\n\t\t\t\t\tdisplay: true,\r\n\t\t\t\t\tmessage: `The vehicle has been successfully updated`\r\n\t\t\t\t  }\r\n\t\t\t\t}, this.dismissNotification)\r\n\t\t\t  })\r\n\t\t\t  .catch(err => {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t  loading: false,\r\n\t\t\t\t  notification: {\r\n\t\t\t\t\tdisplay: true,\r\n\t\t\t\t\tmessage: `Could not edit vehicle: ${err}`\r\n\t\t\t\t  }\r\n\t\t\t\t}, () => {\r\n\t\t\t\t  this.dismissNotification();\r\n\t\t\t\t  console.dir(err);\r\n\t\t\t\t})\r\n\t\t\t  })\r\n\t\t  }\r\n\t\t});\r\n\t  })\r\n\t};\r\n\r\n\t/**\r\n\t * Adds a new resource and updates both the state and firebase\r\n\t * @param {string} resourceType - one of: \"vehicle\", \"booking\", \"journey\", \"service\", \"fuel\r\n\t * purchase\" or \"fuelPurchase\"\r\n\t * @param {Vehicle|Booking|Journey|Service|FuelPurchase} resource\r\n\t * @param {Boolean} updateRemote - optional parameter to also update the remote database\r\n\t * (defaults to true)\r\n\t */\r\n\tthis.addResource = (resourceType, resource, updateRemote = true) => {\r\n\t  if (!resourceType || !resource) {\r\n\t\treturn this.setState({\r\n\t\t  notification: {\r\n\t\t\tdisplay: true,\r\n\t\t\tmessage: 'Error: missing resource or resource type'\r\n\t\t  }\r\n\t\t}, this.dismissNotification)\r\n\t  }\r\n\t  let collectionName, collection;\r\n\r\n\t  switch (resourceType.trim().toLowerCase()) {\r\n\t\tcase 'vehicle':\r\n\t\t  collectionName = 'vehicles';\r\n\t\t  break;\r\n\r\n\t\tcase 'booking':\r\n\t\t  collectionName = 'bookings';\r\n\t\t  break;\r\n\r\n\t\tcase 'service':\r\n\t\t  collectionName = 'services';\r\n\t\t  break;\r\n\r\n\t\tcase 'journey':\r\n\t\t  collectionName = 'journeys';\r\n\t\t  break;\r\n\r\n\t\tcase 'fuelpurchase':\r\n\t\tcase 'fuel purchase':\r\n\t\t  collectionName = 'fuelPurchases';\r\n\t\t  break;\r\n\r\n\t\tdefault:\r\n\t\t  break;\r\n\t  }\r\n\t  let selectedVehicle, selectedVehicleIndex;\r\n\t  this.setState(prevState => {\r\n\t\tcollection = collectionName && prevState[collectionName];\r\n\t\tif (!collection) {\r\n\t\t  return ({\r\n\t\t\tnotification: {\r\n\t\t\t  display: true,\r\n\t\t\t  message: 'Error: invalid resource type provided'\r\n\t\t\t}\r\n\t\t  })\r\n\t\t} else {\r\n\t\t  const {vehicles} = prevState;\r\n\t\t  switch (collectionName) {\r\n\t\t\tcase 'services':\r\n\t\t\tcase 'bookings':\r\n\t\t\t  selectedVehicle = vehicles.find(v => v.id === resource.vehicleID);\r\n\t\t\t  selectedVehicleIndex = vehicles.findIndex(v => v.id === resource.vehicleID);\r\n\t\t\t  if (collectionName === 'services') {\r\n\t\t\t\tselectedVehicle.addService(resource);\r\n\t\t\t  } else {\r\n\t\t\t\tselectedVehicle.addBooking(resource);\r\n\t\t\t  }\r\n\t\t\t  break;\r\n\r\n\t\t\tcase 'journeys':\r\n\t\t\tcase 'fuelPurchases':\r\n\t\t\t  selectedVehicle = vehicles.find(v => v.bookings.some(b => b.id === resource.bookingID));\r\n\t\t\t  selectedVehicleIndex = vehicles.findIndex(v => v.bookings.some(b => b.id === resource.bookingID));\r\n\t\t\t  if (collectionName === 'journeys') {\r\n\t\t\t\tselectedVehicle.addJourney(resource);\r\n\t\t\t  } else {\r\n\t\t\t\tselectedVehicle.addFuelPurchase(resource);\r\n\t\t\t  }\r\n\t\t\t  break;\r\n\r\n\t\t\tdefault:\r\n\t\t\t  collection.push(resource);\r\n\t\t\t  break;\r\n\t\t  }\r\n\t\t}\r\n\r\n\t\tif (collectionName === 'vehicles') {\r\n\t\t  return ({\r\n\t\t\tloading: true,\r\n\t\t\tvehicles: collection\r\n\t\t  })\r\n\t\t} else {\r\n\t\t  prevState.vehicles[selectedVehicleIndex] = selectedVehicle;\r\n\t\t  return ({\r\n\t\t\tloading: true,\r\n\t\t\tvehicles: [...prevState.vehicles]\r\n\t\t  })\r\n\t\t}\r\n\t  }, () => {\r\n\t\tif (collectionName && collection) {\r\n\t\t  if (updateRemote) {\r\n\t\t\tconst db = firebase.firestore();\r\n\t\t\tdb\r\n\t\t\t  .collection(collectionName)\r\n\t\t\t  .doc(resource.id)\r\n\t\t\t  .set({...resource})\r\n\t\t\t  .then(() => {\r\n\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t  loading: false,\r\n\t\t\t\t  revenue: calculateTotalRevenue(prevState.vehicles),\r\n\t\t\t\t  notification: {\r\n\t\t\t\t\tdisplay: true,\r\n\t\t\t\t\tmessage: `The new ${resourceType} has been successfully added to the system`\r\n\t\t\t\t  }\r\n\t\t\t\t}), this.dismissNotification)\r\n\t\t\t  })\r\n\t\t\t  .catch(err => {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t  loading: false,\r\n\t\t\t\t  notification: {\r\n\t\t\t\t\tdisplay: true,\r\n\t\t\t\t\tmessage: `Could not add new ${resourceType}. Error: ${err.message}`\r\n\t\t\t\t  }\r\n\t\t\t\t}, this.dismissNotification)\r\n\t\t\t  })\r\n\t\t  }\r\n\t\t} else {\r\n\t\t  this.setState({\r\n\t\t\tnotification: {\r\n\t\t\t  display: false,\r\n\t\t\t  message: ''\r\n\t\t\t}\r\n\t\t  })\r\n\t\t}\r\n\t  })\r\n\t};\r\n\r\n\t/**\r\n\t * Deletes a resource (after confirmation by the user) from both the state and firebase\r\n\t * @param {string} resourceType - one of: \"vehicle\", \"booking\", \"journey\", \"service\", \"fuel\r\n\t * purchase\" or \"fuelPurchase\"\r\n\t * @param {Vehicle|Booking|Journey|Service|FuelPurchase} resource\r\n\t * @param {Boolean} updateRemote - optional parameter to also update the remote database\r\n\t * (defaults to true)\r\n\t */\r\n\tthis.confirmDeleteResource = (resourceType, resource, updateRemote = true) => {\r\n\t  if (resourceType && resource) {\r\n\t\tthis.setDeleteResourceModalShow(null, null, () => {\r\n\t\t  this.setState(prevState => ({\r\n\t\t\t...prevState,\r\n\t\t\tloading: true\r\n\t\t  }), () => {\r\n\t\t\tlet collection;\r\n\t\t\tswitch (resourceType.trim().toLowerCase()) {\r\n\t\t\t  case 'vehicle':\r\n\t\t\t\tcollection = 'vehicles';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t  case 'journey':\r\n\t\t\t\tcollection = 'journeys';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t  case 'service':\r\n\t\t\t\tcollection = 'services';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t  case 'booking':\r\n\t\t\t\tcollection = 'bookings';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t  case 'fuel purchase':\r\n\t\t\t  case 'fuelpurchase':\r\n\t\t\t\tcollection = 'fuelPurchases';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t  default:\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif (collection) {\r\n\t\t\t  const db = firebase.firestore();\r\n\t\t\t  if (collection === 'vehicles') {\r\n\t\t\t\t// delete everything associated with the vehicle first\r\n\t\t\t\t// delete journeys and bookings\r\n\t\t\t\tif (updateRemote) {\r\n\t\t\t\t  resource.bookings.forEach(b => {\r\n\t\t\t\t\t// delete all journeys for each booking\r\n\t\t\t\t\tb.journeys.forEach(j => {\r\n\t\t\t\t\t  db\r\n\t\t\t\t\t\t.collection('journeys')\r\n\t\t\t\t\t\t.doc(j.id)\r\n\t\t\t\t\t\t.delete()\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// delete all fuel purchases for this booking\r\n\t\t\t\t\tb.fuelPurchases.forEach(f => {\r\n\t\t\t\t\t  db\r\n\t\t\t\t\t\t.collection('fuelPurchases')\r\n\t\t\t\t\t\t.doc(f.id)\r\n\t\t\t\t\t\t.delete()\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// delete the booking itself\r\n\t\t\t\t\tdb\r\n\t\t\t\t\t  .collection('bookings')\r\n\t\t\t\t\t  .doc(b.id)\r\n\t\t\t\t\t  .delete()\r\n\t\t\t\t  });\r\n\r\n\t\t\t\t  // delete services\r\n\t\t\t\t  resource.services.forEach(s => {\r\n\t\t\t\t\tdb\r\n\t\t\t\t\t  .collection('services')\r\n\t\t\t\t\t  .doc(s.id)\r\n\t\t\t\t\t  .delete()\r\n\t\t\t\t  });\r\n\r\n\t\t\t\t  // delete the vehicle itself\r\n\t\t\t\t  db\r\n\t\t\t\t\t.collection('vehicles')\r\n\t\t\t\t\t.doc(resource.id)\r\n\t\t\t\t\t.delete()\r\n\t\t\t\t}\r\n\t\t\t\tthis.setState(prevState => {\r\n\t\t\t\t  let {vehicles} = prevState;\r\n\t\t\t\t  vehicles = vehicles.filter(v => v.id !== resource.id);\r\n\t\t\t\t  return ({\r\n\t\t\t\t\tvehicles,\r\n\t\t\t\t\tloading: false,\r\n\t\t\t\t\trevenue: calculateTotalRevenue(vehicles),\r\n\t\t\t\t\tnotification: {\r\n\t\t\t\t\t  display: true,\r\n\t\t\t\t\t  message: `The ${resourceType} has been successfully removed from the system`\r\n\t\t\t\t\t}\r\n\t\t\t\t  });\r\n\t\t\t\t}, this.dismissNotification)\r\n\t\t\t  } else if (collection === 'bookings') {\r\n\t\t\t\t// delete booking from state first\r\n\t\t\t\tthis.setState(prevState => {\r\n\t\t\t\t  const {vehicles} = prevState;\r\n\t\t\t\t  const vehicleToBeModified = vehicles.find(v => v.bookings.some(b => b.id === resource.id));\r\n\t\t\t\t  vehicleToBeModified.removeBookingByID(resource.id);\r\n\t\t\t\t  return ({\r\n\t\t\t\t\tvehicles: [\r\n\t\t\t\t\t  vehicleToBeModified,\r\n\t\t\t\t\t  ...vehicles.filter(v => v.id !== vehicleToBeModified.id)\r\n\t\t\t\t\t]\r\n\t\t\t\t  })\r\n\t\t\t\t}, () => {\r\n\t\t\t\t  if (updateRemote) {\r\n\t\t\t\t\t// delete booking from firebase\r\n\t\t\t\t\tdb\r\n\t\t\t\t\t  .collection('bookings')\r\n\t\t\t\t\t  .doc(resource.id)\r\n\t\t\t\t\t  .delete()\r\n\t\t\t\t  }\r\n\t\t\t\t  this.setState(prevState => ({\r\n\t\t\t\t\tloading: false,\r\n\t\t\t\t\trevenue: calculateTotalRevenue(prevState.vehicles),\r\n\t\t\t\t\tnotification: {\r\n\t\t\t\t\t  display: true,\r\n\t\t\t\t\t  message: `The ${resourceType} has been successfully removed from the system`\r\n\t\t\t\t\t}\r\n\t\t\t\t  }), this.dismissNotification)\r\n/*\t\t\t\t\t.catch(err => {\r\n\t\t\t\t\t  this.state({\r\n\t\t\t\t\t\tloading: false,\r\n\t\t\t\t\t\tnotification: {\r\n\t\t\t\t\t\t  display: true,\r\n\t\t\t\t\t\t  message: `Error: ${err.message}`\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t  })\r\n\t\t\t\t\t})*/\r\n\t\t\t\t})\r\n\t\t\t  } else if (collection === 'journeys') {\r\n\t\t\t\t// delete journey from state\r\n\t\t\t\tthis.setState(prevState => {\r\n\t\t\t\t  const {vehicles} = prevState;\r\n\t\t\t\t  const vehicleToBeModified = vehicles.find(v => v.bookings.some(b => b.id === resource.bookingID));\r\n\t\t\t\t  vehicleToBeModified.removeJourneyByBookingID(resource, resource.bookingID);\r\n\r\n\t\t\t\t  return ({\r\n\t\t\t\t\tvehicles: [\r\n\t\t\t\t\t  vehicleToBeModified,\r\n\t\t\t\t\t  ...vehicles.filter(v => v.id !== vehicleToBeModified.id)\r\n\t\t\t\t\t]\r\n\t\t\t\t  })\r\n\t\t\t\t}, () => {\r\n\t\t\t\t  if (updateRemote) {\r\n\t\t\t\t\t// delete journey from firebase\r\n\t\t\t\t\tdb\r\n\t\t\t\t\t  .collection('journeys')\r\n\t\t\t\t\t  .doc(resource.id)\r\n\t\t\t\t\t  .delete()\r\n\t\t\t\t\t  .then(() => {\r\n\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t  loading: false,\r\n\t\t\t\t\t\t  revenue: calculateTotalRevenue(prevState.vehicles),\r\n\t\t\t\t\t\t  notification: {\r\n\t\t\t\t\t\t\tdisplay: true,\r\n\t\t\t\t\t\t\tmessage: `The ${resourceType} has been successfully removed from the system`\r\n\t\t\t\t\t\t  }\r\n\t\t\t\t\t\t}), this.dismissNotification)\r\n\t\t\t\t\t  })\r\n\t\t\t\t  }\r\n\t\t\t\t})\r\n\t\t\t  } else if (collection === 'services') {\r\n\t\t\t\t// delete service from state\r\n\t\t\t\tthis.setState(prevState => {\r\n\t\t\t\t  const {vehicles} = prevState;\r\n\t\t\t\t  const vehicleToBeModified = vehicles.find(v => v.id === resource.vehicleID);\r\n\t\t\t\t  vehicleToBeModified.removeServiceByID(resource.id);\r\n\r\n\t\t\t\t  return ({\r\n\t\t\t\t\tvehicles: [\r\n\t\t\t\t\t  vehicleToBeModified,\r\n\t\t\t\t\t  ...vehicles.filter(v => v.id !== vehicleToBeModified.id)\r\n\t\t\t\t\t]\r\n\t\t\t\t  })\r\n\t\t\t\t}, () => {\r\n\t\t\t\t  if (updateRemote) {\r\n\t\t\t\t\t// delete service from firebase\r\n\t\t\t\t\tdb\r\n\t\t\t\t\t  .collection('services')\r\n\t\t\t\t\t  .doc(resource.id)\r\n\t\t\t\t\t  .delete()\r\n\t\t\t\t\t  .then(() => {\r\n\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t  loading: false,\r\n\t\t\t\t\t\t  notification: {\r\n\t\t\t\t\t\t\tdisplay: true,\r\n\t\t\t\t\t\t\tmessage: `The ${resourceType} has been successfully removed from the system`\r\n\t\t\t\t\t\t  }\r\n\t\t\t\t\t\t}, this.dismissNotification)\r\n\t\t\t\t\t  })\r\n\t\t\t\t  }\r\n\t\t\t\t})\r\n\t\t\t  } else if (collection === 'fuelPurchases') {\r\n\t\t\t\t// delete fuel purchase from the state\r\n\t\t\t\tthis.setState(prevState => {\r\n\t\t\t\t  const {vehicles} = prevState;\r\n\t\t\t\t  const vehicleToBeModified = vehicles.find(v => v.bookings.some(b => b.id === resource.bookingID));\r\n\t\t\t\t  vehicleToBeModified.removeFuelPurchaseByBookingID(resource, resource.bookingID);\r\n\r\n\t\t\t\t  return ({\r\n\t\t\t\t\tvehicles: [\r\n\t\t\t\t\t  vehicleToBeModified,\r\n\t\t\t\t\t  ...vehicles.filter(v => v.id !== vehicleToBeModified.id)\r\n\t\t\t\t\t]\r\n\t\t\t\t  })\r\n\t\t\t\t}, () => {\r\n\t\t\t\t  if (updateRemote) {\r\n\t\t\t\t\t// delete fuel purchase from firebase\r\n\t\t\t\t\tdb\r\n\t\t\t\t\t  .collection('fuelPurchases')\r\n\t\t\t\t\t  .doc(resource.id)\r\n\t\t\t\t\t  .delete()\r\n\t\t\t\t\t  .then(() => {\r\n\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t  loading: false,\r\n\t\t\t\t\t\t  notification: {\r\n\t\t\t\t\t\t\tdisplay: true,\r\n\t\t\t\t\t\t\tmessage: `The ${resourceType} has been successfully removed from the system`\r\n\t\t\t\t\t\t  }\r\n\t\t\t\t\t\t}, this.dismissNotification)\r\n\t\t\t\t\t  })\r\n\t\t\t\t  }\r\n\t\t\t\t})\r\n\t\t\t  } else {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t  loading: false,\r\n\t\t\t\t  notification: {\r\n\t\t\t\t\tdisplay: true,\r\n\t\t\t\t\tmessage: `Error: the collection associated with the item to be deleted was not found`\r\n\t\t\t\t  }\r\n\t\t\t\t}, this.dismissNotification)\r\n\t\t\t  }\r\n\t\t\t}\r\n\t\t  })\r\n\t\t})\r\n\t  }\r\n\t};\r\n\r\n\t/**\r\n\t *\r\n\t * @param resourceType\r\n\t * @param resource\r\n\t * @param callback\r\n\t */\r\n\tthis.setDeleteResourceModalShow = (resourceType, resource, callback) => {\r\n\t  this.setState(prevState => ({\r\n\t\tdeleteResource: {\r\n\t\t  ...prevState.deleteResource,\r\n\t\t  resource: resource ? resource : prevState.deleteResource.resource,\r\n\t\t  resourceType: resourceType ? resourceType : prevState.deleteResource.resourceType,\r\n\t\t  showDeleteResourceModal: !prevState.deleteResource.showDeleteResourceModal\r\n\t\t}\r\n\t  }), callback);\r\n\t};\r\n\r\n\tthis.state = {\r\n\t  loading: true,\r\n\t  vehicles: [],\r\n\t  services: [],\r\n\t  bookings: [],\r\n\t  journeys: [],\r\n\t  fuelPurchases: [],\r\n\t  revenue: [],\r\n\t  addVehicle: this.addVehicle,\r\n\t  editVehicle: this.editVehicle,\r\n\t  deleteResource: {\r\n\t\tresourceType: '',\r\n\t\tresource: '',\r\n\t\tconfirmDeleteResource: this.confirmDeleteResource,\r\n\t\tshowDeleteResourceModal: false,\r\n\t\tsetDeleteResourceModalShow: this.setDeleteResourceModalShow\r\n\t  },\r\n\t  addResource: this.addResource,\r\n\t  addBooking: this.addBooking,\r\n\t  addJourney: this.addJourney,\r\n\t  addService: this.addService,\r\n\t  addFuelPurchase: this.addFuelPurchase,\r\n\t  notification: {\r\n\t\tdisplay: false,\r\n\t\tmessage: ''\r\n\t  }\r\n\t};\r\n  }\r\n\r\n  /**\r\n   * Fetches all collections from firebase, organises the data in the state and updates\r\n   * odometers, if need be\r\n   */\r\n  componentDidMount() {\r\n\tthis\r\n\t  .fetchCollections('vehicles', 'bookings', 'journeys', 'services', 'fuelPurchases')\r\n\t  .then(values => {\r\n\t\t// move services, bookings, journeys and fuel purchases to the respective vehicle\r\n\t\tthis.setState(prevState => {\r\n\t\t  const {services, bookings, journeys, fuelPurchases, vehicles} = prevState;\r\n\r\n\t\t  let vehicleJourneys, vehicleServices, vehicleFuelPurchases;\r\n\r\n\t\t  // add each booking to the respective vehicle\r\n\t\t  vehicles.forEach(v => {\r\n\t\t\tbookings\r\n\t\t\t  .filter(b => b.vehicleID === v.id)\r\n\t\t\t  .forEach(b => {\r\n\t\t\t\tv.addBooking(b);\r\n\t\t\t  })\r\n\t\t  });\r\n\r\n\t\t  // add all other collections to the respective vehicle\r\n\t\t  vehicles.forEach(v => {\r\n\t\t\tvehicleJourneys = journeys.filter(j => v.bookings.some(b => b.id === j.bookingID));\r\n\t\t\tvehicleJourneys.forEach(j => {\r\n\t\t\t  v.addJourney(j);\r\n\t\t\t});\r\n\r\n\t\t\tvehicleFuelPurchases = fuelPurchases.filter(f => v.bookings.some(b => b.id === f.bookingID));\r\n\t\t\tvehicleFuelPurchases.forEach(f => {\r\n\t\t\t  v.addFuelPurchase(f);\r\n\t\t\t});\r\n\r\n\t\t\tvehicleServices = services.filter(s => s.vehicleID === v.id);\r\n\t\t\tvehicleServices.forEach(s => {\r\n\t\t\t  v.addService(s);\r\n\t\t\t});\r\n\r\n\t\t  });\r\n\r\n\t\t  // update odometers and notify user\r\n\t\t  vehicles.forEach(v => {\r\n\t\t\tv.updateVehicleOdometer(() => {\r\n\t\t\t  this.setState({\r\n\t\t\t\tnotification: {\r\n\t\t\t\t  display: true,\r\n\t\t\t\t  message: `Updated odometer for ${v.manufacturer} ${v.model} (${v.year})`\r\n\t\t\t\t}\r\n\t\t\t  }, this.dismissNotification)\r\n\t\t\t});\r\n\t\t  });\r\n\r\n\t\t  const revenue = calculateTotalRevenue(vehicles);\r\n\t\t  return ({\r\n\t\t\tvehicles,\r\n\t\t\trevenue\r\n\t\t  })\r\n\t\t});\r\n\t  })\r\n\t  .catch(err => {\r\n\t\t// display error message\r\n\t\tthis.setState({\r\n\t\t  notification: {\r\n\t\t\tdisplay: true,\r\n\t\t\tmessage: `Error: ${err.message}`\r\n\t\t  }\r\n\t\t}, this.dismissNotification)\r\n\t  })\r\n  }\r\n\r\n  /**\r\n   * Fetches a collection from firebase and adds it to the state\r\n   * @param {string} collection - one of: \"vehicles\", \"bookings\", \"journeys, \"services\" or\r\n   * \"fuelPurchases\"\r\n   * @returns {Promise<firebase.firestore.QuerySnapshot>}\r\n   */\r\n  fetchCollection = (collection) => {\r\n\tconst formattedCollection = collection.trim().toLowerCase();\r\n\tconst db = firebase.firestore();\r\n\treturn db\r\n\t  .collection(collection)\r\n\t  .get()\r\n\t  .then(querySnapshot => {\r\n\t\tlet data = querySnapshot.docs.map(doc => doc.data());\r\n\r\n\t\tthis.setState(prevState => {\r\n\t\t  data = data.map(resource => {\r\n\t\t\tswitch (formattedCollection) {\r\n\t\t\t  case 'vehicles':\r\n\t\t\t\tresource = new Vehicle(resource._manufacturer, resource._model, resource._year, resource._odometerReading, resource._registrationNumber, resource._tankCapacity, resource._id, resource._createdAt, resource._updatedAt);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t  case 'bookings':\r\n\t\t\t\tresource = new Booking(resource._vehicleID, resource._bookingType, resource._startDate, resource._endDate, resource._startOdometer, resource._endOdometer, resource._id, resource._createdAt, resource._updatedAt);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t  case 'journeys':\r\n\t\t\t\tresource = new Journey(resource._bookingID, resource._journeyStartOdometerReading, resource._journeyEndOdometerReading, resource._journeyStartedAt, resource._journeyEndedAt, resource._journeyFrom, resource._journeyTo, resource._id, resource._createdAt, resource._updatedAt);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t  case 'services':\r\n\t\t\t\tresource = new Service(resource._vehicleID, resource._serviceOdometer, resource._servicedAt, resource._id, resource._createdAt, resource._updatedAt);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t  case 'fuelpurchases':\r\n\t\t\t  case 'fuel purchases':\r\n\t\t\t\tresource = new FuelPurchase(resource._bookingID, resource._fuelQuantity, resource._fuelPrice, resource._id, resource._createdAt, resource._updatedAt);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t  default:\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\treturn resource;\r\n\t\t  });\r\n\r\n\t\t  return ({\r\n\t\t\tloading: false,\r\n\t\t\t[collection]: [...data]\r\n\t\t  })\r\n\t\t}, () => {\r\n\r\n\t\t})\r\n\t  })\r\n\t  .catch(e => {\r\n\t\tthis.setState({\r\n\t\t  loading: false\r\n\t\t}, () => {\r\n\t\t  console.dir(e);\r\n\t\t})\r\n\t  })\r\n  };\r\n\r\n  /**\r\n   * Fetches multiple collections from firebase\r\n   * @param {Array<string>|string} collections - array of collection names to be fetched\r\n   * @returns {Promise<firebase.firestore.QuerySnapshot[]>}\r\n   */\r\n  async fetchCollections(...collections) {\r\n\treturn Promise.all(collections.map(collection => this.fetchCollection(collection)))\r\n  }\r\n\r\n  render() {\r\n\treturn (\r\n\t  <AppProvider value={this.state}>\r\n\t\t<Navigation/>\r\n\t\t<Switch>\r\n\t\t  <Route exact path=\"/\" render={props => <Dashboard {...props} />}/>\r\n\t\t  <Route path=\"/browse\">\r\n\t\t\t<BrowseVehicles/>\r\n\t\t  </Route>\r\n\t\t  <Route path=\"/add\" render={(props) => <AddVehicle {...props} />}/>\r\n\t\t  <Route path=\"/show/:vehicleID\" render={(props) => <ShowVehicle {...props} />}/>\r\n\t\t  <Route path=\"/edit/:vehicleID\" render={(props) => <EditVehicle {...props} />}/>\r\n\t\t  <Route path=\"/addBooking/:vehicleID\" render={(props) => <AddBooking {...props} />}/>\r\n\t\t  <Route path=\"/addJourney/:vehicleID\" render={(props) => <AddJourney {...props} />}/>\r\n\t\t  <Route path=\"/addJourneyForm/:bookingID\"\r\n\t\t\t\t render={(props) => <AddJourneyForm {...props} />}/>\r\n\t\t  <Route path=\"/addService/:vehicleID\" render={(props) => <AddService {...props} />}/>\r\n\t\t  <Route path=\"/addFuelPurchase/:vehicleID\"\r\n\t\t\t\t render={(props) => <AddFuelPurchase {...props} />}/>\r\n\t\t  <Route path=\"/addFuelPurchaseForm/:bookingID\"\r\n\t\t\t\t render={(props) => <AddFuelPurchaseForm {...props} />}/>\r\n\t\t  <Route path=\"*\" render={(props) => <BrowseVehicles {...props}/>}/>\r\n\t\t</Switch>\r\n\t  </AppProvider>\r\n\t)\r\n  }\r\n}\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n  // [::1] is the IPv6 localhost address.\r\n  window.location.hostname === '[::1]' ||\r\n  // 127.0.0.1/8 is considered localhost for IPv4.\r\n  window.location.hostname.match(\r\n\t/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n  )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n\t// The URL constructor is available in all browsers that support SW.\r\n\tconst publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n\tif (publicUrl.origin !== window.location.origin) {\r\n\t  // Our service worker won't work if PUBLIC_URL is on a different origin\r\n\t  // from what our page is served on. This might happen if a CDN is used to\r\n\t  // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n\t  return;\r\n\t}\r\n\r\n\twindow.addEventListener('load', () => {\r\n\t  const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n\t  if (isLocalhost) {\r\n\t\t// This is running on localhost. Let's check if a service worker still exists or not.\r\n\t\tcheckValidServiceWorker(swUrl, config);\r\n\r\n\t\t// Add some additional logging to localhost, pointing developers to the\r\n\t\t// service worker/PWA documentation.\r\n\t\tnavigator.serviceWorker.ready.then(() => {\r\n\t\t  console.log(\r\n\t\t\t'This web app is being served cache-first by a service ' +\r\n\t\t\t'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n\t\t  );\r\n\t\t});\r\n\t  } else {\r\n\t\t// Is not localhost. Just register service worker\r\n\t\tregisterValidSW(swUrl, config);\r\n\t  }\r\n\t});\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n\t.register(swUrl)\r\n\t.then(registration => {\r\n\t  registration.onupdatefound = () => {\r\n\t\tconst installingWorker = registration.installing;\r\n\t\tif (installingWorker == null) {\r\n\t\t  return;\r\n\t\t}\r\n\t\tinstallingWorker.onstatechange = () => {\r\n\t\t  if (installingWorker.state === 'installed') {\r\n\t\t\tif (navigator.serviceWorker.controller) {\r\n\t\t\t  // At this point, the updated precached content has been fetched,\r\n\t\t\t  // but the previous service worker will still serve the older\r\n\t\t\t  // content until all client tabs are closed.\r\n\t\t\t  console.log(\r\n\t\t\t\t'New content is available and will be used when all ' +\r\n\t\t\t\t'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n\t\t\t  );\r\n\r\n\t\t\t  // Execute callback\r\n\t\t\t  if (config && config.onUpdate) {\r\n\t\t\t\tconfig.onUpdate(registration);\r\n\t\t\t  }\r\n\t\t\t} else {\r\n\t\t\t  // At this point, everything has been precached.\r\n\t\t\t  // It's the perfect time to display a\r\n\t\t\t  // \"Content is cached for offline use.\" message.\r\n\t\t\t  console.log('Content is cached for offline use.');\r\n\r\n\t\t\t  // Execute callback\r\n\t\t\t  if (config && config.onSuccess) {\r\n\t\t\t\tconfig.onSuccess(registration);\r\n\t\t\t  }\r\n\t\t\t}\r\n\t\t  }\r\n\t\t};\r\n\t  };\r\n\t})\r\n\t.catch(error => {\r\n\t  console.error('Error during service worker registration:', error);\r\n\t});\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n\t.then(response => {\r\n\t  // Ensure service worker exists, and that we really are getting a JS file.\r\n\t  const contentType = response.headers.get('content-type');\r\n\t  if (\r\n\t\tresponse.status === 404 ||\r\n\t\t(contentType != null && contentType.indexOf('javascript') === -1)\r\n\t  ) {\r\n\t\t// No service worker found. Probably a different app. Reload the page.\r\n\t\tnavigator.serviceWorker.ready.then(registration => {\r\n\t\t  registration.unregister().then(() => {\r\n\t\t\twindow.location.reload();\r\n\t\t  });\r\n\t\t});\r\n\t  } else {\r\n\t\t// Service worker found. Proceed as normal.\r\n\t\tregisterValidSW(swUrl, config);\r\n\t  }\r\n\t})\r\n\t.catch(() => {\r\n\t  console.log(\r\n\t\t'No internet connection found. App is running in offline mode.'\r\n\t  );\r\n\t});\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n\tnavigator.serviceWorker.ready.then(registration => {\r\n\t  registration.unregister();\r\n\t});\r\n  }\r\n}\r\n","/**\r\n * index.js\r\n */\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport {App} from './components/App/App';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport './index.css';\r\nimport {BrowserRouter} from \"react-router-dom\";\r\n\r\nReactDOM.render(\r\n  <BrowserRouter basename=\"/car-rental-system\">\r\n    <App/>\r\n  </BrowserRouter>\r\n  ,\r\n  document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}